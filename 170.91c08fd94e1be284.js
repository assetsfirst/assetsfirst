"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([[170],{2170:(qe,k,l)=>{l.r(k),l.d(k,{PortfolioPositionsModule:()=>$e});var u=l(6895),P=l(2761),T=l(9585),B=l(8675),F=l(9300),H=l(5577),j=l(4004),h=l(5412),v=l(9521),e=l(4650),D=l(6299),d=l(4006),y=l(4859),C=l(7392),m=l(7331),x=l(9549),E=l(266),R=l(7957),g=l(3238);const Z=["tagInput"];function Q(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mat-chip",12),e.NdJ("removed",function(){const r=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.remove(r))}),e._uU(1),e.TgZ(2,"button",13)(3,"mat-icon"),e._uU(4,"cancel"),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(1),e.hij(" ",t.categoryName+"::"+t.name," ")}}function G(a,n){if(1&a&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.categoryName+"::"+t.name," ")}}const $=function(){return{openTagCategoriesDialog:!0}},q=function(a){return{selectedTags:a}};let U=(()=>{class a{constructor(t,i,o,r){this.tagCategoryService=t,this.data=i,this.cd=o,this.fb=r,this.separatorKeysCodes=[v.K5,v.OC],this.selectedTags=[],this.title=i.title,this.selectedTags=[...i.selectedTags],this.tagCtrl=this.fb.control("")}ngOnInit(){this.filteredTags$=this.tagCtrl.valueChanges.pipe((0,B.O)(""),(0,F.h)(t=>"string"==typeof t),(0,H.z)(t=>this.tagCategoryService.findTags(t).pipe((0,j.U)(i=>i.content))))}add(t){(t.value||"").trim(),t.chipInput.clear(),this.tagCtrl.setValue("")}remove(t){this.selectedTags=[...this.selectedTags.filter(i=>i.id!==t.id)],this.cd.detectChanges()}selected(t){this.tagInput.nativeElement.value="",this.tagCtrl.setValue(""),this.selectedTags=[...this.selectedTags,t.option.value],this.cd.detectChanges()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(D.$),e.Y36(h.WI),e.Y36(e.sBO),e.Y36(d.j3))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-position-tags-dialog"]],viewQuery:function(t,i){if(1&t&&e.Gf(Z,5),2&t){let o;e.iGM(o=e.CRH())&&(i.tagInput=o.first)}},decls:22,vars:14,consts:[["mat-dialog-title",""],["mat-icon-button","","matTooltip","Configure Tag Categories",1,"conf-categories-btn",3,"mat-dialog-close"],["appearance","fill",1,"tag-chip-list"],["aria-label","Tag selection"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"formControl","matChipInputFor","matAutocomplete","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",3,"mat-dialog-close"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h2",0),e._uU(1),e.TgZ(2,"span")(3,"button",1)(4,"mat-icon"),e._uU(5,"settings_ethernet"),e.qZA()()()(),e.TgZ(6,"mat-dialog-content")(7,"mat-form-field",2)(8,"mat-label"),e._uU(9,"Position Tags"),e.qZA(),e.TgZ(10,"mat-chip-list",3,4),e.YNc(12,Q,5,1,"mat-chip",5),e.TgZ(13,"input",6,7),e.NdJ("matChipInputTokenEnd",function(r){return i.add(r)}),e.qZA()(),e.TgZ(15,"mat-autocomplete",8,9),e.NdJ("optionSelected",function(r){return i.selected(r)}),e.YNc(17,G,2,2,"mat-option",10),e.ALo(18,"async"),e.qZA()()(),e.TgZ(19,"mat-dialog-actions")(20,"button",11),e._uU(21,"Okay"),e.qZA()()),2&t){const o=e.MAs(11),r=e.MAs(16);e.xp6(1),e.hij(" ",i.title,""),e.xp6(2),e.Q6J("mat-dialog-close",e.DdM(11,$)),e.xp6(9),e.Q6J("ngForOf",i.selectedTags),e.xp6(1),e.Q6J("formControl",i.tagCtrl)("matChipInputFor",o)("matAutocomplete",r)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes),e.xp6(4),e.Q6J("ngForOf",e.lcZ(18,9,i.filteredTags$)),e.xp6(3),e.Q6J("mat-dialog-close",e.VKq(12,q,i.selectedTags))}},dependencies:[u.sg,y.lW,C.Hw,h.ZT,h.uh,h.xY,h.H8,m.qn,m.HS,m.oH,m.qH,x.KE,x.hX,d.Fj,d.JJ,d.oH,E.gM,R.XC,R.ZL,g.ey,u.Ov],styles:[".tag-chip-list[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),a})();function V(a){return`${a.symbol}.${a.exchange}`}var f=l(7084),J=l(1520),A=l(4144);function W(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mat-chip",10),e.NdJ("removed",function(){const r=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.removeTag(s.category,r))}),e._uU(1),e.TgZ(2,"button",11)(3,"mat-icon"),e._uU(4,"cancel"),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}let Y=(()=>{class a{constructor(t){this.fb=t,this.separatorKeysCodes=[v.K5,v.OC],this.categoryDeleted=new e.vpe,this.categoryChanged=new e.vpe}ngOnInit(){this.form=this.fb.group({name:[this.category.name,d.kI.required]}),this.tags=[...this.category.tags],this.form.get("name")?.valueChanges.pipe((0,B.O)(this.category.name),(0,J.G)()).subscribe(([t,i])=>{this.categoryChanged.emit({name:t,category:{...this.latestCategoryState,name:i}})})}removeTag(t,i){this.tags=[...this.tags.filter(o=>o.id!==i.id)],this.categoryChanged.emit({name:this.form.get("name")?.value,category:this.latestCategoryState})}addTag(t,i){const o=(i.value||"").trim();o&&!this.tags.some(r=>r.name===o)&&(this.tags=[...this.tags,{name:o}],i.chipInput.clear(),this.categoryChanged.emit({name:this.form.get("name")?.value,category:this.latestCategoryState}))}deleteCategory(){this.categoryDeleted.emit(this.latestCategoryState)}get latestCategoryState(){return Object.assign({},this.category,this.form.value,{tags:this.tags})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.j3))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-tag-category-control"]],inputs:{category:"category"},outputs:{categoryDeleted:"categoryDeleted",categoryChanged:"categoryChanged"},decls:16,vars:6,consts:[[1,"category-control-panel"],[3,"formGroup"],["appearance","fill",1,"category-name"],["matInput","","type","text","id","name","placeholder","Name","formControlName","name","autofocus",""],["appearance","fill",1,"category-tags-list"],["aria-label","Tag selection","multiple",""],["categoriesTags",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","New Tag...",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["mat-button","","color","warn",3,"click"],[3,"removed"],["matChipRemove",""]],template:function(t,i){if(1&t&&(e.TgZ(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.qZA(),e._UZ(4,"mat-panel-description"),e.qZA(),e.TgZ(5,"form",1)(6,"mat-form-field",2),e._UZ(7,"input",3),e.qZA(),e.TgZ(8,"mat-form-field",4)(9,"mat-chip-list",5,6),e.YNc(11,W,5,1,"mat-chip",7),e.TgZ(12,"input",8),e.NdJ("matChipInputTokenEnd",function(r){return i.addTag(i.category,r)}),e.qZA()()()(),e.TgZ(13,"mat-action-row")(14,"button",9),e.NdJ("click",function(){return i.deleteCategory()}),e._uU(15,"Delete"),e.qZA()()()),2&t){const o=e.MAs(10);let r;e.xp6(3),e.hij(" ",null==(r=i.form.get("name"))?null:r.value," "),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(6),e.Q6J("ngForOf",i.tags),e.xp6(1),e.Q6J("matChipInputFor",o)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("matChipInputAddOnBlur",!0)}},dependencies:[u.sg,y.lW,C.Hw,m.qn,m.HS,m.oH,m.qH,x.KE,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,f.ib,f.VG,f.yz,f.yK,f.u4,A.Nt],styles:[".category-name[_ngcontent-%COMP%], .category-tags-list[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .category-control-panel[_ngcontent-%COMP%]:last-of-type{border-bottom-right-radius:0;border-bottom-left-radius:0;margin-bottom:5px}[_nghost-%COMP%]   .category-control-panel[_ngcontent-%COMP%]:first-of-type{border-top-right-radius:0;border-top-left-radius:0}"],changeDetection:0}),a})();function z(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"app-tag-category-control",4),e.NdJ("categoryChanged",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleCategoryChanged(o))})("categoryDeleted",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleCategoryDeleted(o))}),e.qZA()}2&a&&e.Q6J("category",n.$implicit)}function K(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"app-tag-category-control",4),e.NdJ("categoryChanged",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleCategoryChanged(o))})("categoryDeleted",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.handleCategoryDeleted(o))}),e.qZA()}2&a&&e.Q6J("category",n.$implicit)}let X=(()=>{class a{constructor(t,i,o){this.tagCategoryService=t,this.cd=i,this.dialogRef=o,this.separatorKeysCodes=[v.K5,v.OC],this.newCategoryName="New Tag Category",this.categoriesToDelete=[]}ngOnInit(){this.tagCategoryService.getTagCategories().subscribe(t=>{this.persistedCategories=t,this.newCategories=[],this.categoriesState=JSON.parse(JSON.stringify(this.persistedCategories)),this.cd.detectChanges()})}onOkayClick(){const t=this.categoriesState.filter(r=>!r.id),i=this.persistedCategories.reduce((r,s)=>({...r,[s.id]:s}),{}),o=this.categoriesState.filter(r=>!!r.id&&JSON.stringify(r)!==JSON.stringify(i[r.id]));this.dialogRef.close({add:t,update:o,delete:this.categoriesToDelete})}addCategory(){const t={id:null,name:this.generateNewCategoryName(),color:"#999",tags:[]};this.newCategories=[t,...this.newCategories],this.categoriesState=[t,...this.categoriesState],this.cd.detectChanges()}generateNewCategoryName(){const t=this.categoriesState.find(o=>o.name.startsWith(this.newCategoryName));if(!t)return this.newCategoryName;let i;return i=t.name===this.newCategoryName?" 2":" "+(+t.name[t.name.length-1]+1),this.newCategoryName+i}handleCategoryChanged({name:t,category:i}){this.categoriesState=this.categoriesState.map(o=>o.name===t?i:o)}handleCategoryDeleted(t){t.id&&(this.categoriesToDelete=[...this.categoriesToDelete,t.id]),this.newCategories=[...this.newCategories.filter(i=>i.name!==t.name)],this.persistedCategories=[...this.persistedCategories.filter(i=>i.name!==t.name)],this.categoriesState=[...this.categoriesState.filter(i=>i.name!==t.name)],this.cd.detectChanges()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(D.$),e.Y36(e.sBO),e.Y36(h.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-tag-categories-dialog"]],decls:13,vars:3,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-button","",1,"add-category-btn",3,"click"],[3,"category","categoryChanged","categoryDeleted",4,"ngFor","ngForOf"],["mat-button","",3,"click"],[3,"category","categoryChanged","categoryDeleted"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return i.addCategory()}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA()()(),e.TgZ(6,"mat-dialog-content")(7,"mat-accordion"),e.YNc(8,z,1,1,"app-tag-category-control",2),e.YNc(9,K,1,1,"app-tag-category-control",2),e.qZA()(),e.TgZ(10,"mat-dialog-actions")(11,"button",3),e.NdJ("click",function(){return i.onOkayClick()}),e._uU(12,"Okay"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu("Tag Categories"),e.xp6(6),e.Q6J("ngForOf",i.newCategories),e.xp6(1),e.Q6J("ngForOf",i.persistedCategories))},dependencies:[u.sg,y.lW,C.Hw,h.uh,h.xY,h.H8,f.pp,Y],styles:[".spinner-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.dialog-title[_ngcontent-%COMP%]{display:inline-flex}.dialog-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}"],changeDetection:0}),a})();var ee=l(4128),te=l(529);let S=(()=>{class a{constructor(t){this.http=t}getPortfolioPositions(){return this.http.get("/portfolio-positions")}getPortfolioPositionsView(t){return this.http.get(`/portfolio-positions/view?hideSold=${t}`)}updatePositionTags(t,i){return this.http.post(`/portfolio-positions/${t}/tags`,i)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(te.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac}),a})();var M=l(2687),I=l(1281);let ie=0;const ae=(0,g.Id)(class{}),L="mat-badge-content";let ne=(()=>{class a extends ae{constructor(t,i,o,r,s){super(),this._ngZone=t,this._elementRef=i,this._ariaDescriber=o,this._renderer=r,this._animationMode=s,this._color="primary",this._overlap=!0,this.position="above after",this.size="medium",this._id=ie++,this._isInitialized=!1}get color(){return this._color}set color(t){this._setColor(t),this._color=t}get overlap(){return this._overlap}set overlap(t){this._overlap=(0,I.Ig)(t)}get content(){return this._content}set content(t){this._updateRenderedContent(t)}get description(){return this._description}set description(t){this._updateHostAriaDescription(t)}get hidden(){return this._hidden}set hidden(t){this._hidden=(0,I.Ig)(t)}isAbove(){return-1===this.position.indexOf("below")}isAfter(){return-1===this.position.indexOf("before")}getBadgeElement(){return this._badgeElement}ngOnInit(){this._clearExistingBadges(),this.content&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement(),this._updateRenderedContent(this.content)),this._isInitialized=!0}ngOnDestroy(){this._renderer.destroyNode&&this._renderer.destroyNode(this._badgeElement),this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description)}_createBadgeElement(){const t=this._renderer.createElement("span"),i="mat-badge-active";return t.setAttribute("id",`mat-badge-content-${this._id}`),t.setAttribute("aria-hidden","true"),t.classList.add(L),"NoopAnimations"===this._animationMode&&t.classList.add("_mat-animation-noopable"),this._elementRef.nativeElement.appendChild(t),"function"==typeof requestAnimationFrame&&"NoopAnimations"!==this._animationMode?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{t.classList.add(i)})}):t.classList.add(i),t}_updateRenderedContent(t){const i=`${t??""}`.trim();this._isInitialized&&i&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement()),this._badgeElement&&(this._badgeElement.textContent=i),this._content=i}_updateHostAriaDescription(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description),t&&this._ariaDescriber.describe(this._elementRef.nativeElement,t),this._description=t}_setColor(t){const i=this._elementRef.nativeElement.classList;i.remove(`mat-badge-${this._color}`),t&&i.add(`mat-badge-${t}`)}_clearExistingBadges(){const t=this._elementRef.nativeElement.querySelectorAll(`:scope > .${L}`);for(const i of Array.from(t))i!==this._badgeElement&&i.remove()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.R0b),e.Y36(e.SBq),e.Y36(M.$s),e.Y36(e.Qsj),e.Y36(e.QbO,8))},a.\u0275dir=e.lG2({type:a,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(t,i){2&t&&e.ekj("mat-badge-overlap",i.overlap)("mat-badge-above",i.isAbove())("mat-badge-below",!i.isAbove())("mat-badge-before",!i.isAfter())("mat-badge-after",i.isAfter())("mat-badge-small","small"===i.size)("mat-badge-medium","medium"===i.size)("mat-badge-large","large"===i.size)("mat-badge-hidden",i.hidden||!i.content)("mat-badge-disabled",i.disabled)},inputs:{disabled:["matBadgeDisabled","disabled"],color:["matBadgeColor","color"],overlap:["matBadgeOverlap","overlap"],position:["matBadgePosition","position"],content:["matBadge","content"],description:["matBadgeDescription","description"],size:["matBadgeSize","size"],hidden:["matBadgeHidden","hidden"]},features:[e.qOj]}),a})(),oe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[M.rt,g.BQ,g.BQ]}),a})();var w=l(9643);const re=["input"],se=function(a){return{enterDuration:a}},le=["*"],de=new e.OlP("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let ce=0;const ge={provide:d.JU,useExisting:(0,e.Gpc)(()=>O),multi:!0};class pe{constructor(n,t){this.source=n,this.checked=t}}const be=(0,g.sb)((0,g.pj)((0,g.Kr)((0,g.Id)(class{constructor(a){this._elementRef=a}}))));let he=(()=>{class a extends be{constructor(t,i,o,r,s,c,b){super(t),this._focusMonitor=i,this._changeDetectorRef=o,this.defaults=s,this._onChange=_=>{},this._onTouched=()=>{},this._required=!1,this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new e.vpe,this.toggleChange=new e.vpe,this.tabIndex=parseInt(r)||0,this.color=this.defaultColor=s.color||"accent",this._noopAnimations="NoopAnimations"===c,this.id=this._uniqueId=`${b}${++ce}`}get required(){return this._required}set required(t){this._required=(0,I.Ig)(t)}get checked(){return this._checked}set checked(t){this._checked=(0,I.Ig)(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._focused=!0:t||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}}return a.\u0275fac=function(t){e.$Z()},a.\u0275dir=e.lG2({type:a,inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},features:[e.qOj]}),a})(),O=(()=>{class a extends he{constructor(t,i,o,r,s,c){super(t,i,o,r,s,c,"mat-slide-toggle-")}_createChangeEvent(t){return new pe(this,t)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(M.tE),e.Y36(e.sBO),e.$8M("tabindex"),e.Y36(de),e.Y36(e.QbO,8))},a.\u0275cmp=e.Xpm({type:a,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&e.Gf(re,5),2&t){let o;e.iGM(o=e.CRH())&&(i._inputElement=o.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:13,hostBindings:function(t,i){2&t&&(e.Ikx("id",i.id),e.uIk("tabindex",null)("aria-label",null)("aria-labelledby",null)("name",null),e.ekj("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matSlideToggle"],features:[e._Bn([ge]),e.qOj],ngContentSelectors:le,decls:14,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(e.F$t(),e.TgZ(0,"label",0,1)(2,"span",2)(3,"input",3,4),e.NdJ("change",function(r){return i._onChangeEvent(r)})("click",function(r){return i._onInputClick(r)}),e.qZA(),e.TgZ(5,"span",5),e._UZ(6,"span",6),e.TgZ(7,"span",7),e._UZ(8,"span",8),e.qZA()()(),e.TgZ(9,"span",9,10),e.NdJ("cdkObserveContent",function(){return i._onLabelTextChange()}),e.TgZ(11,"span",11),e._uU(12,"\xa0"),e.qZA(),e.Hsn(13),e.qZA()()),2&t){const o=e.MAs(1),r=e.MAs(10);e.uIk("for",i.inputId),e.xp6(2),e.ekj("mat-slide-toggle-bar-no-side-margin",!r.textContent||!r.textContent.trim()),e.xp6(1),e.Q6J("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),e.uIk("name",i.name)("aria-checked",i.checked)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),e.xp6(4),e.Q6J("matRippleTrigger",o)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",e.VKq(18,se,i._noopAnimations?0:150))}},dependencies:[g.wG,w.wD],styles:['.mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%;display:block}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.mat-slide-toggle-input:focus~.mat-slide-toggle-thumb-container .mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}'],encapsulation:2,changeDetection:0}),a})(),N=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({}),a})(),_e=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[N,g.si,g.BQ,w.Q8,N,g.BQ]}),a})();function fe(a,n){if(1&a&&(e.TgZ(0,"div",7)(1,"a",8),e._uU(2),e.qZA(),e.TgZ(3,"div",9),e._uU(4),e.qZA()()),2&a){const t=n.row;e.xp6(1),e.Q6J("routerLink","/symbols/"+t.identifier.exchange+"-"+t.identifier.symbol),e.xp6(1),e.Oqu(t.identifier.symbol),e.xp6(2),e.Oqu(t.companyName)}}function ve(a,n){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",12),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().row,s=e.oxw();return e.KtG(s.openPositionTagsDialog(o,r))}),e.TgZ(2,"mat-icon"),e._uU(3,"library_add"),e.qZA()(),e.BQk()}}function Te(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().row,s=e.oxw();return e.KtG(s.openPositionTagsDialog(o,r))}),e.TgZ(1,"mat-icon",13),e._uU(2,"tag"),e.qZA(),e.TgZ(3,"span",14),e._uU(4),e.qZA()()}if(2&a){const t=e.oxw().row;e.xp6(1),e.Q6J("matBadge",t.tags.length),e.xp6(3),e.Oqu(t.tags.length+" tags linked to this position")}}function ye(a,n){if(1&a&&(e.YNc(0,ve,4,0,"ng-container",10),e.YNc(1,Te,5,2,"ng-template",null,11,e.W1O)),2&a){const t=n.row,i=e.MAs(2);e.Q6J("ngIf",0===t.tags.length)("ngIfElse",i)}}function Ce(a,n){if(1&a&&(e._uU(0),e.ALo(1,"currency")),2&a){const t=n.row;e.hij(" ",e.xi3(1,1,t.price,t.currencyCode)," ")}}function xe(a,n){1&a&&e._uU(0),2&a&&e.hij(" ",n.value+"%"," ")}function Me(a,n){if(1&a&&(e._uU(0),e.ALo(1,"currency")),2&a){const t=n.row;e.hij(" ",e.xi3(1,1,t.total,t.currencyCode)," ")}}function Ie(a,n){if(1&a&&(e._uU(0),e.ALo(1,"currency")),2&a){const t=n.row;e.hij(" ",e.xi3(1,1,t.marketValue,t.currencyCode)," ")}}function Pe(a,n){1&a&&e._uU(0),2&a&&e.hij(" ",n.row.yieldOnCost+"%"," ")}function De(a,n){if(1&a&&(e._uU(0),e.ALo(1,"currency")),2&a){const t=n.row;e.hij(" ",e.xi3(1,1,t.accumulatedDividends,t.currencyCode)," ")}}function Re(a,n){if(1&a&&(e._uU(0),e.ALo(1,"currency")),2&a){const t=n.row;e.hij(" ",e.xi3(1,1,t.realizedPnl,t.currencyCode)," ")}}function we(a,n){1&a&&(e.TgZ(0,"ngx-datatable-column",5),e.YNc(1,Re,2,4,"ng-template",4),e.qZA()),2&a&&e.Q6J("prop","realizedPnl")("name","Realized P&L")}const ke=function(){return{prop:"pctOfPortfolio",dir:"desc"}},Be=function(a){return[a]},Ee=[{path:"",component:(()=>{class a{constructor(t,i,o){this.portfolioPositionService=t,this.tagCategoryService=i,this.matDialog=o,this.headerHeight=50,this.footerHeight=50,this.rowHeight=60,this.pageLimit=30,this.ColumnMode=T.hq,this.hideSoldPositions=!0,this.positions$=this.getPortfolioPositions()}ngOnInit(){}openPositionTagsDialog(t,i){this.matDialog.open(U,{restoreFocus:!1,disableClose:!1,data:{title:`${V(i.identifier)} Position Tags`,selectedTags:i.tags}}).afterClosed().subscribe(r=>{if(!r)return;if(r.openTagCategoriesDialog)return void this.matDialog.open(X,this.getTagCategoriesDialogConfig()).afterClosed().subscribe(_=>{_&&(_.add.length>0||_.update.length>0||_.delete.length>0)&&this.propagateTagCategoriesChanges(_)});const s=r.selectedTags;if(!s||JSON.stringify(s)===JSON.stringify(i.tags))return;const c=s.map(b=>b.id);this.portfolioPositionService.updatePositionTags(i.id,c).subscribe(()=>{this.positions$=this.getPortfolioPositions()})})}getTagCategoriesDialogConfig(){return{restoreFocus:!1,disableClose:!1}}propagateTagCategoriesChanges(t){const i=t.update.map(s=>this.tagCategoryService.updateTagCategory(s)),o=t.add.map(s=>this.tagCategoryService.createTagCategory(s)),r=t.delete.map(s=>this.tagCategoryService.deleteTagCategory(s));(0,ee.D)([...i,...o,...r]).subscribe(()=>{this.positions$=this.getPortfolioPositions()})}getPortfolioPositions(){return this.portfolioPositionService.getPortfolioPositionsView(this.hideSoldPositions)}onHideSoldToggled({}){this.positions$=this.getPortfolioPositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(S),e.Y36(D.$),e.Y36(h.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-positions-container"]],decls:24,vars:33,consts:[[1,"positions-header"],[3,"ngModel","ngModelChange","change"],[1,"material",3,"rows","columnMode","headerHeight","rowHeight","limit","footerHeight","sorts"],[3,"prop"],["ngx-datatable-cell-template",""],[3,"prop","name"],[3,"prop","name",4,"ngIf"],[1,"identifier"],[1,"identifier-symbol",3,"routerLink"],[1,"identifier-company"],[4,"ngIf","ngIfElse"],["tags",""],["mat-button","",3,"click"],["matBadgeColor","warn",3,"matBadge"],[1,"cdk-visually-hidden"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"mat-slide-toggle",1),e.NdJ("ngModelChange",function(r){return i.hideSoldPositions=r})("change",function(r){return i.onHideSoldToggled(r)}),e._uU(2,"Hide Sold"),e.qZA()(),e.TgZ(3,"ngx-datatable",2),e.ALo(4,"async"),e.TgZ(5,"ngx-datatable-column",3),e.YNc(6,fe,5,3,"ng-template",4),e.qZA(),e.TgZ(7,"ngx-datatable-column",5),e.YNc(8,ye,3,2,"ng-template",4),e.qZA(),e._UZ(9,"ngx-datatable-column",5),e.TgZ(10,"ngx-datatable-column",5),e.YNc(11,Ce,2,4,"ng-template",4),e.qZA(),e.TgZ(12,"ngx-datatable-column",5),e.YNc(13,xe,1,1,"ng-template",4),e.qZA(),e.TgZ(14,"ngx-datatable-column",5),e.YNc(15,Me,2,4,"ng-template",4),e.qZA(),e.TgZ(16,"ngx-datatable-column",5),e.YNc(17,Ie,2,4,"ng-template",4),e.qZA(),e.TgZ(18,"ngx-datatable-column",5),e.YNc(19,Pe,1,1,"ng-template",4),e.qZA(),e.TgZ(20,"ngx-datatable-column",5),e.YNc(21,De,2,4,"ng-template",4),e.qZA(),e._UZ(22,"ngx-datatable-column",5),e.YNc(23,we,2,2,"ngx-datatable-column",6),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngModel",i.hideSoldPositions),e.xp6(2),e.Q6J("rows",e.lcZ(4,28,i.positions$))("columnMode",i.ColumnMode.standard)("headerHeight",i.headerHeight)("rowHeight",i.rowHeight)("limit",i.pageLimit)("footerHeight",i.footerHeight)("sorts",e.VKq(31,Be,e.DdM(30,ke))),e.xp6(2),e.Q6J("prop","identifier"),e.xp6(2),e.Q6J("prop","tags")("name","Tags"),e.xp6(2),e.Q6J("prop","quantity")("name","Shares"),e.xp6(1),e.Q6J("prop","price")("name","Cost Per Share"),e.xp6(2),e.Q6J("prop","pctOfPortfolio")("name","% of Portfolio"),e.xp6(2),e.Q6J("prop","total")("name","Total Cost"),e.xp6(2),e.Q6J("prop","marketValue")("name","Market Value"),e.xp6(2),e.Q6J("prop","yieldOnCost")("name","Yield On Cost"),e.xp6(2),e.Q6J("prop","accumulatedDividends")("name","Accumulated Dividends"),e.xp6(2),e.Q6J("prop","upcomingDividendDate")("name","Upcoming Dividend Date"),e.xp6(1),e.Q6J("ngIf",!i.hideSoldPositions))},dependencies:[u.O5,P.yS,T.nE,T.UC,T.vq,y.lW,C.Hw,d.JJ,ne,O,d.On,u.Ov,u.H9],styles:[".positions-header[_ngcontent-%COMP%]{display:flex;margin:5px;justify-content:flex-end}.identifier-company[_ngcontent-%COMP%]{font-size:small}"],changeDetection:0}),a})()}];let Ae=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[P.Bz.forChild(Ee),P.Bz]}),a})();var Se=l(4080);l(7340),l(3353);let je=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[u.ez,g.BQ,Se.eL,g.si,w.Q8,M.rt,g.BQ]}),a})();var Ze=l(1572),Qe=l(3546),Ge=l(2474);let $e=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[S],imports:[u.ez,Ae,T.xD,y.ot,C.Ps,h.Is,je,m.Hi,x.lN,d.UX,E.AV,Ze.Cq,oe,R.Bb,Qe.QW,_e,d.u5,f.To,A.c,Ge.I]}),a})()}}]);