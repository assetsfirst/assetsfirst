"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([[9],{9009:(Ni,Ot,C)=>{C.r(Ot),C.d(Ot,{PortfoliosModule:()=>er});var b=C(6895),i=C(4650),k=C(7579),ee=C(8372),q=C(2722),Fe=C(3900),ie=C(5963);function Le(n,e){if(1&n&&i._UZ(0,"div",3),2&n){const t=e.index,s=i.oxw();i.Q6J("ngStyle",s.gridRenderer.getGridColumnStyle(t))}}function Ae(n,e){if(1&n&&i._UZ(0,"div",4),2&n){const t=e.index,s=i.oxw();i.Q6J("ngStyle",s.gridRenderer.getGridRowStyle(t))}}const se=["*"];function ze(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",8),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Ne(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",9),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function He(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",10),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Mt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",11),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Be(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",12),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function $t(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",13),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function ne(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",14),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Ge(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",15),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}var x=(()=>{return(n=x||(x={})).Fit="fit",n.ScrollVertical="scrollVertical",n.ScrollHorizontal="scrollHorizontal",n.Fixed="fixed",n.VerticalFixed="verticalFixed",n.HorizontalFixed="horizontalFixed",x;var n})(),pt=(()=>{return(n=pt||(pt={})).Always="always",n.OnDragAndResize="onDrag&Resize",n.None="none",pt;var n})(),R=(()=>{return(n=R||(R={})).None="none",n.CompactUp="compactUp",n.CompactLeft="compactLeft",n.CompactUpAndLeft="compactUp&Left",n.CompactLeftAndUp="compactLeft&Up",n.CompactRight="compactRight",n.CompactUpAndRight="compactUp&Right",n.CompactRightAndUp="compactRight&Up",n.CompactDown="compactDown",n.CompactDownAndLeft="compactDown&Left",n.CompactLeftAndDown="compactLeft&Down",n.CompactDownAndRight="compactDown&Right",n.CompactRightAndDown="compactRight&Down",R;var n})(),A=(()=>{return(n=A||(A={})).LTR="ltr",n.RTL="rtl",A;var n})();class Ye{constructor(e){this.gridster=e}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==R.None&&(this.gridster.$options.compactType===R.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===R.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===R.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===R.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===R.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===R.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===R.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===R.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===R.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===R.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===R.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===R.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(e){this.gridster.$options.compactType!==R.None&&(this.gridster.$options.compactType===R.CompactUp?this.moveTillCollision(e,"y",-1):this.gridster.$options.compactType===R.CompactLeft?this.moveTillCollision(e,"x",-1):this.gridster.$options.compactType===R.CompactUpAndLeft?(this.moveTillCollision(e,"y",-1),this.moveTillCollision(e,"x",-1)):this.gridster.$options.compactType===R.CompactLeftAndUp?(this.moveTillCollision(e,"x",-1),this.moveTillCollision(e,"y",-1)):this.gridster.$options.compactType===R.CompactUpAndRight?(this.moveTillCollision(e,"y",-1),this.moveTillCollision(e,"x",1)):this.gridster.$options.compactType===R.CompactDown?this.moveTillCollision(e,"y",1):this.gridster.$options.compactType===R.CompactDownAndLeft?(this.moveTillCollision(e,"y",1),this.moveTillCollision(e,"x",-1)):this.gridster.$options.compactType===R.CompactLeftAndDown?(this.moveTillCollision(e,"x",-1),this.moveTillCollision(e,"y",1)):this.gridster.$options.compactType===R.CompactDownAndRight?(this.moveTillCollision(e,"y",1),this.moveTillCollision(e,"x",1)):this.gridster.$options.compactType===R.CompactRightAndDown&&(this.moveTillCollision(e,"x",1),this.moveTillCollision(e,"y",1)))}checkCompactMovement(e,t){let s=!1;this.gridster.grid.forEach(r=>{!1!==r.$item.compactEnabled&&this.moveTillCollision(r.$item,e,t)&&(s=!0,r.item[e]=r.$item[e],r.itemChanged())}),s&&this.checkCompact()}moveTillCollision(e,t,s){return e[t]+=s,this.gridster.checkCollision(e)?(e[t]-=s,!1):(this.moveTillCollision(e,t,s),!0)}}const Ze={gridType:x.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:R.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:pt.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:A.LTR};class M{static merge(e,t,s){for(const r in t)void 0!==t[r]&&s.hasOwnProperty(r)&&("object"==typeof t[r]?(r in e||(e[r]={}),e[r]=M.merge(e[r],t[r],s[r])):e[r]=t[r]);return e}static checkTouchEvent(e){void 0===e.clientX&&e.touches&&(e.touches&&e.touches.length?(e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY):e.changedTouches&&e.changedTouches.length&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY))}static checkContentClassForEvent(e,t){if(e.$options.draggable.ignoreContent){if(!M.checkDragHandleClass(t.target,t.currentTarget,e.$options.draggable.dragHandleClass,e.$options.draggable.ignoreContentClass))return!0}else if(M.checkContentClass(t.target,t.currentTarget,e.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(e,t){return M.checkContentClass(t.target,t.currentTarget,e.$options.draggable.ignoreContentClass)||M.checkContentClass(t.target,t.currentTarget,e.$options.draggable.dragHandleClass)}static checkDragHandleClass(e,t,s,r){if(!e||e===t)return!1;if(e.hasAttribute("class")){const o=e.getAttribute("class").split(" ");if(o.indexOf(s)>-1)return!0;if(o.indexOf(r)>-1)return!1}return M.checkDragHandleClass(e.parentNode,t,s,r)}static checkContentClass(e,t,s){return!(!e||e===t)&&(!!(e.hasAttribute("class")&&e.getAttribute("class").split(" ").indexOf(s)>-1)||M.checkContentClass(e.parentNode,t,s))}static compareItems(e,t){return e.y>t.y?-1:e.y<t.y?1:e.x>t.x?-1:1}}class re{constructor(e){this.gridster=e,this.emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||M.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;const s=this.getValidItemFromEvent(t);!s||(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,s),this.gridster.cdRef.markForCheck())},this.emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||M.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t);!s||(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,s),this.gridster.cdRef.markForCheck())},this.emptyCellDragDrop=t=>{const s=this.getValidItemFromEvent(t);!s||(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,s),this.gridster.cdRef.markForCheck())},this.emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t);s?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=s):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()},this.emptyCellMouseDown=t=>{if(M.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t);!s||1!==t.buttons&&!(t instanceof TouchEvent)||(this.initialItem=s,this.gridster.movingItem=s,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))},this.emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t,this.initialItem);!s||(this.gridster.movingItem=s,this.gridster.previewStyle())},this.emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();const s=this.getValidItemFromEvent(t,this.initialItem);s&&(this.gridster.movingItem=s),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()}}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}getPixelsX(e,t){const s=this.gridster.options.scale;return s?(e.clientX-t.left)/s+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():e.clientX+this.gridster.el.scrollLeft-t.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(e,t){const s=this.gridster.options.scale;return s?(e.clientY-t.top)/s+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():e.clientY+this.gridster.el.scrollTop-t.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(e,t){e.preventDefault(),e.stopPropagation(),M.checkTouchEvent(e);const s=this.gridster.el.getBoundingClientRect(),r=this.getPixelsX(e,s),o=this.getPixelsY(e,s),a={x:this.gridster.pixelsToPositionX(r,Math.floor,!0),y:this.gridster.pixelsToPositionY(o,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(t&&(a.cols=Math.min(Math.abs(t.x-a.x)+1,this.gridster.$options.emptyCellDragMaxCols),a.rows=Math.min(Math.abs(t.y-a.y)+1,this.gridster.$options.emptyCellDragMaxRows),t.x<a.x?a.x=t.x:t.x-a.x>this.gridster.$options.emptyCellDragMaxCols-1&&(a.x=this.gridster.movingItem?this.gridster.movingItem.x:0),t.y<a.y?a.y=t.y:t.y-a.y>this.gridster.$options.emptyCellDragMaxRows-1&&(a.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),this.gridster.$options.enableOccupiedCellDrop||!this.gridster.checkCollision(a))return a}}class We{constructor(e){this.gridster=e}destroy(){this.gridster=null}updateItem(e,t,s){if(this.gridster.mobile)this.clearCellPosition(s,e),s.setStyle(e,"height",this.gridster.$options.keepFixedHeightInMobile?(t.rows-1)*this.gridster.$options.margin+t.rows*this.gridster.$options.fixedRowHeight+"px":t.rows*this.gridster.curWidth/t.cols+"px"),s.setStyle(e,"width",this.gridster.$options.keepFixedWidthInMobile?this.gridster.$options.fixedColWidth+"px":""),s.setStyle(e,"margin-bottom",this.gridster.$options.margin+"px"),s.setStyle(e,A.LTR?"margin-right":"margin-left","");else{const r=Math.round(this.gridster.curColWidth*t.x),o=Math.round(this.gridster.curRowHeight*t.y),a=this.gridster.curColWidth*t.cols-this.gridster.$options.margin,l=this.gridster.curRowHeight*t.rows-this.gridster.$options.margin;this.setCellPosition(s,e,r,o),s.setStyle(e,"width",a+"px"),s.setStyle(e,"height",l+"px");let d=null,p=null;this.gridster.$options.outerMargin&&(this.gridster.rows===t.rows+t.y&&(d=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginBottom+"px":this.gridster.$options.margin+"px"),this.gridster.columns===t.cols+t.x&&(p=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginRight+"px":this.gridster.$options.margin+"px")),s.setStyle(e,"margin-bottom",d),s.setStyle(e,A.LTR?"margin-right":"margin-left",p)}}updateGridster(){let e="",t="",s="",r="";if(this.gridster.$options.gridType===x.Fit)e=x.Fit,t=x.ScrollVertical,s=x.ScrollHorizontal,r=x.Fixed;else if(this.gridster.$options.gridType===x.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,e=x.ScrollVertical,t=x.Fit,s=x.ScrollHorizontal,r=x.Fixed;else if(this.gridster.$options.gridType===x.ScrollHorizontal){const o=this.gridster.$options.rowHeightRatio;this.gridster.curColWidth=this.gridster.curRowHeight*(o>=1?o:o+1),e=x.ScrollHorizontal,t=x.Fit,s=x.ScrollVertical,r=x.Fixed}else this.gridster.$options.gridType===x.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=x.Fixed,t=x.Fit,s=x.ScrollVertical,r=x.ScrollHorizontal):this.gridster.$options.gridType===x.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=x.ScrollVertical,t=x.Fit,s=x.ScrollHorizontal,r=x.Fixed):this.gridster.$options.gridType===x.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=x.ScrollHorizontal,t=x.Fit,s=x.ScrollVertical,r=x.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==x.Fit?this.gridster.renderer.removeClass(this.gridster.el,e):this.gridster.renderer.addClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,s),this.gridster.renderer.removeClass(this.gridster.el,r)}getGridColumnStyle(e){return{...this.getLeftPosition(this.gridster.curColWidth*e),width:this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin+"px"}}getGridRowStyle(e){return{...this.getTopPosition(this.gridster.curRowHeight*e),width:this.gridster.gridColumns.length*this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.curRowHeight-this.gridster.$options.margin+"px"}}getLeftPosition(e){const t=this.gridster.$options.dirType===A.RTL?-e:e;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+t+"px)"}:{left:this.getLeftMargin()+t+"px"}}getTopPosition(e){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+e+"px)"}:{top:this.getTopMargin()+e+"px"}}clearCellPosition(e,t){this.gridster.$options.useTransformPositioning?e.setStyle(t,"transform",""):(e.setStyle(t,"top",""),e.setStyle(t,"left",""))}setCellPosition(e,t,s,r){const o=this.gridster.$options.dirType===A.RTL?-s:s;this.gridster.$options.useTransformPositioning?e.setStyle(t,"transform","translate3d("+o+"px, "+r+"px, 0)"):(e.setStyle(t,"left",this.getLeftMargin()+o+"px"),e.setStyle(t,"top",this.getTopMargin()+r+"px"))}getLeftMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginLeft?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginTop?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}}let mt,h,u,m,f,g,w,S,N,Ue=(()=>{class n{constructor(t,s){this.renderer=s,this.el=t.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(t=>this.previewStyle(t))}ngOnDestroy(){this.sub?.unsubscribe()}previewStyle(t){t?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,t,this.renderer)):this.renderer.setStyle(this.el,"display","")}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.SBq),i.Y36(i.Qsj))},n.\u0275cmp=i.Xpm({type:n,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},decls:0,vars:0,template:function(t,s){},styles:["gridster-preview{position:absolute;display:none;background:rgba(0,0,0,.15)}\n"],encapsulation:2}),n})(),oe=(()=>{class n{constructor(t,s,r,o){this.renderer=s,this.cdRef=r,this.zone=o,this.columns=0,this.rows=0,this.gridColumns=[],this.gridRows=[],this.previewStyle$=new i.vpe,this.calculateLayout$=new k.x,this.resize$=new k.x,this.destroy$=new k.x,this.optionsChanged=()=>{this.setOptions();let l,a=this.grid.length-1;for(;a>=0;a--)l=this.grid[a],l.updateOptions();this.calculateLayout()},this.onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())},this.getNextPossiblePosition=(a,l={})=>{-1===a.cols&&(a.cols=this.$options.defaultItemCols),-1===a.rows&&(a.rows=this.$options.defaultItemRows),this.setGridDimensions();let p,d=l.y||0;for(;d<this.rows;d++)for(a.y=d,p=l.x||0;p<this.columns;p++)if(a.x=p,!this.checkCollision(a))return!0;const _=this.$options.maxRows>=this.rows+a.rows;return this.rows<=this.columns&&_||!(this.$options.maxCols>=this.columns+a.cols)?!!_&&(a.y=this.rows,a.x=0,!0):(a.x=this.columns,a.y=0,!0)},this.getFirstPossiblePosition=a=>{const l=Object.assign({},a);return this.getNextPossiblePosition(l),l},this.getLastPossiblePosition=a=>{let l={y:0,x:0};l=this.grid.reduce((p,_)=>{const y={y:_.$item.y+_.$item.rows-1,x:_.$item.x+_.$item.cols-1};return 1===M.compareItems(p,y)?y:p},l);const d=Object.assign({},a);return this.getNextPossiblePosition(d,l),d},this.el=t.nativeElement,this.$options=JSON.parse(JSON.stringify(Ze)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new re(this),this.compact=new Ye(this),this.gridRenderer=new We(this)}static checkCollisionTwoItemsForSwaping(t,s){return t.x+(1===t.cols?0:1)<s.x+s.cols&&t.x+t.cols>s.x+(1===s.cols?0:1)&&t.y+(1===t.rows?0:1)<s.y+s.rows&&t.y+t.rows>s.y+(1===s.rows?0:1)}checkCollisionTwoItems(t,s){if(!(t.x<s.x+s.cols&&t.x+t.cols>s.x&&t.y<s.y+s.rows&&t.y+t.rows>s.y))return!1;if(!this.$options.allowMultiLayer)return!0;const o=this.$options.defaultLayerIndex;return(void 0===t.layerIndex?o:t.layerIndex)===(void 0===s.layerIndex?o:s.layerIndex)}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe((0,ee.b)(0),(0,q.R)(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe((0,Fe.w)(()=>(0,ie.H)(100)),(0,q.R)(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(t){t.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:s=>this.getItemComponent(s)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let t,s;"fit"!==this.$options.gridType||this.mobile?(s=this.el.clientWidth,t=this.el.clientHeight):(s=this.el.offsetWidth,t=this.el.offsetHeight),(s!==this.curWidth||t!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=M.merge(this.$options,this.options,this.$options),this.$options.disableWindowResize||this.windowResize?this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null):this.windowResize=this.renderer.listen("window","resize",this.onResize),this.emptyCell.updateOptions()}ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}checkIfToResize(){const t=this.el.clientWidth,s=this.el.offsetWidth,r=this.el.scrollWidth,o=this.el.clientHeight,a=this.el.offsetHeight,l=this.el.scrollHeight;return!(t<s&&l>a&&l-a<s-t||o<a&&r>s&&r-s<a-o)}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){const t=this.el;let s,r;this.$options.setGridSize||this.$options.gridType===x.Fit&&!this.mobile?(s=t.offsetWidth,r=t.offsetHeight):(s=t.clientWidth,r=t.clientHeight),this.curWidth=s,this.curHeight=r}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let o,t=this.$options.minRows,s=this.$options.minCols,r=this.grid.length-1;for(;r>=0;r--)o=this.grid[r],o.notPlaced||(t=Math.max(t,o.$item.y+o.$item.rows),s=Math.max(s,o.$item.x+o.$item.cols));t+=this.$options.addEmptyRowsCount,(this.columns!==s||this.rows!==t)&&(this.columns=s,this.rows=t,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let r=-this.$options.margin;null!==this.$options.outerMarginLeft?(r+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(r+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),null!==this.$options.outerMarginRight?(r+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(r+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-r)/this.columns;let o=-this.$options.margin;null!==this.$options.outerMarginTop?(o+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(o+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),null!==this.$options.outerMarginBottom?(o+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(o+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-o)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let s,t=this.grid.length-1;for(;t>=0;t--)s=this.grid[t],s.setSize(),s.drag.toggle(),s.resize.toggle();this.resize$.next()}updateGrid(){"always"!==this.$options.displayGrid||this.mobile?"onDrag&Resize"===this.$options.displayGrid&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):("none"===this.$options.displayGrid||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"):this.renderer.addClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=n.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=n.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(t){void 0===t.$item.cols&&(t.$item.cols=this.$options.defaultItemCols,t.item.cols=t.$item.cols,t.itemChanged()),void 0===t.$item.rows&&(t.$item.rows=this.$options.defaultItemRows,t.item.rows=t.$item.rows,t.itemChanged()),-1===t.$item.x||-1===t.$item.y?this.autoPositionItem(t):this.checkCollision(t.$item)&&(this.$options.disableWarnings||(t.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(t.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?t.notPlaced=!0:this.autoPositionItem(t)),this.grid.push(t),this.calculateLayout$.next()}removeItem(t){this.grid.splice(this.grid.indexOf(t),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(t.item,t)}checkCollision(t){let s=!1;if(this.options.itemValidateCallback&&(s=!this.options.itemValidateCallback(t)),!s&&this.checkGridCollision(t)&&(s=!0),!s){const r=this.findItemWithItem(t);r&&(s=r)}return s}checkGridCollision(t){const $=t.cols*t.rows;return!(t.y>-1&&t.x>-1&&t.cols+t.x<=this.$options.maxCols&&t.rows+t.y<=this.$options.maxRows&&t.cols<=(void 0===t.maxItemCols?this.$options.maxItemCols:t.maxItemCols)&&t.cols>=(void 0===t.minItemCols?this.$options.minItemCols:t.minItemCols)&&t.rows<=(void 0===t.maxItemRows?this.$options.maxItemRows:t.maxItemRows)&&t.rows>=(void 0===t.minItemRows?this.$options.minItemRows:t.minItemRows)&&(void 0===t.minItemArea?this.$options.minItemArea:t.minItemArea)<=$&&(void 0===t.maxItemArea?this.$options.maxItemArea:t.maxItemArea)>=$)}findItemWithItem(t){let r,s=0;for(;s<this.grid.length;s++)if(r=this.grid[s],r.$item!==t&&this.checkCollisionTwoItems(r.$item,t))return r;return!1}findItemsWithItem(t){const s=[];let o,r=0;for(;r<this.grid.length;r++)o=this.grid[r],o.$item!==t&&this.checkCollisionTwoItems(o.$item,t)&&s.push(o);return s}autoPositionItem(t){this.getNextPossiblePosition(t.$item)?(t.notPlaced=!1,t.item.x=t.$item.x,t.item.y=t.$item.y,t.itemChanged()):(t.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(t.item,["cols","rows","x","y"])))}pixelsToPositionX(t,s,r){const o=s(t/this.curColWidth);return r?o:Math.max(o,0)}pixelsToPositionY(t,s,r){const o=s(t/this.curRowHeight);return r?o:Math.max(o,0)}positionXToPixels(t){return t*this.curColWidth}positionYToPixels(t){return t*this.curRowHeight}getItemComponent(t){return this.grid.find(s=>s.item===t)}checkCollisionForSwaping(t){let s=!1;if(this.options.itemValidateCallback&&(s=!this.options.itemValidateCallback(t)),!s&&this.checkGridCollision(t)&&(s=!0),!s){const r=this.findItemWithItemForSwapping(t);r&&(s=r)}return s}findItemWithItemForSwapping(t){let r,s=this.grid.length-1;for(;s>-1;s--)if(r=this.grid[s],r.$item!==t&&n.checkCollisionTwoItemsForSwaping(r.$item,t))return r;return!1}previewStyle(t=!1){this.movingItem?(this.compact&&t&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(t,s,r){const o=Math.max(t,Math.floor(s/r));return o<0?0:Number.isFinite(o)?Math.floor(o):0}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.SBq),i.Y36(i.Qsj),i.Y36(i.sBO),i.Y36(i.R0b))},n.\u0275cmp=i.Xpm({type:n,selectors:[["gridster"]],inputs:{options:"options"},features:[i.TTD],ngContentSelectors:se,decls:4,vars:4,consts:[["class","gridster-column",3,"ngStyle",4,"ngFor","ngForOf"],["class","gridster-row",3,"ngStyle",4,"ngFor","ngForOf"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"],[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"]],template:function(t,s){1&t&&(i.F$t(),i.YNc(0,Le,1,1,"div",0),i.YNc(1,Ae,1,1,"div",1),i.Hsn(2),i._UZ(3,"gridster-preview",2)),2&t&&(i.Q6J("ngForOf",s.gridColumns),i.xp6(1),i.Q6J("ngForOf",s.gridRows),i.xp6(2),i.Q6J("gridRenderer",s.gridRenderer)("previewStyle$",s.previewStyle$))},dependencies:[b.sg,b.PC,Ue],styles:["gridster{position:relative;box-sizing:border-box;background:grey;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}\n"],encapsulation:2}),n})();class ae{constructor(e){this.iteration=0,this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=e,this.gridster=e.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(e,t){if(this.gridster.$options.pushItems&&!t){this.pushedItemsOrder=[],this.iteration=0;const s=this.push(this.gridsterItem,e);return s||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],s}return!1}restoreTempItems(){let e=this.pushedItemsTemp.length-1;for(;e>-1;e--)this.removeFromTempPushed(this.pushedItemsTemp[e])}restoreItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.$item.x=s.item.x||0,s.$item.y=s.item.y||0,s.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.checkItemChanges(s.$item,s.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let e=this.pushedItems.length-1,t=!1;for(;e>-1;e--)this.checkPushedItem(this.pushedItems[e],e)&&(t=!0);t&&this.checkPushBack()}push(e,t){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(e.$item)||""===t)return!1;const s=this.gridster.findItemsWithItem(e.$item),r=t===this.fromNorth||t===this.fromWest;s.sort((p,_)=>r?_.$item.y-p.$item.y||_.$item.x-p.$item.x:p.$item.y-_.$item.y||p.$item.x-_.$item.x);let a,o=0,l=!0;const d=[];for(;o<s.length;o++){if(a=s[o],a===this.gridsterItem)continue;if(!a.canBeDragged()){l=!1;break}const p=this.pushedItemsTemp.indexOf(a);if(p>-1&&this.pushedItemsTempPath[p].length>10){l=!1;break}if(this.tryPattern[t][0].call(this,a,e))this.pushedItemsOrder.push(a),d.push(a);else if(this.tryPattern[t][1].call(this,a,e))this.pushedItemsOrder.push(a),d.push(a);else if(this.tryPattern[t][2].call(this,a,e))this.pushedItemsOrder.push(a),d.push(a);else{if(!this.tryPattern[t][3].call(this,a,e)){l=!1;break}this.pushedItemsOrder.push(a),d.push(a)}}if(!l&&(o=this.pushedItemsOrder.lastIndexOf(d[0]),o>-1)){let p=this.pushedItemsOrder.length-1;for(;p>=o;p--)a=this.pushedItemsOrder[p],this.pushedItemsOrder.pop(),this.removeFromTempPushed(a),this.removeFromPushedItem(a)}return this.iteration++,l}trySouth(e,t){return!!this.gridster.$options.pushDirections.south&&(this.addToTempPushed(e),e.$item.y=t.$item.y+t.$item.rows,this.push(e,this.fromNorth)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryNorth(e,t){return!!this.gridster.$options.pushDirections.north&&(this.addToTempPushed(e),e.$item.y=t.$item.y-e.$item.rows,this.push(e,this.fromSouth)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryEast(e,t){return!!this.gridster.$options.pushDirections.east&&(this.addToTempPushed(e),e.$item.x=t.$item.x+t.$item.cols,this.push(e,this.fromWest)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryWest(e,t){return!!this.gridster.$options.pushDirections.west&&(this.addToTempPushed(e),e.$item.x=t.$item.x-e.$item.cols,this.push(e,this.fromEast)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}addToTempPushed(e){let t=this.pushedItemsTemp.indexOf(e);-1===t&&(t=this.pushedItemsTemp.push(e)-1,this.pushedItemsTempPath[t]=[]),this.pushedItemsTempPath[t].push({x:e.$item.x,y:e.$item.y})}removeFromTempPushed(e){const t=this.pushedItemsTemp.indexOf(e),s=this.pushedItemsTempPath[t].pop();!s||(e.$item.x=s.x,e.$item.y=s.y,e.setSize(),this.pushedItemsTempPath[t].length||(this.pushedItemsTemp.splice(t,1),this.pushedItemsTempPath.splice(t,1)))}addToPushed(e){if(this.pushedItems.indexOf(e)<0)this.pushedItems.push(e),this.pushedItemsPath.push([{x:e.item.x||0,y:e.item.y||0},{x:e.$item.x,y:e.$item.y}]);else{const t=this.pushedItems.indexOf(e);this.pushedItemsPath[t].push({x:e.$item.x,y:e.$item.y})}}removeFromPushed(e){e>-1&&(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1))}removeFromPushedItem(e){const t=this.pushedItems.indexOf(e);t>-1&&(this.pushedItemsPath[t].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1)))}checkPushedItem(e,t){const s=this.pushedItemsPath[t];let o,a,l,r=s.length-2,d=!1;for(;r>-1;r--)o=s[r],a=e.$item.x,l=e.$item.y,e.$item.x=o.x,e.$item.y=o.y,this.gridster.findItemWithItem(e.$item)?(e.$item.x=a,e.$item.y=l):(e.setSize(),s.splice(r+1,s.length-r-1),d=!0);return s.length<2&&this.removeFromPushed(t),d}}function D(n,e,t,s,r,o,a,l,d,p){mt=n.$options.scrollSensitivity,h=n.$options.scrollSpeed,u=n.el,m=d,f=p;const _=u.offsetWidth,v=u.scrollLeft,P=u.scrollTop,$=t-P,H=u.offsetHeight+P-t-r,{clientX:I,clientY:st}=o;if(!n.$options.disableScrollVertical)if(a.clientY<st&&H<mt){if(je(),m&&f&&!f.south||N)return;N=E(1,l,a)}else if(a.clientY>st&&P>0&&$<mt){if(et(),m&&f&&!f.north||S)return;S=E(-1,l,a)}else a.clientY!==st&&U();const Et=e-v;if(!n.$options.disableScrollHorizontal)if(a.clientX<I&&v+_-e-s<=mt){if(J(),m&&f&&!f.east||g)return;g=z(1,l,a)}else if(a.clientX>I&&v>0&&Et<mt){if(X(),m&&f&&!f.west||w)return;w=z(-1,l,a)}else a.clientX!==I&&Y()}function E(n,e,t){let s=t.clientY;return window.setInterval(()=>{(!u||-1===n&&u.scrollTop-h<0)&&U(),u.scrollTop+=n*h,s+=n*h,e({clientX:t.clientX,clientY:s})},50)}function z(n,e,t){let s=t.clientX;return window.setInterval(()=>{(!u||-1===n&&u.scrollLeft-h<0)&&Y(),u.scrollLeft+=n*h,s+=n*h,e({clientX:s,clientY:t.clientY})},50)}function F(){Y(),U(),u=null}function Y(){X(),J()}function U(){je(),et()}function X(){g&&(clearInterval(g),g=0)}function J(){w&&(clearInterval(w),w=0)}function et(){N&&(clearInterval(N),N=0)}function je(){S&&(clearInterval(S),S=0)}class Hi{constructor(e){this.gridsterItem=e,this.gridster=e.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){const e=this.swapedItem.$item.x,t=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=e,this.swapedItem.$item.y=t):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(e){let t;if(t=this.gridster.$options.swapWhileDragging?this.gridster.checkCollisionForSwaping(e.$item):this.gridster.checkCollision(e.$item),t&&!0!==t&&t.canBeDragged()){const s=t,r=s.$item.x,o=s.$item.y,a=e.$item.x,l=e.$item.y,d=a-r,p=l-o;s.$item.x=e.item.x-d,s.$item.y=e.item.y-p,e.$item.x=s.item.x+d,e.$item.y=s.item.y+p,this.gridster.checkCollision(s.$item)||this.gridster.checkCollision(e.$item)?(e.$item.x=a,e.$item.y=l,s.$item.x=r,s.$item.y=o):(s.setSize(),this.swapedItem=s,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}}var G=(()=>{return(n=G||(G={})).UP="UP",n.DOWN="DOWN",n.LEFT="LEFT",n.RIGHT="RIGHT",G;var n})();class Gi{constructor(e,t,s){this.zone=s,this.collision=!1,this.dragMove=r=>{r.stopPropagation(),r.preventDefault(),M.checkTouchEvent(r);let o=this.getDirections(r);this.gridster.options.enableBoundaryControl&&(o.includes(G.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+this.margin&&(o=o.filter(a=>a!=G.UP),r=new MouseEvent(r.type,{clientX:r.clientX,clientY:this.lastMouse.clientY})),o.includes(G.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+this.margin&&(o=o.filter(a=>a!=G.LEFT),r=new MouseEvent(r.type,{clientX:this.lastMouse.clientX,clientY:r.clientY})),o.includes(G.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-this.margin&&(o=o.filter(a=>a!=G.RIGHT),r=new MouseEvent(r.type,{clientX:this.lastMouse.clientX,clientY:r.clientY})),o.includes(G.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-this.margin&&(o=o.filter(a=>a!=G.DOWN),r=new MouseEvent(r.type,{clientX:r.clientX,clientY:this.lastMouse.clientY}))),o.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,D(this.gridster,this.left,this.top,this.width,this.height,r,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(r))},this.calculateItemPositionFromMousePosition=r=>{this.gridster.options.scale?this.calculateItemPositionWithScale(r,this.gridster.options.scale):this.calculateItemPositionWithoutScale(r),this.calculateItemPosition(),this.lastMouse.clientX=r.clientX,this.lastMouse.clientY=r.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=r=>{r.stopPropagation(),r.preventDefault(),F(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,r)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})},this.cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&!0!==this.collision&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.dragStartDelay=r=>{if(r.target.classList.contains("gridster-item-resizable-handler")||M.checkContentClassForEvent(this.gridster,r))return;if(M.checkTouchEvent(r),!this.gridster.$options.draggable.delayStart)return void this.dragStart(r);const a=setTimeout(()=>{this.dragStart(r),$()},this.gridster.$options.draggable.delayStart),l=this.gridsterItem.renderer.listen("document","mouseup",$),d=this.gridsterItem.renderer.listen("document","mouseleave",$),p=this.gridsterItem.renderer.listen("window","blur",$),_=this.gridsterItem.renderer.listen("document","touchmove",function P(H){M.checkTouchEvent(H),(Math.abs(H.clientX-r.clientX)>9||Math.abs(H.clientY-r.clientY)>9)&&$()}),y=this.gridsterItem.renderer.listen("document","touchend",$),v=this.gridsterItem.renderer.listen("document","touchcancel",$);function $(){clearTimeout(a),p(),l(),d(),_(),y(),v()}},this.gridsterItem=e,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(e){e.which&&1!==e.which||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.diffLeft=this.gridster.$options.dirType===A.RTL?e.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:e.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=e.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new ae(this.gridsterItem),this.swap=new Hi(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}calculateItemPositionWithScale(e,t){this.left=this.gridster.$options.dirType===A.RTL?this.gridster.el.scrollWidth-this.originalClientX+(e.clientX-this.originalClientX)/t+this.diffLeft:this.originalClientX+(e.clientX-this.originalClientX)/t+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(e.clientY-this.originalClientY)/t+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(e){this.left=this.gridster.$options.dirType===A.RTL?this.gridster.el.scrollWidth-e.clientX+this.diffLeft:e.clientX+this.offsetLeft-this.diffLeft,this.top=e.clientY+this.offsetTop-this.diffTop}calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){const e=this.path[this.path.length-1];let t="";e.x<this.gridsterItem.$item.x?t=this.push.fromWest:e.x>this.gridsterItem.$item.x?t=this.push.fromEast:e.y<this.gridsterItem.$item.y?t=this.push.fromNorth:e.y>this.gridsterItem.$item.y&&(t=this.push.fromSouth),this.push.pushItems(t,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&!0!==this.collision&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){const e=this.gridsterItem.canBeDragged();!this.enabled&&e?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!e&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}getDirections(e){const t=[];return 0===this.lastMouse.clientX&&0===this.lastMouse.clientY&&(this.lastMouse.clientY=e.clientY,this.lastMouse.clientX=e.clientX),this.lastMouse.clientY>e.clientY&&t.push(G.UP),this.lastMouse.clientY<e.clientY&&t.push(G.DOWN),this.lastMouse.clientX<e.clientX&&t.push(G.RIGHT),this.lastMouse.clientX>e.clientX&&t.push(G.LEFT),t}}class Yi{constructor(e){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=e,this.gridster=e.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(e){return!!this.gridster.$options.pushResizeItems&&this.push(this.gridsterItem,e)}restoreItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.$item.x=s.item.x||0,s.$item.y=s.item.y||0,s.$item.cols=s.item.cols||1,s.$item.row=s.item.row||1,s.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.checkItemChanges(s.$item,s.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let e=this.pushedItems.length-1,t=!1;for(;e>-1;e--)this.checkPushedItem(this.pushedItems[e],e)&&(t=!0);t&&this.checkPushBack()}push(e,t){const s=this.gridster.checkCollision(e.$item);if(s&&!0!==s&&s!==this.gridsterItem&&s.canBeResized()){if(this.tryPattern[t].call(this,s,e,t))return!0}else if(!1===s)return!0;return!1}trySouth(e,t,s){const r=e.$item.y,o=e.$item.rows;return e.$item.y=t.$item.y+t.$item.rows,e.$item.rows=o+r-e.$item.y,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.y=r,e.$item.rows=o,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}tryNorth(e,t,s){const r=e.$item.rows;return e.$item.rows=t.$item.y-e.$item.y,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.rows=r,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}tryEast(e,t,s){const r=e.$item.x,o=e.$item.cols;return e.$item.x=t.$item.x+t.$item.cols,e.$item.cols=o+r-e.$item.x,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.x=r,e.$item.cols=o,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}tryWest(e,t,s){const r=e.$item.cols;return e.$item.cols=t.$item.x-e.$item.x,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.cols=r,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}addToPushed(e){if(this.pushedItems.indexOf(e)<0)this.pushedItems.push(e),this.pushedItemsPath.push([{x:e.item.x||0,y:e.item.y||0,cols:e.item.cols||0,rows:e.item.rows||0},{x:e.$item.x,y:e.$item.y,cols:e.$item.cols,rows:e.$item.rows}]);else{const t=this.pushedItems.indexOf(e);this.pushedItemsPath[t].push({x:e.$item.x,y:e.$item.y,cols:e.$item.cols,rows:e.$item.rows})}}removeFromPushed(e){e>-1&&(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1))}checkPushedItem(e,t){const s=this.pushedItemsPath[t];let o,a,l,d,p,r=s.length-2;for(;r>-1;r--)o=s[r],a=e.$item.x,l=e.$item.y,d=e.$item.cols,p=e.$item.rows,e.$item.x=o.x,e.$item.y=o.y,e.$item.cols=o.cols,e.$item.rows=o.rows,this.gridster.findItemWithItem(e.$item)?(e.$item.x=a,e.$item.y=l,e.$item.cols=d,e.$item.rows=p):(e.setSize(),s.splice(r+1,s.length-1-r));return s.length<2&&(this.removeFromPushed(t),!0)}}class Zi{constructor(e,t,s){this.zone=s,this.directionFunction=null,this.dragMove=r=>{if(null===this.directionFunction)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");r.stopPropagation(),r.preventDefault(),M.checkTouchEvent(r),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,D(this.gridster,this.left,this.top,this.width,this.height,r,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);const o=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(r.clientX-this.originalClientX)/o,clientY:this.originalClientY+(r.clientY-this.originalClientY)/o}),this.lastMouse.clientX=r.clientX,this.lastMouse.clientY=r.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=r=>{r.stopPropagation(),r.preventDefault(),F(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,r)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})},this.cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.handleNorth=r=>{if(this.top=r.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight,this.top=this.bottom-this.minHeight),this.newPosition=this.gridster.pixelsToPositionY(this.top+this.margin,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)},this.handleWest=r=>{if(this.left=(this.gridster.$options.dirType===A.RTL?this.originalClientX+(this.originalClientX-r.clientX):r.clientX)+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width&&(this.width=this.minWidth,this.left=this.right-this.minWidth),this.newPosition=this.gridster.pixelsToPositionX(this.left+this.margin,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)},this.handleSouth=r=>{if(this.height=r.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.newPosition=this.gridster.pixelsToPositionY(this.bottom,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.rows=this.itemBackup[3],void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)},this.handleEast=r=>{if(this.width=(this.gridster.$options.dirType===A.RTL?this.originalClientX+(this.originalClientX-r.clientX):r.clientX)+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.newPosition=this.gridster.pixelsToPositionX(this.right,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.cols=this.itemBackup[2],void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)},this.handleNorthWest=r=>{this.handleNorth(r),this.handleWest(r)},this.handleNorthEast=r=>{this.handleNorth(r),this.handleEast(r)},this.handleSouthWest=r=>{this.handleSouth(r),this.handleWest(r)},this.handleSouthEast=r=>{this.handleSouth(r),this.handleEast(r)},this.gridsterItem=e,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(e){if(e.which&&1!==e.which)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=e.clientX,this.lastMouse.clientY=e.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=e.clientX+this.offsetLeft-this.left,this.diffRight=e.clientX+this.offsetLeft-this.right,this.diffTop=e.clientY+this.offsetTop-this.top,this.diffBottom=e.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new ae(this.gridsterItem),this.pushResize=new Yi(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();const{classList:t}=e.target;t.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):t.contains("handle-w")?this.gridster.$options.dirType===A.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):t.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):t.contains("handle-e")?this.gridster.$options.dirType===A.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):t.contains("handle-nw")?this.gridster.$options.dirType===A.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):t.contains("handle-ne")?this.gridster.$options.dirType===A.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):t.contains("handle-sw")?this.gridster.$options.dirType===A.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):t.contains("handle-se")&&(this.gridster.$options.dirType===A.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(e){if(M.checkTouchEvent(e),!this.gridster.$options.resizable.delayStart)return void this.dragStart(e);const t=setTimeout(()=>{this.dragStart(e),_()},this.gridster.$options.resizable.delayStart),{cancelMouse:s,cancelMouseLeave:r,cancelOnBlur:o,cancelTouchMove:a,cancelTouchEnd:l,cancelTouchCancel:d}=this.zone.runOutsideAngular(()=>({cancelMouse:this.gridsterItem.renderer.listen("document","mouseup",_),cancelMouseLeave:this.gridsterItem.renderer.listen("document","mouseleave",_),cancelOnBlur:this.gridsterItem.renderer.listen("window","blur",_),cancelTouchMove:this.gridsterItem.renderer.listen("document","touchmove",p),cancelTouchEnd:this.gridsterItem.renderer.listen("document","touchend",_),cancelTouchCancel:this.gridsterItem.renderer.listen("document","touchcancel",_)}));function p(y){M.checkTouchEvent(y),(Math.abs(y.clientX-e.clientX)>9||Math.abs(y.clientY-e.clientY)>9)&&_()}function _(){clearTimeout(t),o(),s(),r(),a(),l(),d()}}setItemTop(e){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,e)}setItemLeft(e){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,e,this.top)}setItemHeight(e){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",e+"px")}setItemWidth(e){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",e+"px")}}let Wi=(()=>{class n{constructor(t,s,r,o){this.renderer=r,this.zone=o,this.itemInit=new i.vpe,this.itemChange=new i.vpe,this.itemResize=new i.vpe,this.el=t.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=s,this.drag=new Gi(this,s,this.zone),this.resize=new Zi(this,s,this.zone)}get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(t){t.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),t.item&&t.item.previousValue&&this.setSize()}updateOptions(){this.$item=M.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){const s=this.$item.x*this.gridster.curColWidth,r=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,o=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=this.$item.y*this.gridster.curRowHeight,this.left=s,!this.init&&r>0&&o>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(r!==this.width||o!==this.height)&&(this.width=r,this.height=o,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(t,s){t.rows===s.rows&&t.cols===s.cols&&t.x===s.x&&t.y===s.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=s.x||0,this.$item.y=s.y||0,this.$item.cols=s.cols||1,this.$item.rows=s.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){const t=this.gridster.$options.draggable.enabled;return!this.gridster.mobile&&t&&(void 0===this.$item.dragEnabled?t:this.$item.dragEnabled)}canBeResized(){const t=this.gridster.$options.resizable.enabled;return!this.gridster.mobile&&t&&(void 0===this.$item.resizeEnabled?t:this.$item.resizeEnabled)}getResizableHandles(){const t=this.gridster.$options.resizable.handles,s=this.$item.resizableHandles;return void 0===s?t:{...t,...s}}bringToFront(t){if(t&&t<=0)return;const s=this.getLayerIndex(),r=this.gridster.$options.maxLayerIndex;if(s<r){const o=t?s+t:r;this.item.layerIndex=this.$item.layerIndex=o>r?r:o}}sendToBack(t){if(t&&t<=0)return;const s=this.getLayerIndex();if(s>0){const r=t?s-t:0;this.item.layerIndex=this.$item.layerIndex=r<0?0:r}}getLayerIndex(){return void 0!==this.item.layerIndex?this.item.layerIndex:void 0!==this.gridster.$options.defaultLayerIndex?this.gridster.$options.defaultLayerIndex:0}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.SBq),i.Y36(oe),i.Y36(i.Qsj),i.Y36(i.R0b))},n.\u0275cmp=i.Xpm({type:n,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(t,s){2&t&&i.Udp("z-index",s.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},features:[i.TTD],ngContentSelectors:se,decls:9,vars:8,consts:[["class","gridster-item-resizable-handler handle-s",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-e",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-n",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-w",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-se",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-ne",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-sw",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-nw",3,"mousedown","touchstart",4,"ngIf"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(t,s){1&t&&(i.F$t(),i.Hsn(0),i.YNc(1,ze,1,0,"div",0),i.YNc(2,Ne,1,0,"div",1),i.YNc(3,He,1,0,"div",2),i.YNc(4,Mt,1,0,"div",3),i.YNc(5,Be,1,0,"div",4),i.YNc(6,$t,1,0,"div",5),i.YNc(7,ne,1,0,"div",6),i.YNc(8,Ge,1,0,"div",7)),2&t&&(i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.s)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.e)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.n)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.w)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.se)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.ne)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.sw)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.nw)&&s.resize.resizeEnabled))},dependencies:[b.O5],styles:["gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:white;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}\n"],encapsulation:2}),n})(),Ui=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[b.ez]}),n})();var nt=C(655),Z=C(9933),wt=(()=>{return(n=wt||(wt={})).INSTRUMENT_TYPE="INSTRUMENT_TYPE",n.BROKER="BROKER",n.TRADING_CURRENCY="TRADING_CURRENCY",n.CUSTOM="CUSTOM",wt;var n})(),W=C(9549),Ft=C(4385),gt=C(3238),V=C(4859),ft=C(2054);function ji(n,e){if(1&n&&(i.TgZ(0,"mat-option",8),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t.value),i.xp6(1),i.hij(" ",t.value," ")}}function Xi(n,e){1&n&&(i.TgZ(0,"span"),i._uU(1," / "),i.qZA())}function qi(n,e){if(1&n){const t=i.EpF();i.ynx(0),i.TgZ(1,"button",11),i.NdJ("click",function(){const o=i.CHM(t).$implicit,a=i.oxw(2);return i.KtG(a.selectTopSegments(o))}),i._uU(2),i.qZA(),i.YNc(3,Xi,2,0,"span",12),i.BQk()}if(2&n){const t=e.$implicit,s=e.last;i.xp6(1),i.ekj("active",s),i.Q6J("disabled",s),i.xp6(1),i.hij(" ",t.name," "),i.xp6(1),i.Q6J("ngIf",!s)}}function Ji(n,e){if(1&n&&(i.TgZ(0,"div",9),i.YNc(1,qi,4,5,"ng-container",10),i.qZA()),2&n){const t=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.chartPath)}}let rt=class{constructor(e,t){this.cd=e,this.currencyPipe=t,this.cardChanges$=new i.vpe,this.chartPath=[],this.allocatedByOptions=Object.keys(wt).map(s=>({value:s})),this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,Z.t)(this)).subscribe(e=>{this.chartSegments=[...e.segments],this.chartOption=this.constructChartOption(this.chartSegments),this.chartPath=[{name:"All",values:[...this.chartSegments]}],this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){return{tooltip:{trigger:"item",formatter:t=>{const s=this.currencyPipe.transform(t.value,t.data.currencyCode);return`<b>${t.marker}${t.name} ${s} (${t.percent}%)</b>`}},legend:this.getChartLegend(),series:[{name:"",type:"pie",center:["50%","50%"],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:32,fontWeight:"bold"}},labelLine:{show:!1},data:e}]}}getChartLegend(){if(this.card.rows>3||this.card.cols>3)return{bottom:"5%",left:"center"}}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}onSegmentSelected(e){const t=this.chartSegments.find(s=>s.name===e.name);t.children&&(this.chartSegments=[...t.children],this.chartOption=this.constructChartOption(this.chartSegments),this.chartPath.push({name:e.name,values:[]}))}onAllocatedByOptionChanged(e){this.loading=!0,this.cd.detectChanges(),this.card={...this.card,allocatedBy:e},this.cardChanges$.emit(this.card)}selectTopSegments(e){const t=this.chartPath.indexOf(e);this.chartPath.splice(t+1),this.chartSegments=[...this.chartPath[t].values],this.chartOption=this.constructChartOption([...this.chartSegments])}};rt.\u0275fac=function(e){return new(e||rt)(i.Y36(i.sBO),i.Y36(b.H9))},rt.\u0275cmp=i.Xpm({type:rt,selectors:[["app-allocation-card"]],decls:10,vars:7,consts:[[1,"card-header"],[1,"title"],["appearance","legacy"],["matPrefix",""],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["class","breadcrumbs",4,"ngIf"],["echarts","",1,"pie-chart",3,"options","loading","chartInit","chartClick"],[3,"value"],[1,"breadcrumbs"],[4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],[4,"ngIf"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA(),i.TgZ(3,"mat-form-field",2)(4,"div",3),i._uU(5),i.qZA(),i.TgZ(6,"mat-select",4),i.NdJ("valueChange",function(r){return t.onAllocatedByOptionChanged(r)}),i.YNc(7,ji,2,2,"mat-option",5),i.qZA()()(),i.YNc(8,Ji,2,1,"div",6),i.TgZ(9,"div",7),i.NdJ("chartInit",function(r){return t.onChartInit(r)})("chartClick",function(r){return t.onSegmentSelected(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(3),i.Oqu("by:"),i.xp6(1),i.Q6J("value",t.card.allocatedBy),i.xp6(1),i.Q6J("ngForOf",t.allocatedByOptions),i.xp6(1),i.Q6J("ngIf",t.chartPath.length>1),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[b.sg,b.O5,W.KE,W.qo,Ft.gD,gt.ey,V.lW,ft._w],styles:[".card-header{display:flex;align-items:center}.card-header .title{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.pie-chart .ngx-charts-outer{margin:0 auto}.breadcrumbs{max-height:24px;position:absolute;z-index:10}\n"],encapsulation:2,changeDetection:0}),rt=(0,nt.gn)([(0,Z.c)()],rt);var O=(()=>{return(n=O||(O={})).ALLOCATION="ALLOCATION",n.DIVIDEND_INCOME="DIVIDEND_INCOME",n.DIVIDEND_GOALS="DIVIDEND_GOALS",n.SECTORAL_DISTRIBUTION="SECTORAL_DISTRIBUTION",n.BALANCE="BALANCE",n.CONTRIBUTION="CONTRIBUTION",n.INVESTMENT_YIELD="INVESTMENT_YIELD",n.EQUITY_RISK_PREMIUM="EQUITY_RISK_PREMIUM",O;var n})(),Dt=(()=>{return(n=Dt||(Dt={})).MONTH="MONTH",n.QUARTER="QUARTER",n.YEAR="YEAR",Dt;var n})(),le=C(4569);function Vi(n,e){if(1&n&&(i.TgZ(0,"mat-option",7),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t.value),i.xp6(1),i.hij(" ",t.value," ")}}let ot=class{constructor(e,t){this.cd=e,this.currencyPipe=t,this.cardChanges$=new i.vpe,this.timeFrameOptions=Object.keys(Dt).map(s=>({value:s})),this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,Z.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){const t=e.dividends;return{tooltip:{trigger:"item",position:"inside",formatter:r=>{const o=t.find(y=>y.name===r.name);if(!o)return`<div class="tooltip-dividend"><div class="tooltip-dividend-title">${r.seriesName}: ${r.value}</div></div>`;const a=o.series[r.seriesIndex].details,l=Array.from(a.reduce((y,v)=>(v.name&&y.set(v.name,(y.get(v.name)||0)+v.total),y),new Map),([y,v])=>({name:y,total:v})),d=a.reduce((y,v)=>(v.name&&y.set(v.name,v.currency),y),new Map),p=l.map(y=>`<span class="dividend-detail">${y.name}: ${this.currencyPipe.transform(y.total,d.get(y.name))}</span>`).join("");return`<div class="tooltip-dividend"><div class="tooltip-dividend-title">${r.seriesName}: ${this.currencyPipe.transform(r.value,o.series[r.seriesIndex].currencyCode)}</div><div class="tooltip-dividend-details">${p}</div></div>`}},xAxis:{type:"category",data:t.map(r=>r.name)},yAxis:{type:"value",axisLabel:{formatter:function(r){return(0,le.M)(r)}}},series:this.composeBarSeries(t)}}composeBarSeries(e){const t=[];return e.forEach((s,r)=>{s.series.forEach(0===r?o=>t.push({name:o.name,stack:o.stack,data:[o.value],type:"bar",showBackground:!0,details:[o.details]}):(o,a)=>{t[a].data.push(o.value),t[a].details.push(o.details)})}),t}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}onTimeFrameOptionChanged(e){this.loading=!0,this.cd.detectChanges(),this.cardChanges$.emit({...this.card,timeFrame:e})}};ot.\u0275fac=function(e){return new(e||ot)(i.Y36(i.sBO),i.Y36(b.H9))},ot.\u0275cmp=i.Xpm({type:ot,selectors:[["app-dividends-card"]],decls:9,vars:6,consts:[[1,"card-header"],[1,"title"],["appearance","legacy"],["matPrefix",""],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["echarts","",1,"dividend-income-chart",3,"options","loading","chartInit"],[3,"value"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA(),i.TgZ(3,"mat-form-field",2)(4,"div",3),i._uU(5),i.qZA(),i.TgZ(6,"mat-select",4),i.NdJ("valueChange",function(r){return t.onTimeFrameOptionChanged(r)}),i.YNc(7,Vi,2,2,"mat-option",5),i.qZA()()(),i.TgZ(8,"div",6),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(3),i.Oqu("By:"),i.xp6(1),i.Q6J("value",t.card.timeFrame),i.xp6(1),i.Q6J("ngForOf",t.timeFrameOptions),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[b.sg,W.KE,W.qo,Ft.gD,gt.ey,ft._w],styles:[".card-header{display:flex;align-items:center}.card-header .title{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.tooltip-dividend{max-width:400px;min-width:150px}.tooltip-dividend-title{text-align:center}.tooltip-dividend-details{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:center}.tooltip-dividend-details .dividend-detail{flex:1 1 30%;display:flex;justify-content:space-evenly;padding:2px}\n"],encapsulation:2,changeDetection:0}),ot=(0,nt.gn)([(0,Z.c)()],ot);var Qi=C(5684),Ki=C(4482),Xe=C(5403),ts=C(8421),es=C(4671),is=C(5032),ss=C(3269),rs=C(9770),os=C(8505),T=C(4006),qe=C(1135);class ds{constructor(){this.cards=[]}}var Lt=C(4004);const de={x:0,y:0,cols:3,rows:2,minItemCols:3,minItemRows:2};class it{constructor(e){this.originCard={id:"_"+Math.random().toString(36).substr(2,9),containerType:e,...de}}}function Je(n){const e=ys[n];if(!e)throw new Error(`Cannot find card factory for ${n}`);return new e(n).create()}const ys={[O.ALLOCATION]:class cs extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Allocation",cols:4,rows:3,allocatedBy:wt.INSTRUMENT_TYPE}}},[O.DIVIDEND_INCOME]:class us extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Dividend Income",cols:3,rows:4,timeFrame:Dt.YEAR}}},[O.DIVIDEND_GOALS]:class ps extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Dividend Goals",cols:4,rows:3,desiredYieldByIssuer:{}}}},[O.SECTORAL_DISTRIBUTION]:class ms extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Sectoral Distribution",cols:4,rows:3}}},[O.BALANCE]:class gs extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Balance",cols:3,rows:2,minItemCols:3,minItemRows:2}}},[O.CONTRIBUTION]:class fs extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Contributions",cols:3,rows:2,minItemCols:3,minItemRows:2}}},[O.INVESTMENT_YIELD]:class _s extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Investment Yield",cols:2,rows:1,minItemCols:2,minItemRows:1}}},[O.EQUITY_RISK_PREMIUM]:class Cs extends it{constructor(e){super(e)}create(){return{...this.originCard,title:"Risk Premium",cols:4,rows:3}}}};var Ve=C(529),he=C(4487);let Qe=(()=>{class n{constructor(t,s){this.http=t,this.rxStompService=s}addCard(t,s){this.manageCard(t,s,"add")}updateCards(t,s){this.manageCard(t,s,"update")}deleteCard(t,s){this.manageCard(t,s,"delete")}manageCard(t,s,r){this.rxStompService.publish({destination:`/app/${t}/cards/${r}`,body:JSON.stringify(s)})}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(Ve.eN),i.LFG(he.g4))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),At=(()=>{class n extends class ls{constructor(e){this._state$=new qe.X(e),this.state$=this._state$.asObservable()}get state(){return this._state$.getValue()}setState(e){this._state$.next(e)}}{constructor(t){super(new ds),this.cardService=t,this.cardsByItems$=this.state$.pipe((0,Lt.U)(s=>({cards:s.cards,items:s.cards.map(r=>({...r}))})))}init(t,s){const r=s.map(o=>({...Je(o.containerType),...o}));this.setState({...this.state,dashboardId:t,cards:r})}addCard(t){const{dashboardId:s}=this.state;this.cardService.addCard(s,t),this.setState({...this.state,cards:[...this.state.cards,t]})}updateCard(t){const{dashboardId:s}=this.state,r=this.state.cards.map(o=>o.id===t.id?t:o);this.cardService.updateCards(s,r),this.setState({...this.state,cards:r})}deleteCard(t){const{dashboardId:s}=this.state;this.cardService.deleteCard(s,t),this.setState({...this.state,cards:[...this.state.cards.filter(r=>r.id!==t.id)]})}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(Qe))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})();var ce=C(4633),zt=C(4144);function vs(n,e){if(1&n&&(i.TgZ(0,"button",11),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.xp6(1),i.Oqu(t)}}function ws(n,e){if(1&n&&(i.TgZ(0,"mat-list-item")(1,"span"),i._uU(2),i.qZA(),i.TgZ(3,"mat-form-field",6)(4,"mat-label"),i._uU(5,"Yield"),i.qZA(),i.TgZ(6,"span",7),i._uU(7),i.qZA(),i._UZ(8,"input",8),i.TgZ(9,"span",9),i._uU(10,"%"),i.qZA()(),i.YNc(11,vs,2,1,"button",10),i.qZA()),2&n){const t=e.$implicit,s=e.index;i.xp6(2),i.Oqu(t.name),i.xp6(5),i.hij("",t.currentYield+"% /","\xa0"),i.xp6(1),i.Q6J("formControlName",s),i.xp6(3),i.Q6J("ngForOf",t.targets)}}function Ds(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"form",3)(2,"mat-list",4),i.YNc(3,ws,12,4,"mat-list-item",5),i.qZA()(),i.BQk()),2&n){const t=e.ngIf,s=i.oxw();i.xp6(1),i.Q6J("formGroup",s.form),i.xp6(1),i.Q6J("formArrayName","desiredYields"),i.xp6(1),i.Q6J("ngForOf",t.items)}}let at=class{constructor(e,t,s){this.fb=e,this.store=t,this.cd=s,this.form=e.group({desiredYields:e.array([])})}get desiredYields(){return this.form.get("desiredYields")}ngOnInit(){this.setupFormBeforeData$=this.data$.pipe(function as(n){return e=>(0,rs.P)(()=>{let t=!0;return e.pipe((0,os.b)(s=>{t&&n(s),t=!1}))})}(e=>{e.items.forEach(t=>this.desiredYields.push(this.fb.control(this.card.desiredYieldByIssuer?.[t.name]??t.currentYield)))}))}ngAfterViewInit(){this.desiredYields.valueChanges.pipe((0,Z.t)(this),(0,ee.b)(300),(0,Qi.T)(1),function ns(...n){const e=(0,ss.jO)(n);return(0,Ki.e)((t,s)=>{const r=n.length,o=new Array(r);let a=n.map(()=>!1),l=!1;for(let d=0;d<r;d++)(0,ts.Xf)(n[d]).subscribe(new Xe.Q(s,p=>{o[d]=p,!l&&!a[d]&&(a[d]=!0,(l=a.every(es.y))&&(a=null))},is.Z));t.subscribe(new Xe.Q(s,d=>{if(l){const p=[d,...o];s.next(e?e(...p):p)}}))})}(this.data$)).subscribe(([e,t])=>{const s=t.items.reduce((r,o,a)=>(r[o.name]=e[a],r),{});this.store.updateCard({...this.card,desiredYieldByIssuer:s})})}};at.\u0275fac=function(e){return new(e||at)(i.Y36(T.QS),i.Y36(At),i.Y36(i.sBO))},at.\u0275cmp=i.Xpm({type:at,selectors:[["app-dividend-goals-card"]],decls:5,vars:4,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],[3,"formGroup"],[3,"formArrayName"],[4,"ngFor","ngForOf"],[1,"example-full-width"],["matPrefix",""],["matInput","","placeholder","100","autocomplete","false",3,"formControlName"],["matSuffix",""],["mat-button","",4,"ngFor","ngForOf"],["mat-button",""]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,Ds,4,3,"ng-container",2),i.ALo(4,"async")),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,2,t.setupFormBeforeData$)))},dependencies:[b.sg,b.O5,W.KE,W.hX,W.qo,W.R9,T._Y,T.Fj,T.JJ,T.JL,V.lW,ce.i$,ce.Tg,zt.Nt,T.sg,T.u,T.CE,b.Ov],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),at=(0,nt.gn)([(0,Z.c)()],at);let lt=class{constructor(e){this.cd=e,this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,Z.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){return{tooltip:{trigger:"item"},series:[{type:"treemap",visibleMin:300,label:{show:!0,formatter:"{b}"},upperLabel:{show:!0,height:25,color:"white"},levels:this.getLevelOption(),data:e.items}]}}getLevelOption(){return[{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},upperLabel:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},emphasis:{itemStyle:{borderColor:"#ddd"}}},{colorSaturation:[.35,.5],itemStyle:{borderWidth:2,gapWidth:1,borderColorSaturation:.6}}]}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}};function bs(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"div",4),i._uU(2),i.ALo(3,"currency"),i.qZA(),i.TgZ(4,"div",5)(5,"span"),i._uU(6),i.ALo(7,"currency"),i.qZA(),i.TgZ(8,"span"),i._uU(9),i.qZA()(),i.BQk()),2&n){const t=e.ngIf;i.xp6(2),i.Oqu(i.xi3(3,3,t.currentAmount,t.currencyCode)),i.xp6(4),i.Oqu(i.xi3(7,6,t.investedAmount,t.currencyCode)),i.xp6(3),i.Oqu("invested")}}lt.\u0275fac=function(e){return new(e||lt)(i.Y36(i.sBO))},lt.\u0275cmp=i.Xpm({type:lt,selectors:[["app-sectoral-distribution-card"]],decls:4,vars:3,consts:[[1,"card-header"],[1,"title"],["echarts","",1,"distribution-chart",3,"options","loading","chartInit"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.TgZ(3,"div",2),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[ft._w],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),lt=(0,nt.gn)([(0,Z.c)()],lt);let dt=class{constructor(e){this.cd=e,this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,Z.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){const{dates:t,values:s}=e.investedAmountByDates;return{tooltip:{trigger:"item"},xAxis:{type:"category",boundaryGap:!1,data:t,show:this.card.cols>3},yAxis:{type:"value",show:this.card.cols>=6&&this.card.rows>=3,axisLabel:{formatter:function(r){return(0,le.M)(r)}}},series:[{data:s,type:"line",areaStyle:{},triggerLineEvent:!0}]}}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}};function xs(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"div",4)(2,"span"),i._uU(3),i.ALo(4,"currency"),i.qZA(),i.TgZ(5,"span"),i._uU(6),i.qZA()(),i.BQk()),2&n){const t=e.ngIf;i.xp6(3),i.Oqu(i.xi3(4,2,t.totalContributed,t.currencyCode)),i.xp6(3),i.Oqu("contributed this year")}}dt.\u0275fac=function(e){return new(e||dt)(i.Y36(i.sBO))},dt.\u0275cmp=i.Xpm({type:dt,selectors:[["app-balance-card"]],decls:6,vars:6,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],["echarts","",1,"balance-chart",3,"options","loading","chartInit"],[1,"current-amount"],[1,"invested-amount"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,bs,10,9,"ng-container",2),i.ALo(4,"async"),i.TgZ(5,"div",3),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,4,t.data$)),i.xp6(2),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[b.O5,ft._w,b.Ov,b.H9],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.invested-amount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:5px}"],changeDetection:0}),dt=(0,nt.gn)([(0,Z.c)()],dt);let ht=class{constructor(e){this.cd=e,this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,Z.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){const t=e.contributions.map(s=>({name:s.name,stack:"one",data:s.data,type:"bar"}));return{tooltip:{trigger:"item"},xAxis:{name:"Months of contributions",nameLocation:"middle",nameTextStyle:{fontSize:16,padding:12},data:e.xaxis,axisLine:{onZero:!0},splitLine:{show:!0},splitArea:{show:!0}},yAxis:{axisLabel:{formatter:function(s){return(0,le.M)(s)}}},series:t}}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}};function Rs(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"div",3)(2,"span"),i._uU(3,"TTM yield on cost: "),i.qZA(),i._uU(4),i.qZA(),i.TgZ(5,"div",3)(6,"span"),i._uU(7,"TTM dividend yield: "),i.qZA(),i._uU(8),i.qZA(),i.BQk()),2&n){const t=e.ngIf;i.xp6(4),i.Oqu(t.yieldOnCost+"%"),i.xp6(4),i.Oqu(t.dividendYield+"%")}}ht.\u0275fac=function(e){return new(e||ht)(i.Y36(i.sBO))},ht.\u0275cmp=i.Xpm({type:ht,selectors:[["app-contribution-card"]],decls:6,vars:6,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],["echarts","",1,"contribution-chart",3,"options","loading","chartInit"],[1,"contributed-amount"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,xs,7,5,"ng-container",2),i.ALo(4,"async"),i.TgZ(5,"div",3),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,4,t.data$)),i.xp6(2),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[b.O5,ft._w,b.Ov,b.H9],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.contributed-amount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:5px}"],changeDetection:0}),ht=(0,nt.gn)([(0,Z.c)()],ht);let Ss=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-investment-yield-card"]],decls:5,vars:4,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],[1,"yield"]],template:function(t,s){1&t&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,Rs,9,2,"ng-container",2),i.ALo(4,"async")),2&t&&(i.xp6(2),i.Oqu(s.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,2,s.data$)))},dependencies:[b.O5,b.Ov],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),n})();var Ke=C(4782),Is=C(445),B=C(1281),j=C(5017),Q=C(3353),Nt=C(4098),Ts=C(2076),ti=C(9751),ei=C(576),ii=C(9646),si=C(5698);const Ps=[[["caption"]],[["colgroup"],["col"]]],Es=["caption","colgroup, col"];function ue(n){return class extends n{constructor(...e){super(...e),this._sticky=!1,this._hasStickyChanged=!1}get sticky(){return this._sticky}set sticky(e){const t=this._sticky;this._sticky=(0,B.Ig)(e),this._hasStickyChanged=t!==this._sticky}hasStickyChanged(){const e=this._hasStickyChanged;return this._hasStickyChanged=!1,e}resetStickyChanged(){this._hasStickyChanged=!1}}}const _t=new i.OlP("CDK_TABLE");let Ct=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkCellDef",""]]}),n})(),yt=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkHeaderCellDef",""]]}),n})(),Ht=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkFooterCellDef",""]]}),n})();class Fs{}const Ls=ue(Fs);let K=(()=>{class n extends Ls{constructor(t){super(),this._table=t,this._stickyEnd=!1}get name(){return this._name}set name(t){this._setNameInput(t)}get stickyEnd(){return this._stickyEnd}set stickyEnd(t){const s=this._stickyEnd;this._stickyEnd=(0,B.Ig)(t),this._hasStickyChanged=s!==this._stickyEnd}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(_t,8))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(t,s,r){if(1&t&&(i.Suo(r,Ct,5),i.Suo(r,yt,5),i.Suo(r,Ht,5)),2&t){let o;i.iGM(o=i.CRH())&&(s.cell=o.first),i.iGM(o=i.CRH())&&(s.headerCell=o.first),i.iGM(o=i.CRH())&&(s.footerCell=o.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[i._Bn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),i.qOj]}),n})();class pe{constructor(e,t){t.nativeElement.classList.add(...e._columnCssClassName)}}let me=(()=>{class n extends pe{constructor(t,s){super(t,s)}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(K),i.Y36(i.SBq))},n.\u0275dir=i.lG2({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[i.qOj]}),n})(),ge=(()=>{class n extends pe{constructor(t,s){if(super(t,s),1===t._table?._elementRef.nativeElement.nodeType){const r=t._table._elementRef.nativeElement.getAttribute("role");s.nativeElement.setAttribute("role","grid"===r||"treegrid"===r?"gridcell":"cell")}}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(K),i.Y36(i.SBq))},n.\u0275dir=i.lG2({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[i.qOj]}),n})();class ri{constructor(){this.tasks=[],this.endTasks=[]}}const fe=new i.OlP("_COALESCED_STYLE_SCHEDULER");let oi=(()=>{class n{constructor(t){this._ngZone=t,this._currentSchedule=null,this._destroyed=new k.x}schedule(t){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(t)}scheduleEnd(t){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(t)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new ri,this._getScheduleObservable().pipe((0,q.R)(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const t=this._currentSchedule;this._currentSchedule=new ri;for(const s of t.tasks)s();for(const s of t.endTasks)s()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?(0,Ts.D)(Promise.resolve(void 0)):this._ngZone.onStable.pipe((0,si.q)(1))}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(i.R0b))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),_e=(()=>{class n{constructor(t,s){this.template=t,this._differs=s}ngOnChanges(t){if(!this._columnsDiffer){const s=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(s).create(),this._columnsDiffer.diff(s)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof bt?t.headerCell.template:this instanceof xt?t.footerCell.template:t.cell.template}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc),i.Y36(i.ZZ4))},n.\u0275dir=i.lG2({type:n,features:[i.TTD]}),n})();class As extends _e{}const zs=ue(As);let bt=(()=>{class n extends zs{constructor(t,s,r){super(t,s),this._table=r}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc),i.Y36(i.ZZ4),i.Y36(_t,8))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[i.qOj,i.TTD]}),n})();class Ns extends _e{}const Hs=ue(Ns);let xt=(()=>{class n extends Hs{constructor(t,s,r){super(t,s),this._table=r}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc),i.Y36(i.ZZ4),i.Y36(_t,8))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[i.qOj,i.TTD]}),n})(),Bt=(()=>{class n extends _e{constructor(t,s,r){super(t,s),this._table=r}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc),i.Y36(i.ZZ4),i.Y36(_t,8))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[i.qOj]}),n})(),tt=(()=>{class n{constructor(t){this._viewContainer=t,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}}return n.mostRecentCellOutlet=null,n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b))},n.\u0275dir=i.lG2({type:n,selectors:[["","cdkCellOutlet",""]]}),n})(),Ce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,s){1&t&&i.GkF(0,0)},dependencies:[tt],encapsulation:2}),n})(),ve=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,s){1&t&&i.GkF(0,0)},dependencies:[tt],encapsulation:2}),n})(),Gt=(()=>{class n{constructor(t){this.templateRef=t,this._contentClassName="cdk-no-data-row"}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.Rgc))},n.\u0275dir=i.lG2({type:n,selectors:[["ng-template","cdkNoDataRow",""]]}),n})();const ai=["top","bottom","left","right"];class Bs{constructor(e,t,s,r,o=!0,a=!0,l){this._isNativeHtmlTable=e,this._stickCellCss=t,this.direction=s,this._coalescedStyleScheduler=r,this._isBrowser=o,this._needsPositionStickyOnElement=a,this._positionListener=l,this._cachedCellWidths=[],this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(e,t){const s=[];for(const r of e)if(r.nodeType===r.ELEMENT_NODE){s.push(r);for(let o=0;o<r.children.length;o++)s.push(r.children[o])}this._coalescedStyleScheduler.schedule(()=>{for(const r of s)this._removeStickyStyle(r,t)})}updateStickyColumns(e,t,s,r=!0){if(!e.length||!this._isBrowser||!t.some(v=>v)&&!s.some(v=>v))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const o=e[0],a=o.children.length,l=this._getCellWidths(o,r),d=this._getStickyStartColumnPositions(l,t),p=this._getStickyEndColumnPositions(l,s),_=t.lastIndexOf(!0),y=s.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const v="rtl"===this.direction,P=v?"right":"left",$=v?"left":"right";for(const H of e)for(let I=0;I<a;I++){const st=H.children[I];t[I]&&this._addStickyStyle(st,P,d[I],I===_),s[I]&&this._addStickyStyle(st,$,p[I],I===y)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===_?[]:l.slice(0,_+1).map((H,I)=>t[I]?H:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===y?[]:l.slice(y).map((H,I)=>s[I+y]?H:null).reverse()}))})}stickRows(e,t,s){if(!this._isBrowser)return;const r="bottom"===s?e.slice().reverse():e,o="bottom"===s?t.slice().reverse():t,a=[],l=[],d=[];for(let _=0,y=0;_<r.length;_++){if(!o[_])continue;a[_]=y;const v=r[_];d[_]=this._isNativeHtmlTable?Array.from(v.children):[v];const P=v.getBoundingClientRect().height;y+=P,l[_]=P}const p=o.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let _=0;_<r.length;_++){if(!o[_])continue;const y=a[_],v=_===p;for(const P of d[_])this._addStickyStyle(P,s,y,v)}"top"===s?this._positionListener?.stickyHeaderRowsUpdated({sizes:l,offsets:a,elements:d}):this._positionListener?.stickyFooterRowsUpdated({sizes:l,offsets:a,elements:d})})}updateStickyFooterContainer(e,t){if(!this._isNativeHtmlTable)return;const s=e.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{t.some(r=>!r)?this._removeStickyStyle(s,["bottom"]):this._addStickyStyle(s,"bottom",0,!1)})}_removeStickyStyle(e,t){for(const r of t)e.style[r]="",e.classList.remove(this._borderCellCss[r]);ai.some(r=>-1===t.indexOf(r)&&e.style[r])?e.style.zIndex=this._getCalculatedZIndex(e):(e.style.zIndex="",this._needsPositionStickyOnElement&&(e.style.position=""),e.classList.remove(this._stickCellCss))}_addStickyStyle(e,t,s,r){e.classList.add(this._stickCellCss),r&&e.classList.add(this._borderCellCss[t]),e.style[t]=`${s}px`,e.style.zIndex=this._getCalculatedZIndex(e),this._needsPositionStickyOnElement&&(e.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(e){const t={top:100,bottom:10,left:1,right:1};let s=0;for(const r of ai)e.style[r]&&(s+=t[r]);return s?`${s}`:""}_getCellWidths(e,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;const s=[],r=e.children;for(let o=0;o<r.length;o++)s.push(r[o].getBoundingClientRect().width);return this._cachedCellWidths=s,s}_getStickyStartColumnPositions(e,t){const s=[];let r=0;for(let o=0;o<e.length;o++)t[o]&&(s[o]=r,r+=e[o]);return s}_getStickyEndColumnPositions(e,t){const s=[];let r=0;for(let o=e.length;o>0;o--)t[o]&&(s[o]=r,r+=e[o]);return s}}const we=new i.OlP("CDK_SPL");let Yt=(()=>{class n{constructor(t,s){this.viewContainer=t,this.elementRef=s}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b),i.Y36(i.SBq))},n.\u0275dir=i.lG2({type:n,selectors:[["","rowOutlet",""]]}),n})(),Zt=(()=>{class n{constructor(t,s){this.viewContainer=t,this.elementRef=s}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b),i.Y36(i.SBq))},n.\u0275dir=i.lG2({type:n,selectors:[["","headerRowOutlet",""]]}),n})(),Wt=(()=>{class n{constructor(t,s){this.viewContainer=t,this.elementRef=s}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b),i.Y36(i.SBq))},n.\u0275dir=i.lG2({type:n,selectors:[["","footerRowOutlet",""]]}),n})(),Ut=(()=>{class n{constructor(t,s){this.viewContainer=t,this.elementRef=s}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b),i.Y36(i.SBq))},n.\u0275dir=i.lG2({type:n,selectors:[["","noDataRowOutlet",""]]}),n})(),jt=(()=>{class n{constructor(t,s,r,o,a,l,d,p,_,y,v,P){this._differs=t,this._changeDetectorRef=s,this._elementRef=r,this._dir=a,this._platform=d,this._viewRepeater=p,this._coalescedStyleScheduler=_,this._viewportRuler=y,this._stickyPositioningListener=v,this._ngZone=P,this._onDestroy=new k.x,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new i.vpe,this.viewChange=new qe.X({start:0,end:Number.MAX_VALUE}),o||this._elementRef.nativeElement.setAttribute("role","table"),this._document=l,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}get trackBy(){return this._trackByFn}set trackBy(t){this._trackByFn=t}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=(0,B.Ig)(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(t){this._fixedLayout=(0,B.Ig)(t),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((t,s)=>this.trackBy?this.trackBy(s.dataIndex,s.data):s),this._viewportRuler.change().pipe((0,q.R)(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const s=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||s,this._forceRecalculateCellWidths=s,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(t=>{t.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),(0,j.Z9)(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return this._updateNoDataRow(),void this.contentChanged.next();const s=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(t,s,(r,o,a)=>this._getEmbeddedViewArgs(r.item,a),r=>r.item.data,r=>{1===r.operation&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),t.forEachIdentityChange(r=>{s.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),this._ngZone&&i.R0b.isInAngularZone()?this._ngZone.onStable.pipe((0,si.q)(1),(0,q.R)(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}setNoDataRow(t){this._customNoDataRow=t}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet),r=this._elementRef.nativeElement.querySelector("thead");r&&(r.style.display=t.length?"":"none");const o=this._headerRowDefs.map(a=>a.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,o,"top"),this._headerRowDefs.forEach(a=>a.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet),r=this._elementRef.nativeElement.querySelector("tfoot");r&&(r.style.display=t.length?"":"none");const o=this._footerRowDefs.map(a=>a.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,o,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,o),this._footerRowDefs.forEach(a=>a.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),s=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...t,...s,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),t.forEach((o,a)=>{this._addStickyColumnStyles([o],this._headerRowDefs[a])}),this._rowDefs.forEach(o=>{const a=[];for(let l=0;l<s.length;l++)this._renderRows[l].rowDef===o&&a.push(s[l]);this._addStickyColumnStyles(a,o)}),r.forEach((o,a)=>{this._addStickyColumnStyles([o],this._footerRowDefs[a])}),Array.from(this._columnDefsByName.values()).forEach(o=>o.resetStickyChanged())}_getAllRenderRows(){const t=[],s=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let o=this._data[r];const a=this._getRenderRowsForData(o,r,s.get(o));this._cachedRenderRowsMap.has(o)||this._cachedRenderRowsMap.set(o,new WeakMap);for(let l=0;l<a.length;l++){let d=a[l];const p=this._cachedRenderRowsMap.get(d.data);p.has(d.rowDef)?p.get(d.rowDef).push(d):p.set(d.rowDef,[d]),t.push(d)}}return t}_getRenderRowsForData(t,s,r){return this._getRowDefs(t,s).map(a=>{const l=r&&r.has(a)?r.get(a):[];if(l.length){const d=l.shift();return d.dataIndex=s,d}return{data:t,rowDef:a,dataIndex:s}})}_cacheColumnDefs(){this._columnDefsByName.clear(),Xt(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(s=>{this._columnDefsByName.has(s.name),this._columnDefsByName.set(s.name,s)})}_cacheRowDefs(){this._headerRowDefs=Xt(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=Xt(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=Xt(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(s=>!s.when);this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(a,l)=>a||!!l.getColumnsDiff(),s=this._rowDefs.reduce(t,!1);s&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(t,!1);r&&this._forceRenderHeaderRows();const o=this._footerRowDefs.reduce(t,!1);return o&&this._forceRenderFooterRows(),s||r||o}_switchDataSource(t){this._data=[],(0,j.Z9)(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;(0,j.Z9)(this.dataSource)?t=this.dataSource.connect(this):function ks(n){return!!n&&(n instanceof ti.y||(0,ei.m)(n.lift)&&(0,ei.m)(n.subscribe))}(this.dataSource)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=(0,ii.of)(this.dataSource)),this._renderChangeSubscription=t.pipe((0,q.R)(this._onDestroy)).subscribe(s=>{this._data=s||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,s)=>this._renderRow(this._headerRowOutlet,t,s)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,s)=>this._renderRow(this._footerRowOutlet,t,s)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(t,s){const r=Array.from(s.columns||[]).map(l=>this._columnDefsByName.get(l)),o=r.map(l=>l.sticky),a=r.map(l=>l.stickyEnd);this._stickyStyler.updateStickyColumns(t,o,a,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(t){const s=[];for(let r=0;r<t.viewContainer.length;r++){const o=t.viewContainer.get(r);s.push(o.rootNodes[0])}return s}_getRowDefs(t,s){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(o=>!o.when||o.when(s,t));else{let o=this._rowDefs.find(a=>a.when&&a.when(s,t))||this._defaultRowDef;o&&r.push(o)}return r}_getEmbeddedViewArgs(t,s){return{templateRef:t.rowDef.template,context:{$implicit:t.data},index:s}}_renderRow(t,s,r,o={}){const a=t.viewContainer.createEmbeddedView(s.template,o,r);return this._renderCellTemplateForItem(s,o),a}_renderCellTemplateForItem(t,s){for(let r of this._getCellTemplates(t))tt.mostRecentCellOutlet&&tt.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,s);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let s=0,r=t.length;s<r;s++){const a=t.get(s).context;a.count=r,a.first=0===s,a.last=s===r-1,a.even=s%2==0,a.odd=!a.even,this.multiTemplateDataRows?(a.dataIndex=this._renderRows[s].dataIndex,a.renderIndex=s):a.index=this._renderRows[s].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,s=>{const r=this._columnDefsByName.get(s);return t.extractCellTemplate(r)}):[]}_applyNativeTableSections(){const t=this._document.createDocumentFragment(),s=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const r of s){const o=this._document.createElement(r.tag);o.setAttribute("role","rowgroup");for(const a of r.outlets)o.appendChild(a.elementRef.nativeElement);t.appendChild(o)}this._elementRef.nativeElement.appendChild(t)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const t=(s,r)=>s||r.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new Bs(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:(0,ii.of)()).pipe((0,q.R)(this._onDestroy)).subscribe(s=>{this._stickyStyler.direction=s,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(s=>!s._table||s._table===this)}_updateNoDataRow(){const t=this._customNoDataRow||this._noDataRow;if(!t)return;const s=0===this._rowOutlet.viewContainer.length;if(s===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(s){const o=r.createEmbeddedView(t.templateRef),a=o.rootNodes[0];1===o.rootNodes.length&&a?.nodeType===this._document.ELEMENT_NODE&&(a.setAttribute("role","row"),a.classList.add(t._contentClassName))}else r.clear();this._isShowingNoDataRow=s}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.ZZ4),i.Y36(i.sBO),i.Y36(i.SBq),i.$8M("role"),i.Y36(Is.Is,8),i.Y36(b.K0),i.Y36(Q.t4),i.Y36(j.k),i.Y36(fe),i.Y36(Nt.rL),i.Y36(we,12),i.Y36(i.R0b,8))},n.\u0275cmp=i.Xpm({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(t,s,r){if(1&t&&(i.Suo(r,Gt,5),i.Suo(r,K,5),i.Suo(r,Bt,5),i.Suo(r,bt,5),i.Suo(r,xt,5)),2&t){let o;i.iGM(o=i.CRH())&&(s._noDataRow=o.first),i.iGM(o=i.CRH())&&(s._contentColumnDefs=o),i.iGM(o=i.CRH())&&(s._contentRowDefs=o),i.iGM(o=i.CRH())&&(s._contentHeaderRowDefs=o),i.iGM(o=i.CRH())&&(s._contentFooterRowDefs=o)}},viewQuery:function(t,s){if(1&t&&(i.Gf(Yt,7),i.Gf(Zt,7),i.Gf(Wt,7),i.Gf(Ut,7)),2&t){let r;i.iGM(r=i.CRH())&&(s._rowOutlet=r.first),i.iGM(r=i.CRH())&&(s._headerRowOutlet=r.first),i.iGM(r=i.CRH())&&(s._footerRowOutlet=r.first),i.iGM(r=i.CRH())&&(s._noDataRowOutlet=r.first)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(t,s){2&t&&i.ekj("cdk-table-fixed-layout",s.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[i._Bn([{provide:_t,useExisting:n},{provide:j.k,useClass:j.yy},{provide:fe,useClass:oi},{provide:we,useValue:null}])],ngContentSelectors:Es,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,s){1&t&&(i.F$t(Ps),i.Hsn(0),i.Hsn(1,1),i.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[Yt,Zt,Wt,Ut],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})();function Xt(n,e){return n.concat(Array.from(e))}let Ys=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[Nt.Cl]}),n})();const Zs=[[["caption"]],[["colgroup"],["col"]]],Ws=["caption","colgroup, col"];let di=(()=>{class n extends jt{constructor(){super(...arguments),this.stickyCssClass="mat-table-sticky",this.needsPositionStickyOnElement=!1}}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275cmp=i.Xpm({type:n,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-table"],hostVars:2,hostBindings:function(t,s){2&t&&i.ekj("mat-table-fixed-layout",s.fixedLayout)},exportAs:["matTable"],features:[i._Bn([{provide:j.k,useClass:j.yy},{provide:jt,useExisting:n},{provide:_t,useExisting:n},{provide:fe,useClass:oi},{provide:we,useValue:null}]),i.qOj],ngContentSelectors:Ws,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,s){1&t&&(i.F$t(Zs),i.Hsn(0),i.Hsn(1,1),i.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[Yt,Zt,Wt,Ut],styles:["mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}table.mat-table{border-spacing:0}tr.mat-header-row{height:56px}tr.mat-row,tr.mat-footer-row{height:48px}th.mat-header-cell{text-align:left}[dir=rtl] th.mat-header-cell{text-align:right}th.mat-header-cell,td.mat-cell,td.mat-footer-cell{padding:0;border-bottom-width:1px;border-bottom-style:solid}th.mat-header-cell:first-of-type,td.mat-cell:first-of-type,td.mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] th.mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] td.mat-cell:first-of-type:not(:only-of-type),[dir=rtl] td.mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}th.mat-header-cell:last-of-type,td.mat-cell:last-of-type,td.mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] th.mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] td.mat-cell:last-of-type:not(:only-of-type),[dir=rtl] td.mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}.mat-table-sticky{position:sticky !important}.mat-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})(),De=(()=>{class n extends Ct{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["","matCellDef",""]],features:[i._Bn([{provide:Ct,useExisting:n}]),i.qOj]}),n})(),be=(()=>{class n extends yt{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["","matHeaderCellDef",""]],features:[i._Bn([{provide:yt,useExisting:n}]),i.qOj]}),n})(),xe=(()=>{class n extends K{get name(){return this._name}set name(t){this._setNameInput(t)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[i._Bn([{provide:K,useExisting:n},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),i.qOj]}),n})(),Re=(()=>{class n extends me{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-header-cell"],features:[i.qOj]}),n})(),Se=(()=>{class n extends ge{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:["role","gridcell",1,"mat-cell"],features:[i.qOj]}),n})(),hi=(()=>{class n extends bt{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[i._Bn([{provide:bt,useExisting:n}]),i.qOj]}),n})(),ci=(()=>{class n extends Bt{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275dir=i.lG2({type:n,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[i._Bn([{provide:Bt,useExisting:n}]),i.qOj]}),n})(),ui=(()=>{class n extends Ce{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275cmp=i.Xpm({type:n,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-header-row"],exportAs:["matHeaderRow"],features:[i._Bn([{provide:Ce,useExisting:n}]),i.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,s){1&t&&i.GkF(0,0)},dependencies:[tt],encapsulation:2}),n})(),pi=(()=>{class n extends ve{}return n.\u0275fac=function(){let e;return function(s){return(e||(e=i.n5z(n)))(s||n)}}(),n.\u0275cmp=i.Xpm({type:n,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-row"],exportAs:["matRow"],features:[i._Bn([{provide:ve,useExisting:n}]),i.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,s){1&t&&i.GkF(0,0)},dependencies:[tt],encapsulation:2}),n})(),en=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[Ys,gt.BQ,gt.BQ]}),n})();const nn=["dataTable"];function rn(n,e){1&n&&(i.TgZ(0,"mat-header-cell"),i._uU(1,"Name"),i.qZA())}function on(n,e){if(1&n&&(i.TgZ(0,"mat-cell"),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.xp6(1),i.Oqu(t.name)}}function an(n,e){1&n&&(i.TgZ(0,"mat-header-cell"),i._uU(1,"Premium"),i.qZA())}function ln(n,e){if(1&n&&(i.TgZ(0,"mat-cell"),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.xp6(1),i.hij(" ",t.riskPremium+"%","")}}function dn(n,e){1&n&&i._UZ(0,"mat-header-row")}function hn(n,e){1&n&&i._UZ(0,"mat-row")}const un={[O.ALLOCATION]:rt,[O.DIVIDEND_INCOME]:ot,[O.DIVIDEND_GOALS]:at,[O.SECTORAL_DISTRIBUTION]:lt,[O.BALANCE]:dt,[O.CONTRIBUTION]:ht,[O.INVESTMENT_YIELD]:Ss,[O.EQUITY_RISK_PREMIUM]:(()=>{class n{constructor(){this.displayedColumns=["name","riskPremium"]}ngOnInit(){this.dataSource$=this.data$.pipe((0,Lt.U)(t=>t.equities),(0,Ke.d)({refCount:!0,bufferSize:1}))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-equity-risk-premium"]],viewQuery:function(t,s){if(1&t&&i.Gf(nn,5),2&t){let r;i.iGM(r=i.CRH())&&(s.table=r.first)}},decls:14,vars:5,consts:[[1,"card-header"],[1,"title"],[3,"mousedown","touchstart"],[3,"dataSource"],["dataTable",""],["matColumnDef","name"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","riskPremium"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"]],template:function(t,s){1&t&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.TgZ(3,"div",2),i.NdJ("mousedown",function(o){return o.stopPropagation()})("touchstart",function(o){return o.stopPropagation()}),i.TgZ(4,"mat-table",3,4),i.ynx(6,5),i.YNc(7,rn,2,0,"mat-header-cell",6),i.YNc(8,on,2,1,"mat-cell",7),i.BQk(),i.ynx(9,8),i.YNc(10,an,2,0,"mat-header-cell",6),i.YNc(11,ln,2,1,"mat-cell",7),i.BQk(),i.YNc(12,dn,1,0,"mat-header-row",9),i.YNc(13,hn,1,0,"mat-row",10),i.qZA()()),2&t&&(i.xp6(2),i.Oqu(s.card.title),i.xp6(2),i.Q6J("dataSource",s.dataSource$),i.xp6(8),i.Q6J("matHeaderRowDef",s.displayedColumns)("matHeaderRowDefSticky",!0),i.xp6(1),i.Q6J("matRowDefColumns",s.displayedColumns))},dependencies:[di,be,hi,xe,De,ci,Re,Se,ui,pi],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),n})()};let mi=(()=>{class n{constructor(){}loadContent(t,s,r,o){if(!s)return;const a=t.viewContainerRef;a.clear();const l=s.containerType,d=un[l];if(!d)return void console.error(`You forgot to add ${l} to card-container-template-mapper.ts`);const _=a.createComponent(d).instance;_.card=s,_.data$=r,_.cardChanges$?.subscribe(y=>o(y))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})();var L=C(5412),qt=C(8255),Rt=C(7392),gi=C(2687),St=C(727),pn=C(4986),gn=C(6406),fn=C(6451);function Ie(n,e,t){for(let s in e)if(e.hasOwnProperty(s)){const r=e[s];r?n.setProperty(s,r,t?.has(s)?"important":""):n.removeProperty(s)}return n}function vt(n,e){const t=e?"":"none";Ie(n.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function fi(n,e,t){Ie(n.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function Jt(n,e){return e&&"none"!=e?n+" "+e:n}function _i(n){const e=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*e}function Te(n,e){return n.getPropertyValue(e).split(",").map(s=>s.trim())}function ke(n){const e=n.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function Pe(n,e,t){const{top:s,bottom:r,left:o,right:a}=n;return t>=s&&t<=r&&e>=o&&e<=a}function It(n,e,t){n.top+=e,n.bottom=n.top+n.height,n.left+=t,n.right=n.left+n.width}function Ci(n,e,t,s){const{top:r,right:o,bottom:a,left:l,width:d,height:p}=n,_=d*e,y=p*e;return s>r-y&&s<a+y&&t>l-_&&t<o+_}class yi{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:ke(t)})})}handleScroll(e){const t=(0,Q.sA)(e),s=this.positions.get(t);if(!s)return null;const r=s.scrollPosition;let o,a;if(t===this._document){const p=this.getViewportScrollPosition();o=p.top,a=p.left}else o=t.scrollTop,a=t.scrollLeft;const l=r.top-o,d=r.left-a;return this.positions.forEach((p,_)=>{p.clientRect&&t!==_&&t.contains(_)&&It(p.clientRect,l,d)}),r.top=o,r.left=a,{top:l,left:d}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function vi(n){const e=n.cloneNode(!0),t=e.querySelectorAll("[id]"),s=n.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===s?bi(n,e):("input"===s||"select"===s||"textarea"===s)&&Di(n,e),wi("canvas",n,e,bi),wi("input, textarea, select",n,e,Di),e}function wi(n,e,t,s){const r=e.querySelectorAll(n);if(r.length){const o=t.querySelectorAll(n);for(let a=0;a<r.length;a++)s(r[a],o[a])}}let Cn=0;function Di(n,e){"file"!==e.type&&(e.value=n.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${Cn++}`)}function bi(n,e){const t=e.getContext("2d");if(t)try{t.drawImage(n,0,0)}catch{}}const xi=(0,Q.i$)({passive:!0}),Vt=(0,Q.i$)({passive:!1}),Ee=new Set(["position"]);class vn{constructor(e,t,s,r,o,a){this._config=t,this._document=s,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=a,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new k.x,this._pointerMoveSubscription=St.w0.EMPTY,this._pointerUpSubscription=St.w0.EMPTY,this._scrollSubscription=St.w0.EMPTY,this._resizeSubscription=St.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new k.x,this.started=new k.x,this.released=new k.x,this.ended=new k.x,this.entered=new k.x,this.exited=new k.x,this.dropped=new k.x,this.moved=this._moveEvents,this._pointerDown=l=>{if(this.beforeStarted.next(),this._handles.length){const d=this._getTargetHandle(l);d&&!this._disabledHandles.has(d)&&!this.disabled&&this._initializeDragSequence(d,l)}else this.disabled||this._initializeDragSequence(this._rootElement,l)},this._pointerMove=l=>{const d=this._getPointerPositionOnPage(l);if(!this._hasStartedDragging){if(Math.abs(d.x-this._pickupPositionOnPage.x)+Math.abs(d.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const P=Date.now()>=this._dragStartTime+this._getDragStartDelay(l),$=this._dropContainer;if(!P)return void this._endDragSequence(l);(!$||!$.isDragging()&&!$.isReceiving())&&(l.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(l)))}return}l.preventDefault();const p=this._getConstrainedPointerPosition(d);if(this._hasMoved=!0,this._lastKnownPointerPosition=d,this._updatePointerDirectionDelta(p),this._dropContainer)this._updateActiveDropContainer(p,d);else{const _=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,y=this._activeTransform;y.x=p.x-_.x+this._passiveTransform.x,y.y=p.y-_.y+this._passiveTransform.y,this._applyRootElementTransform(y.x,y.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:p,event:l,distance:this._getDragDistance(p),delta:this._pointerDirectionDelta})})},this._pointerUp=l=>{this._endDragSequence(l)},this._nativeDragStart=l=>{if(this._handles.length){const d=this._getTargetHandle(l);d&&!this._disabledHandles.has(d)&&!this.disabled&&l.preventDefault()}else this.disabled||l.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new yi(s),a.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(e){const t=(0,B.Ig)(e);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(s=>vt(s,t)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(s=>(0,B.fI)(s)),this._handles.forEach(s=>vt(s,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(s=>{this._handles.indexOf(s)>-1&&t.add(s)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){const t=(0,B.fI)(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,Vt),t.addEventListener("touchstart",this._pointerDown,xi),t.addEventListener("dragstart",this._nativeDragStart,Vt)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?(0,B.fI)(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),vt(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),vt(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){const e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){const e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){Tt(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const s=this._rootElement,r=s.parentNode,o=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment(""),l=this._getShadowRoot();r.insertBefore(a,s),this._initialTransform=s.style.transform||"",this._preview=this._createPreviewElement(),fi(s,!1,Ee),this._document.body.appendChild(r.replaceChild(o,s)),this._getPreviewInsertionPoint(r,l).appendChild(this._preview),this.started.next({source:this,event:e}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();const s=this.isDragging(),r=Tt(t),o=!r&&0!==t.button,a=this._rootElement,l=(0,Q.sA)(t),d=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),p=r?(0,gi.yG)(t):(0,gi.X6)(t);if(l&&l.draggable&&"mousedown"===t.type&&t.preventDefault(),s||o||d||p)return;if(this._handles.length){const v=a.style;this._rootElementTapHighlight=v.webkitTapHighlightColor||"",v.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(v=>this._updateOnScroll(v)),this._boundaryElement&&(this._boundaryRect=ke(this._boundaryElement));const _=this._previewTemplate;this._pickupPositionInElement=_&&_.template&&!_.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,e,t);const y=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:y.x,y:y.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){fi(this._rootElement,!0,Ee),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,s=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),o=this._getDragDistance(r),a=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:s,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:o,dropPoint:r,event:e}),t.drop(this,s,this._initialIndex,this._initialContainer,a,o,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:s,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=o,this._dropContainer.enter(this,e,t,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(s,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const e=this._previewTemplate,t=this.previewClass,s=e?e.template:null;let r;if(s&&e){const o=e.matchSize?this._initialClientRect:null,a=e.viewContainer.createEmbeddedView(s,e.context);a.detectChanges(),r=Si(a,this._document),this._previewRef=a,e.matchSize?Ii(r,o):r.style.transform=Qt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=vi(this._rootElement),Ii(r,this._initialClientRect),this._initialTransform&&(r.style.transform=this._initialTransform);return Ie(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},Ee),vt(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(o=>r.classList.add(o)):r.classList.add(t)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);const t=function _n(n){const e=getComputedStyle(n),t=Te(e,"transition-property"),s=t.find(l=>"transform"===l||"all"===l);if(!s)return 0;const r=t.indexOf(s),o=Te(e,"transition-duration"),a=Te(e,"transition-delay");return _i(o[r])+_i(a[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(s=>{const r=a=>{(!a||(0,Q.sA)(a)===this._preview&&"transform"===a.propertyName)&&(this._preview?.removeEventListener("transitionend",r),s(),clearTimeout(o))},o=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const e=this._placeholderTemplate,t=e?e.template:null;let s;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),s=Si(this._placeholderRef,this._document)):s=vi(this._rootElement),s.style.pointerEvents="none",s.classList.add("cdk-drag-placeholder"),s}_getPointerPositionInElement(e,t,s){const r=t===this._rootElement?null:t,o=r?r.getBoundingClientRect():e,a=Tt(s)?s.targetTouches[0]:s,l=this._getViewportScrollPosition();return{x:o.left-e.left+(a.pageX-o.left-l.left),y:o.top-e.top+(a.pageY-o.top-l.top)}}_getPointerPositionOnPage(e){const t=this._getViewportScrollPosition(),s=Tt(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=s.pageX-t.left,o=s.pageY-t.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=o,l.matrixTransform(a.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(e){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:s,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialClientRect,this._pickupPositionInElement):e;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(s=this._pickupPositionOnPage.x),this._boundaryRect){const{x:o,y:a}=this._pickupPositionInElement,l=this._boundaryRect,{width:d,height:p}=this._getPreviewRect(),_=l.top+a,y=l.bottom-(p-a);s=Ri(s,l.left+o,l.right-(d-o)),r=Ri(r,_,y)}return{x:s,y:r}}_updatePointerDirectionDelta(e){const{x:t,y:s}=e,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,a=Math.abs(t-o.x),l=Math.abs(s-o.y);return a>this._config.pointerDirectionChangeThreshold&&(r.x=t>o.x?1:-1,o.x=t),l>this._config.pointerDirectionChangeThreshold&&(r.y=s>o.y?1:-1,o.y=s),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,vt(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,Vt),e.removeEventListener("touchstart",this._pointerDown,xi),e.removeEventListener("dragstart",this._nativeDragStart,Vt)}_applyRootElementTransform(e,t){const s=Qt(e,t),r=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=r.transform&&"none"!=r.transform?r.transform:""),r.transform=Jt(s,this._initialTransform)}_applyPreviewTransform(e,t){const s=this._previewTemplate?.template?void 0:this._initialTransform,r=Qt(e,t);this._preview.style.transform=Jt(r,s)}_getDragDistance(e){const t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(0===e&&0===t||this.isDragging()||!this._boundaryElement)return;const s=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===s.width&&0===s.height)return;const o=r.left-s.left,a=s.right-r.right,l=r.top-s.top,d=s.bottom-r.bottom;r.width>s.width?(o>0&&(e+=o),a>0&&(e-=a)):e=0,r.height>s.height?(l>0&&(t+=l),d>0&&(t-=d)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){const t=this.dragStartDelay;return"number"==typeof t?t:Tt(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){const t=this._parentPositions.handleScroll(e);if(t){const s=(0,Q.sA)(e);this._boundaryRect&&s!==this._boundaryElement&&s.contains(this._boundaryElement)&&It(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,Q.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){const s=this._previewContainer||"global";if("parent"===s)return e;if("global"===s){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return(0,B.fI)(s)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}}function Qt(n,e){return`translate3d(${Math.round(n)}px, ${Math.round(e)}px, 0)`}function Ri(n,e,t){return Math.max(e,Math.min(t,n))}function Tt(n){return"t"===n.type[0]}function Si(n,e){const t=n.rootNodes;if(1===t.length&&t[0].nodeType===e.ELEMENT_NODE)return t[0];const s=e.createElement("div");return t.forEach(r=>s.appendChild(r)),s}function Ii(n,e){n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,n.style.transform=Qt(e.left,e.top)}function kt(n,e){return Math.max(0,Math.min(e,n))}class Dn{constructor(e,t){this._element=e,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,s,r){const o=this._itemPositions,a=this._getItemIndexFromPointerPosition(e,t,s,r);if(-1===a&&o.length>0)return null;const l="horizontal"===this.orientation,d=o.findIndex(I=>I.drag===e),p=o[a],y=p.clientRect,v=d>a?1:-1,P=this._getItemOffsetPx(o[d].clientRect,y,v),$=this._getSiblingOffsetPx(d,o,v),H=o.slice();return function wn(n,e,t){const s=kt(e,n.length-1),r=kt(t,n.length-1);if(s===r)return;const o=n[s],a=r<s?-1:1;for(let l=s;l!==r;l+=a)n[l]=n[l+a];n[r]=o}(o,d,a),o.forEach((I,st)=>{if(H[st]===I)return;const te=I.drag===e,Et=te?P:$,zi=te?e.getPlaceholderElement():I.drag.getRootElement();I.offset+=Et,l?(zi.style.transform=Jt(`translate3d(${Math.round(I.offset)}px, 0, 0)`,I.initialTransform),It(I.clientRect,0,Et)):(zi.style.transform=Jt(`translate3d(0, ${Math.round(I.offset)}px, 0)`,I.initialTransform),It(I.clientRect,Et,0))}),this._previousSwap.overlaps=Pe(y,t,s),this._previousSwap.drag=p.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:d,currentIndex:a}}enter(e,t,s,r){const o=null==r||r<0?this._getItemIndexFromPointerPosition(e,t,s):r,a=this._activeDraggables,l=a.indexOf(e),d=e.getPlaceholderElement();let p=a[o];if(p===e&&(p=a[o+1]),!p&&(null==o||-1===o||o<a.length-1)&&this._shouldEnterAsFirstChild(t,s)&&(p=a[0]),l>-1&&a.splice(l,1),p&&!this._dragDropRegistry.isDragging(p)){const _=p.getRootElement();_.parentElement.insertBefore(d,_),a.splice(o,0,e)}else(0,B.fI)(this._element).appendChild(d),a.push(e);d.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables.forEach(e=>{const t=e.getRootElement();if(t){const s=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=s||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(s=>s.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:s})=>{It(s,e,t)}),this._itemPositions.forEach(({drag:s})=>{this._dragDropRegistry.isDragging(s)&&s._sortFromLastPointerPosition()})}_cacheItemPositions(){const e="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const s=t.getVisibleElement();return{drag:t,offset:0,initialTransform:s.style.transform||"",clientRect:ke(s)}}).sort((t,s)=>e?t.clientRect.left-s.clientRect.left:t.clientRect.top-s.clientRect.top)}_getItemOffsetPx(e,t,s){const r="horizontal"===this.orientation;let o=r?t.left-e.left:t.top-e.top;return-1===s&&(o+=r?t.width-e.width:t.height-e.height),o}_getSiblingOffsetPx(e,t,s){const r="horizontal"===this.orientation,o=t[e].clientRect,a=t[e+-1*s];let l=o[r?"width":"height"]*s;if(a){const d=r?"left":"top",p=r?"right":"bottom";-1===s?l-=a.clientRect[d]-o[p]:l+=o[d]-a.clientRect[p]}return l}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;const s=this._itemPositions,r="horizontal"===this.orientation;if(s[0].drag!==this._activeDraggables[0]){const a=s[s.length-1].clientRect;return r?e>=a.right:t>=a.bottom}{const a=s[0].clientRect;return r?e<=a.left:t<=a.top}}_getItemIndexFromPointerPosition(e,t,s,r){const o="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:l,clientRect:d})=>{if(l===e)return!1;if(r){const p=o?r.x:r.y;if(l===this._previousSwap.drag&&this._previousSwap.overlaps&&p===this._previousSwap.delta)return!1}return o?t>=Math.floor(d.left)&&t<Math.floor(d.right):s>=Math.floor(d.top)&&s<Math.floor(d.bottom)});return-1!==a&&this._sortPredicate(a,e)?a:-1}}class bn{constructor(e,t,s,r,o){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=o,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new k.x,this.entered=new k.x,this.exited=new k.x,this.dropped=new k.x,this.sorted=new k.x,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=St.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new k.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function mn(n=0,e=pn.z){return n<0&&(n=0),(0,ie.H)(n,n,e)}(0,gn.Z).pipe((0,q.R)(this._stopScrollTimers)).subscribe(()=>{const a=this._scrollNode,l=this.autoScrollStep;1===this._verticalScrollDirection?a.scrollBy(0,-l):2===this._verticalScrollDirection&&a.scrollBy(0,l),1===this._horizontalScrollDirection?a.scrollBy(-l,0):2===this._horizontalScrollDirection&&a.scrollBy(l,0)})},this.element=(0,B.fI)(e),this._document=s,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new yi(s),this._sortStrategy=new Dn(this.element,t),this._sortStrategy.withSortPredicate((a,l)=>this.sortPredicate(a,l,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,s,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,s,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,s,r,o,a,l,d={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:s,container:this,previousContainer:r,isPointerOverContainer:o,distance:a,dropPoint:l,event:d})}withItems(e){const t=this._draggables;return this._draggables=e,e.forEach(s=>s._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===e.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._sortStrategy.direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._sortStrategy.orientation=e,this}withScrollableParents(e){const t=(0,B.fI)(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,s,r){if(this.sortingDisabled||!this._clientRect||!Ci(this._clientRect,.05,t,s))return;const o=this._sortStrategy.sort(e,t,s,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let s,r=0,o=0;if(this._parentPositions.positions.forEach((a,l)=>{l===this._document||!a.clientRect||s||Ci(a.clientRect,.05,e,t)&&([r,o]=function xn(n,e,t,s){const r=Pi(e,s),o=Ei(e,t);let a=0,l=0;if(r){const d=n.scrollTop;1===r?d>0&&(a=1):n.scrollHeight-d>n.clientHeight&&(a=2)}if(o){const d=n.scrollLeft;1===o?d>0&&(l=1):n.scrollWidth-d>n.clientWidth&&(l=2)}return[a,l]}(l,a.clientRect,e,t),(r||o)&&(s=l))}),!r&&!o){const{width:a,height:l}=this._viewportRuler.getViewportSize(),d={width:a,height:l,top:0,right:a,bottom:l,left:0};r=Pi(d,t),o=Ei(d,e),s=window}s&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||s!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=s,(r||o)&&s?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const e=(0,B.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const e=(0,B.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(e).clientRect}_reset(){this._isDragging=!1;const e=(0,B.fI)(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return null!=this._clientRect&&Pe(this._clientRect,e,t)}_getSiblingContainerFromPosition(e,t,s){return this._siblings.find(r=>r._canReceive(e,t,s))}_canReceive(e,t,s){if(!this._clientRect||!Pe(this._clientRect,t,s)||!this.enterPredicate(e,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,s);if(!r)return!1;const o=(0,B.fI)(this.element);return r===o||o.contains(r)}_startReceiving(e,t){const s=this._activeSiblings;!s.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(s.add(e),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const e=(0,Q.kV)((0,B.fI)(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}}function Pi(n,e){const{top:t,bottom:s,height:r}=n,o=.05*r;return e>=t-o&&e<=t+o?1:e>=s-o&&e<=s+o?2:0}function Ei(n,e){const{left:t,right:s,width:r}=n,o=.05*r;return e>=t-o&&e<=t+o?1:e>=s-o&&e<=s+o?2:0}const Kt=(0,Q.i$)({passive:!1,capture:!0});let Rn=(()=>{class n{constructor(t,s){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new k.x,this.pointerUp=new k.x,this.scroll=new k.x,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=s}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Kt)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Kt)}startDragging(t,s){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=s.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:o=>this.pointerUp.next(o),options:!0}).set("scroll",{handler:o=>this.scroll.next(o),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Kt}),r||this._globalListeners.set("mousemove",{handler:o=>this.pointerMove.next(o),options:Kt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((o,a)=>{this._document.addEventListener(a,o.handler,o.options)})})}}stopDragging(t){const s=this._activeDragInstances.indexOf(t);s>-1&&(this._activeDragInstances.splice(s,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const s=[this.scroll];return t&&t!==this._document&&s.push(new ti.y(r=>this._ngZone.runOutsideAngular(()=>{const a=l=>{this._activeDragInstances.length&&r.next(l)};return t.addEventListener("scroll",a,!0),()=>{t.removeEventListener("scroll",a,!0)}}))),(0,fn.T)(...s)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,s)=>{this._document.removeEventListener(s,t.handler,t.options)}),this._globalListeners.clear()}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(i.R0b),i.LFG(b.K0))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Sn={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let In=(()=>{class n{constructor(t,s,r,o){this._document=t,this._ngZone=s,this._viewportRuler=r,this._dragDropRegistry=o}createDrag(t,s=Sn){return new vn(t,s,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new bn(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(b.K0),i.LFG(i.R0b),i.LFG(Nt.rL),i.LFG(Rn))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Tn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({providers:[In],imports:[Nt.ZD]}),n})();var ct=C(7084),kn=C(2474),Pt=C(7331),Oe=C(7957),Oi=C(6709);let Pn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({providers:[mi,Qe,b.H9],imports:[b.ez,L.Is,W.lN,Ft.LD,T.u5,V.ot,qt.Tx,Rt.Ps,ce.ie,zt.c,T.UX,ft.Ns.forRoot({echarts:()=>C.e(386).then(C.bind(C,7386))}),en,Tn,ct.To,kn.I,Pt.Hi,Oe.Bb,Oi.p9]}),n})();var Mi=C(2761),En=C(5861);const On={gridType:x.Fixed,compactType:R.None,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,mobileBreakpoint:640,minCols:1,maxCols:100,minRows:1,maxRows:100,maxItemCols:100,minItemCols:1,maxItemRows:100,minItemRows:1,maxItemArea:2500,minItemArea:1,defaultItemCols:1,defaultItemRows:1,fixedColWidth:105,fixedRowHeight:105,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,scrollSensitivity:10,scrollSpeed:20,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{enabled:!0},resizable:{enabled:!0},swap:!1,pushItems:!0,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:pt.None,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1};var Mn=C(590);let $i=(()=>{class n{constructor(t){this.http=t}getUserPortfolio(){return this.http.get("/portfolio-dashboards")}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(Ve.eN))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),Fi=(()=>{class n{constructor(t){this.viewContainerRef=t}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b))},n.\u0275dir=i.lG2({type:n,selectors:[["","appPortfolioCardOutlet",""]]}),n})();var Me=C(9300),Li=C(6299),Ai=C(9521),$e=C(8675),$n=C(5577),Fn=C(1520);const Ln=["tagInput"];function An(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"mat-chip",14),i.NdJ("removed",function(){const o=i.CHM(t).$implicit,a=i.oxw();return i.KtG(a.removeTag(o))}),i._uU(1),i.TgZ(2,"button",15)(3,"mat-icon"),i._uU(4,"cancel"),i.qZA()()()}if(2&n){const t=e.$implicit;i.xp6(1),i.hij(" ",t.categoryName+"::"+t.name," ")}}function zn(n,e){if(1&n&&(i.TgZ(0,"mat-option",16),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t),i.xp6(1),i.hij(" ",t.categoryName+"::"+t.name," ")}}let Nn=(()=>{class n{constructor(t,s,r){this.fb=t,this.tagCategoryService=s,this.cd=r,this.separatorKeysCodes=[Ai.K5,Ai.OC],this.segmentDeleted=new i.vpe,this.segmentChanged=new i.vpe}ngOnInit(){this.form=this.fb.group({name:[this.segment.name,T.kI.required],selectedTags:this.fb.control(this.segment.tags)}),this.tagCtrl=this.fb.control(""),this.filteredTags$=this.tagCtrl.valueChanges.pipe((0,$e.O)(""),(0,Me.h)(t=>"string"==typeof t),(0,$n.z)(t=>this.tagCategoryService.findTags(t).pipe((0,Lt.U)(s=>s.content)))),this.form.get("name").valueChanges.pipe((0,$e.O)(this.segment.name),(0,Fn.G)()).subscribe(([t,s])=>{this.segmentChanged.emit({name:t,segment:{name:s,tags:this.selectedTags}})}),this.form.get("selectedTags").valueChanges.pipe((0,$e.O)(this.segment.tags)).subscribe(t=>{const s=this.form.get("name")?.value;this.segmentChanged.emit({name:s,segment:{name:s,tags:this.selectedTags}})})}get selectedTags(){return this.form.get("selectedTags")?.value}removeTag(t){this.form.patchValue({selectedTags:[...this.selectedTags.filter(s=>s.id!==t.id)]}),this.cd.detectChanges()}selectTag(t){this.tagInput.nativeElement.value="",this.tagCtrl.setValue(""),this.form.patchValue({selectedTags:[...this.selectedTags,t.option.value]}),this.cd.detectChanges()}deleteSegment(){this.segmentDeleted.emit({initialName:this.segment.name,recentName:this.form.get("name")?.value})}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(T.j3),i.Y36(Li.$),i.Y36(i.sBO))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-segment-control"]],viewQuery:function(t,s){if(1&t&&i.Gf(Ln,5),2&t){let r;i.iGM(r=i.CRH())&&(s.tagInput=r.first)}},inputs:{segment:"segment"},outputs:{segmentDeleted:"segmentDeleted",segmentChanged:"segmentChanged"},decls:23,vars:10,consts:[[1,"segment-control-panel"],[3,"formGroup"],["appearance","fill",1,"segment-name"],["matInput","","type","text","id","name","placeholder","Name","formControlName","name","autofocus",""],["appearance","fill",1,"segment-tags-list"],["aria-label","Tag selection"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","Select tag...",3,"formControl","matChipInputFor","matAutocomplete","matChipInputSeparatorKeyCodes"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","color","warn",3,"click"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(t,s){if(1&t&&(i.TgZ(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),i._uU(3),i.qZA(),i._UZ(4,"mat-panel-description"),i.qZA(),i.TgZ(5,"form",1)(6,"mat-form-field",2),i._UZ(7,"input",3),i.qZA(),i.TgZ(8,"mat-form-field",4)(9,"mat-label"),i._uU(10,"Position Tags"),i.qZA(),i.TgZ(11,"mat-chip-list",5,6),i.YNc(13,An,5,1,"mat-chip",7),i._UZ(14,"input",8,9),i.qZA(),i.TgZ(16,"mat-autocomplete",10,11),i.NdJ("optionSelected",function(o){return s.selectTag(o)}),i.YNc(18,zn,2,2,"mat-option",12),i.ALo(19,"async"),i.qZA()()(),i.TgZ(20,"mat-action-row")(21,"button",13),i.NdJ("click",function(){return s.deleteSegment()}),i._uU(22,"Delete"),i.qZA()()()),2&t){const r=i.MAs(12),o=i.MAs(17);let a;i.xp6(3),i.hij(" ",null==(a=s.form.get("name"))?null:a.value," "),i.xp6(2),i.Q6J("formGroup",s.form),i.xp6(8),i.Q6J("ngForOf",s.selectedTags),i.xp6(1),i.Q6J("formControl",s.tagCtrl)("matChipInputFor",r)("matAutocomplete",o)("matChipInputSeparatorKeyCodes",s.separatorKeysCodes),i.xp6(4),i.Q6J("ngForOf",i.lcZ(19,8,s.filteredTags$))}},dependencies:[b.sg,W.KE,W.hX,gt.ey,T._Y,T.Fj,T.JJ,T.JL,V.lW,Rt.Hw,zt.Nt,T.oH,T.sg,T.u,ct.ib,ct.VG,ct.yz,ct.yK,ct.u4,Pt.qn,Pt.HS,Pt.oH,Pt.qH,Oe.XC,Oe.ZL,b.Ov],styles:[".segment-name[_ngcontent-%COMP%], .segment-tags-list[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .category-control-panel[_ngcontent-%COMP%]:last-of-type{border-bottom-right-radius:0;border-bottom-left-radius:0;margin-bottom:5px}[_nghost-%COMP%]   .category-control-panel[_ngcontent-%COMP%]:first-of-type{border-top-right-radius:0;border-top-left-radius:0}"],changeDetection:0}),n})();function Hn(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"app-segment-control",9),i.NdJ("segmentChanged",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.handleSegmentChanged(r))})("segmentDeleted",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.handleSegmentDeleted(r))}),i.qZA()}2&n&&i.Q6J("segment",e.$implicit)}function Gn(n,e){if(1&n){const t=i.EpF();i.ynx(0),i.TgZ(1,"div",11)(2,"mat-form-field",12),i._UZ(3,"input",13),i.qZA(),i.TgZ(4,"mat-form-field",12),i._UZ(5,"input",14),i.qZA(),i.TgZ(6,"mat-form-field",12),i._UZ(7,"input",15),i.qZA(),i.TgZ(8,"button",16),i.NdJ("click",function(){const o=i.CHM(t).index,a=i.oxw(2);return i.KtG(a.deleteAnnualDividendProjection(o))}),i.TgZ(9,"mat-icon"),i._uU(10,"delete"),i.qZA()()(),i.BQk()}if(2&n){const t=e.$implicit,s=i.oxw(2);i.xp6(1),i.Q6J("formGroup",s.toFormGroup(t))}}function Yn(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div"),i.ynx(1,8),i.YNc(2,Gn,11,1,"ng-container",9),i.BQk(),i.TgZ(3,"button",10),i.NdJ("click",function(){i.CHM(t);const r=i.oxw();return i.KtG(r.addEmptyProjection())}),i._uU(4,"Add one more projection"),i.qZA()()}if(2&n){const t=i.oxw();i.xp6(2),i.Q6J("ngForOf",t.annualDividendProjections.controls)}}const Wn={[O.ALLOCATION]:(()=>{class n{constructor(t,s,r,o){this.tagCategoryService=t,this.cd=s,this.data=r,this.dialogRef=o,this.segments=r.card?.customSegments??[],this.segmentsState=JSON.parse(JSON.stringify(this.segments))}ngOnInit(){}addSegment(){const t="Segment#";this.segments=[{name:t,tags:[]},...this.segments],this.segmentsState=[{name:t,tags:[]},...this.segmentsState]}handleSegmentChanged(t){this.segmentsState=this.segmentsState.map(s=>s.name===t.name?t.segment:s)}handleOkClick(){this.dialogRef.close({customSegments:this.segmentsState})}handleSegmentDeleted(t){this.segments=this.segments.filter(s=>s.name!==t.initialName),this.segmentsState=this.segmentsState.filter(s=>s.name!==t.recentName)}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(Li.$),i.Y36(i.sBO),i.Y36(L.WI),i.Y36(L.so))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-edit-allocation-card"]],decls:19,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"segments"],[1,"segments-header"],["mat-button","",1,"add-segment-btn",3,"click"],[3,"segment","segmentChanged","segmentDeleted",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"mat-dialog-close"],[3,"segment","segmentChanged","segmentDeleted"]],template:function(t,s){1&t&&(i.TgZ(0,"h1",0),i._uU(1,"Edit Allocation Card"),i.qZA(),i.TgZ(2,"div",1)(3,"h2"),i._uU(4,"Configure custom allocation type"),i.qZA(),i.TgZ(5,"div",2)(6,"div",3)(7,"h2"),i._uU(8),i.qZA(),i.TgZ(9,"button",4),i.NdJ("click",function(){return s.addSegment()}),i.TgZ(10,"mat-icon"),i._uU(11,"add"),i.qZA()()(),i.TgZ(12,"mat-accordion"),i.YNc(13,Hn,1,1,"app-segment-control",5),i.qZA()()(),i.TgZ(14,"div",6)(15,"button",7),i.NdJ("click",function(){return s.handleOkClick()}),i._uU(16,"Ok"),i.qZA(),i.TgZ(17,"button",8),i._uU(18,"Cancel"),i.qZA()()),2&t&&(i.xp6(8),i.Oqu("Segments"),i.xp6(5),i.Q6J("ngForOf",s.segments),i.xp6(4),i.Q6J("mat-dialog-close",null))},dependencies:[b.sg,L.ZT,L.uh,L.xY,L.H8,V.lW,Rt.Hw,ct.pp,Nn],styles:[".segments-header[_ngcontent-%COMP%]{display:inline-flex;align-items:baseline}"],changeDetection:0}),n})(),[O.DIVIDEND_INCOME]:(()=>{class n{constructor(t,s,r,o){this.cd=t,this.data=s,this.dialogRef=r,this.formBuilder=o,this.form=this.formBuilder.group({useCustomDividendProjections:s.card.useCustomDividendProjections,annualDividendProjections:this.formBuilder.array([])}),console.log(s.card),s.card.annualDividendProjections&&0!==s.card.annualDividendProjections?.length?s.card.annualDividendProjections?.forEach(a=>this.addAnnualDividendProjection(a)):this.addEmptyProjection()}ngOnInit(){}addAnnualDividendProjection(t){const s=this.formBuilder.group({ticker:[t.ticker,T.kI.required],dividend:[t.dividend,T.kI.required],currency:[t.currency,T.kI.required]});this.annualDividendProjections.push(s)}deleteAnnualDividendProjection(t){this.annualDividendProjections.removeAt(t)}get annualDividendProjections(){return this.form.controls.annualDividendProjections}handleOkClick(){console.log(this.form.value),this.dialogRef.close(this.form.value)}toFormGroup(t){return t}addEmptyProjection(){this.addAnnualDividendProjection({ticker:"",dividend:0,currency:"RUB"})}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.sBO),i.Y36(L.WI),i.Y36(L.so),i.Y36(T.j3))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-edit-dividend-income-card"]],decls:14,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["formControlName","useCustomDividendProjections"],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"mat-dialog-close"],["formArrayName","annualDividendProjections"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click"],[1,"projection-form-row",3,"formGroup"],["appearance","fill"],["matInput","","formControlName","ticker","placeholder","Ticker"],["matInput","","formControlName","dividend","placeholder","Dividend"],["matInput","","formControlName","currency","placeholder","Currency"],["mat-icon-button","","aria-label","Delete dividend projection",3,"click"]],template:function(t,s){if(1&t&&(i.TgZ(0,"h1",0),i._uU(1,"Edit Dividend Income Card"),i.qZA(),i.TgZ(2,"div",1)(3,"h2"),i._uU(4,"Configure custom allocation type"),i.qZA(),i.TgZ(5,"form",2)(6,"mat-checkbox",3),i._uU(7,"Use custom dividend projections"),i.qZA(),i.YNc(8,Yn,5,1,"div",4),i.qZA()(),i.TgZ(9,"div",5)(10,"button",6),i.NdJ("click",function(){return s.handleOkClick()}),i._uU(11,"Ok"),i.qZA(),i.TgZ(12,"button",7),i._uU(13,"Cancel"),i.qZA()()),2&t){let r;i.xp6(5),i.Q6J("formGroup",s.form),i.xp6(3),i.Q6J("ngIf",null==(r=s.form.get("useCustomDividendProjections"))?null:r.value),i.xp6(4),i.Q6J("mat-dialog-close",null)}},dependencies:[b.sg,b.O5,L.ZT,L.uh,L.xY,L.H8,W.KE,T._Y,T.Fj,T.JJ,T.JL,V.lW,Rt.Hw,zt.Nt,T.sg,T.u,T.CE,Oi.oG],styles:[".projection-form-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start}"],changeDetection:0}),n})()};function Un(n,e){}let ut=class{constructor(e,t,s,r,o){this.cardContentLoaderService=e,this.rxStompService=t,this.cardStore=s,this.cd=r,this.dialog=o,this.onCardChanges=a=>{this.cardStore.updateCard(a)}}ngOnInit(){this.cardData$=this.getCardData(this.card)}ngAfterViewInit(){this.cardContentLoaderService.loadContent(this.cardOutlet,this.card,this.cardData$,this.onCardChanges),this.cd.detectChanges(),this.publishCard(this.card)}publishCard(e){this.rxStompService.publish({destination:"/app/cards",body:JSON.stringify(e)})}ngOnChanges(e){const t=e.card;if(t&&!t.firstChange){if(Object.keys(de).some(s=>t.currentValue[s]!==t.previousValue[s]))return this.cardContentLoaderService.loadContent(this.cardOutlet,this.card,this.cardData$,this.onCardChanges),void this.cd.detectChanges();Object.keys(de).every(s=>t.currentValue[s]===t.previousValue[s])&&this.publishCard(this.card)}}getCardData(e){return this.rxStompService.watch(`/user/topic/cards/${e.id}`).pipe((0,Z.t)(this),(0,Lt.U)(t=>JSON.parse(t.body)),(0,Ke.d)(1))}editCard(){this.card.containerType!==O.ALLOCATION&&this.card.containerType!==O.DIVIDEND_INCOME||this.dialog.open(Wn[this.card.containerType],{data:{title:"Edit Card",card:this.card}}).afterClosed().pipe((0,Me.h)(s=>!!s)).subscribe(s=>{this.onCardChanges({...this.card,...s})})}deleteCard(){this.cardStore.deleteCard(this.card)}};function jn(n,e){if(1&n&&(i.TgZ(0,"mat-option",7),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t),i.xp6(1),i.hij(" ",t," ")}}ut.\u0275fac=function(e){return new(e||ut)(i.Y36(mi),i.Y36(he.g4),i.Y36(At),i.Y36(i.sBO),i.Y36(L.uw))},ut.\u0275cmp=i.Xpm({type:ut,selectors:[["app-card-wrapper"]],viewQuery:function(e,t){if(1&e&&i.Gf(Fi,7),2&e){let s;i.iGM(s=i.CRH())&&(t.cardOutlet=s.first)}},inputs:{card:"card"},features:[i.TTD],decls:10,vars:1,consts:[["mat-icon-button","","aria-label","Configure Card",1,"btn",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["appPortfolioCardOutlet",""]],template:function(e,t){if(1&e&&(i.TgZ(0,"button",0)(1,"mat-icon"),i._uU(2,"more_vert"),i.qZA()(),i.TgZ(3,"mat-menu",null,1)(5,"button",2),i.NdJ("click",function(){return t.editCard()}),i._uU(6,"Edit"),i.qZA(),i.TgZ(7,"button",2),i.NdJ("click",function(){return t.deleteCard()}),i._uU(8,"Delete"),i.qZA()(),i.YNc(9,Un,0,0,"ng-template",3)),2&e){const s=i.MAs(4);i.Q6J("matMenuTriggerFor",s)}},dependencies:[V.lW,qt.VK,qt.OP,qt.p6,Rt.Hw,Fi],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column;height:100%;padding:0 5px}.btn[_ngcontent-%COMP%]{position:absolute;right:0;top:0;width:30px}"],changeDetection:0}),ut=(0,nt.gn)([(0,Z.c)()],ut);let Xn=(()=>{class n{constructor(t,s){this.dialogRef=t,this.data=s,this.selectedCard=s.cards[0]}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(L.so),i.Y36(L.WI))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-select-widget-dialog"]],decls:11,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"widget-selector"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],[3,"value"]],template:function(t,s){1&t&&(i.TgZ(0,"h1",0),i._uU(1,"Select Card to add"),i.qZA(),i.TgZ(2,"div",1)(3,"mat-form-field",2)(4,"mat-select",3),i.NdJ("ngModelChange",function(o){return s.selectedCard=o}),i.YNc(5,jn,2,2,"mat-option",4),i.qZA()()(),i.TgZ(6,"div",5)(7,"button",6),i._uU(8,"Ok"),i.qZA(),i.TgZ(9,"button",6),i._uU(10,"Cancel"),i.qZA()()),2&t&&(i.xp6(4),i.Q6J("ngModel",s.selectedCard),i.xp6(1),i.Q6J("ngForOf",s.data.cards),i.xp6(2),i.Q6J("mat-dialog-close",s.selectedCard),i.xp6(2),i.Q6J("mat-dialog-close",null))},dependencies:[b.sg,L.ZT,L.uh,L.xY,L.H8,W.KE,Ft.gD,gt.ey,T.JJ,T.On,V.lW],styles:[".widget-selector[_ngcontent-%COMP%]{width:100%}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:space-between}"]}),n})(),qn=(()=>{class n{constructor(t){this.dialog=t,this.addNewCard=new i.vpe}ngOnInit(){}onAddNewCard(){this.dialog.open(Xn,{width:"50%",data:{cards:this.getAvailableToSelectCards()}}).afterClosed().pipe((0,Me.h)(s=>!!s)).subscribe(s=>{this.addNewCard.emit(s)})}getAvailableToSelectCards(){return Object.keys(O).filter(t=>"DIVIDEND_GOALS"!==t)}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(L.uw))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-dashboard-actions-bar"]],outputs:{addNewCard:"addNewCard"},decls:2,vars:0,consts:[["mat-button","",3,"click"]],template:function(t,s){1&t&&(i.TgZ(0,"button",0),i.NdJ("click",function(){return s.onAddNewCard()}),i._uU(1,"+ Add New Card"),i.qZA())},dependencies:[V.lW],changeDetection:0}),n})();function Jn(n,e){if(1&n&&(i.TgZ(0,"gridster-item",4),i._UZ(1,"app-card-wrapper",5),i.qZA()),2&n){const t=e.$implicit,s=e.index,r=i.oxw().ngIf;i.Q6J("item",r.items[s]),i.xp6(1),i.Q6J("card",t)}}function Vn(n,e){if(1&n&&(i.ynx(0),i.YNc(1,Jn,2,2,"gridster-item",3),i.BQk()),2&n){const t=e.ngIf,s=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.cards)("ngForTrackBy",s.trackByCardId)}}let Qn=(()=>{class n{constructor(t,s){this.store=t,this.dashboardService=s,this.options={...On,itemChangeCallback:r=>this.store.updateCard(r)}}ngOnInit(){this.dashboardService.getUserPortfolio().pipe((0,Mn.P)()).subscribe(t=>this.store.init(t.id,t.cards))}trackByCardId(t,s){return s?s.id:null}addNewCard(t){this.store.addCard(Je(t))}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(At),i.Y36($i))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-portfolio-dashboard"]],decls:4,vars:4,consts:[[3,"addNewCard"],[3,"options"],[4,"ngIf"],[3,"item",4,"ngFor","ngForOf","ngForTrackBy"],[3,"item"],[3,"card"]],template:function(t,s){1&t&&(i.TgZ(0,"app-dashboard-actions-bar",0),i.NdJ("addNewCard",function(o){return s.addNewCard(o)}),i.qZA(),i.TgZ(1,"gridster",1),i.YNc(2,Vn,2,2,"ng-container",2),i.ALo(3,"async"),i.qZA()),2&t&&(i.xp6(1),i.Q6J("options",s.options),i.xp6(1),i.Q6J("ngIf",i.lcZ(3,2,s.store.cardsByItems$)))},dependencies:[b.sg,b.O5,oe,Wi,ut,qn,b.Ov],styles:["[_nghost-%COMP%]   gridster[_ngcontent-%COMP%]{background-color:#f7f8fa;height:calc(100% - 100px)}[_nghost-%COMP%]   gridster[_ngcontent-%COMP%]   gridster-item[_ngcontent-%COMP%]{box-shadow:0 0 5px #d3d3d3}[_nghost-%COMP%]   gridster[_ngcontent-%COMP%]   .gridster-preview[_ngcontent-%COMP%]{background-color:#0000000f}.gridster-parent[_ngcontent-%COMP%]{height:calc(100% - 70px);background-color:#f6f7fb}"],changeDetection:0}),n})();const Kn=[{path:"",component:(()=>{class n{constructor(t){this.rxStomp=t}ngOnInit(){this.rxStomp.activate()}ngOnDestroy(){var t=this;return(0,En.Z)(function*(){yield t.rxStomp.deactivate()})()}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(he.g4))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-portfolio-view"]],features:[i._Bn([At])],decls:1,vars:0,template:function(t,s){1&t&&i._UZ(0,"app-portfolio-dashboard")},dependencies:[Qn],changeDetection:0}),n})()}];let tr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[Mi.Bz.forChild(Kn),Mi.Bz]}),n})(),er=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({providers:[$i],imports:[b.ez,tr,Ui,Pn,V.ot]}),n})()},655:(Ni,Ot,C)=>{function q(h,c,u,m){var w,f=arguments.length,g=f<3?c:null===m?m=Object.getOwnPropertyDescriptor(c,u):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(h,c,u,m);else for(var S=h.length-1;S>=0;S--)(w=h[S])&&(g=(f<3?w(g):f>3?w(c,u,g):w(c,u))||g);return f>3&&g&&Object.defineProperty(c,u,g),g}C.d(Ot,{gn:()=>q})}}]);