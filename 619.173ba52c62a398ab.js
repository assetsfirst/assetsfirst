"use strict";(self.webpackChunkassets=self.webpackChunkassets||[]).push([[619],{4619:(he,dt,y)=>{y.r(dt),y.d(dt,{PortfoliosModule:()=>mi});var $=y(6895),i=y(4650),U=y(7579),It=y(8372),ct=y(2722),xt=y(3900),bt=y(5963);function Lt(n,e){if(1&n&&i._UZ(0,"div",3),2&n){const t=e.index,s=i.oxw();i.Q6J("ngStyle",s.gridRenderer.getGridColumnStyle(t))}}function Ft(n,e){if(1&n&&i._UZ(0,"div",4),2&n){const t=e.index,s=i.oxw();i.Q6J("ngStyle",s.gridRenderer.getGridRowStyle(t))}}const $t=["*"];function kt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",8),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function At(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",9),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Nt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",10),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function mt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",11),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Yt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",12),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function ut(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",13),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Tt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",14),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}function Bt(n,e){if(1&n){const t=i.EpF();i.TgZ(0,"div",15),i.NdJ("mousedown",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))})("touchstart",function(r){i.CHM(t);const o=i.oxw();return i.KtG(o.resize.dragStartDelay(r))}),i.qZA()}}var w=(()=>{return(n=w||(w={})).Fit="fit",n.ScrollVertical="scrollVertical",n.ScrollHorizontal="scrollHorizontal",n.Fixed="fixed",n.VerticalFixed="verticalFixed",n.HorizontalFixed="horizontalFixed",w;var n})(),nt=(()=>{return(n=nt||(nt={})).Always="always",n.OnDragAndResize="onDrag&Resize",n.None="none",nt;var n})(),I=(()=>{return(n=I||(I={})).None="none",n.CompactUp="compactUp",n.CompactLeft="compactLeft",n.CompactUpAndLeft="compactUp&Left",n.CompactLeftAndUp="compactLeft&Up",n.CompactRight="compactRight",n.CompactUpAndRight="compactUp&Right",n.CompactRightAndUp="compactRight&Up",n.CompactDown="compactDown",n.CompactDownAndLeft="compactDown&Left",n.CompactLeftAndDown="compactLeft&Down",n.CompactDownAndRight="compactDown&Right",n.CompactRightAndDown="compactRight&Down",I;var n})(),P=(()=>{return(n=P||(P={})).LTR="ltr",n.RTL="rtl",P;var n})();class Wt{constructor(e){this.gridster=e}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==I.None&&(this.gridster.$options.compactType===I.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===I.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===I.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===I.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===I.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===I.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===I.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===I.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===I.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===I.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===I.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===I.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(e){this.gridster.$options.compactType!==I.None&&(this.gridster.$options.compactType===I.CompactUp?this.moveTillCollision(e,"y",-1):this.gridster.$options.compactType===I.CompactLeft?this.moveTillCollision(e,"x",-1):this.gridster.$options.compactType===I.CompactUpAndLeft?(this.moveTillCollision(e,"y",-1),this.moveTillCollision(e,"x",-1)):this.gridster.$options.compactType===I.CompactLeftAndUp?(this.moveTillCollision(e,"x",-1),this.moveTillCollision(e,"y",-1)):this.gridster.$options.compactType===I.CompactUpAndRight?(this.moveTillCollision(e,"y",-1),this.moveTillCollision(e,"x",1)):this.gridster.$options.compactType===I.CompactDown?this.moveTillCollision(e,"y",1):this.gridster.$options.compactType===I.CompactDownAndLeft?(this.moveTillCollision(e,"y",1),this.moveTillCollision(e,"x",-1)):this.gridster.$options.compactType===I.CompactLeftAndDown?(this.moveTillCollision(e,"x",-1),this.moveTillCollision(e,"y",1)):this.gridster.$options.compactType===I.CompactDownAndRight?(this.moveTillCollision(e,"y",1),this.moveTillCollision(e,"x",1)):this.gridster.$options.compactType===I.CompactRightAndDown&&(this.moveTillCollision(e,"x",1),this.moveTillCollision(e,"y",1)))}checkCompactMovement(e,t){let s=!1;this.gridster.grid.forEach(r=>{!1!==r.$item.compactEnabled&&this.moveTillCollision(r.$item,e,t)&&(s=!0,r.item[e]=r.$item[e],r.itemChanged())}),s&&this.checkCompact()}moveTillCollision(e,t,s){return e[t]+=s,this.gridster.checkCollision(e)?(e[t]-=s,!1):(this.moveTillCollision(e,t,s),!0)}}const Gt={gridType:w.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:I.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:nt.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:P.LTR};class S{static merge(e,t,s){for(const r in t)void 0!==t[r]&&s.hasOwnProperty(r)&&("object"==typeof t[r]?(r in e||(e[r]={}),e[r]=S.merge(e[r],t[r],s[r])):e[r]=t[r]);return e}static checkTouchEvent(e){void 0===e.clientX&&e.touches&&(e.touches&&e.touches.length?(e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY):e.changedTouches&&e.changedTouches.length&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY))}static checkContentClassForEvent(e,t){if(e.$options.draggable.ignoreContent){if(!S.checkDragHandleClass(t.target,t.currentTarget,e.$options.draggable.dragHandleClass,e.$options.draggable.ignoreContentClass))return!0}else if(S.checkContentClass(t.target,t.currentTarget,e.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(e,t){return S.checkContentClass(t.target,t.currentTarget,e.$options.draggable.ignoreContentClass)||S.checkContentClass(t.target,t.currentTarget,e.$options.draggable.dragHandleClass)}static checkDragHandleClass(e,t,s,r){if(!e||e===t)return!1;if(e.hasAttribute("class")){const o=e.getAttribute("class").split(" ");if(o.indexOf(s)>-1)return!0;if(o.indexOf(r)>-1)return!1}return S.checkDragHandleClass(e.parentNode,t,s,r)}static checkContentClass(e,t,s){return!(!e||e===t)&&(!!(e.hasAttribute("class")&&e.getAttribute("class").split(" ").indexOf(s)>-1)||S.checkContentClass(e.parentNode,t,s))}static compareItems(e,t){return e.y>t.y?-1:e.y<t.y?1:e.x>t.x?-1:1}}class St{constructor(e){this.gridster=e,this.emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||S.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;const s=this.getValidItemFromEvent(t);!s||(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,s),this.gridster.cdRef.markForCheck())},this.emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||S.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t);!s||(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,s),this.gridster.cdRef.markForCheck())},this.emptyCellDragDrop=t=>{const s=this.getValidItemFromEvent(t);!s||(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,s),this.gridster.cdRef.markForCheck())},this.emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t);s?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=s):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()},this.emptyCellMouseDown=t=>{if(S.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t);!s||1!==t.buttons&&!(t instanceof TouchEvent)||(this.initialItem=s,this.gridster.movingItem=s,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))},this.emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();const s=this.getValidItemFromEvent(t,this.initialItem);!s||(this.gridster.movingItem=s,this.gridster.previewStyle())},this.emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();const s=this.getValidItemFromEvent(t,this.initialItem);s&&(this.gridster.movingItem=s),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()}}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}getPixelsX(e,t){const s=this.gridster.options.scale;return s?(e.clientX-t.left)/s+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():e.clientX+this.gridster.el.scrollLeft-t.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(e,t){const s=this.gridster.options.scale;return s?(e.clientY-t.top)/s+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():e.clientY+this.gridster.el.scrollTop-t.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(e,t){e.preventDefault(),e.stopPropagation(),S.checkTouchEvent(e);const s=this.gridster.el.getBoundingClientRect(),r=this.getPixelsX(e,s),o=this.getPixelsY(e,s),h={x:this.gridster.pixelsToPositionX(r,Math.floor,!0),y:this.gridster.pixelsToPositionY(o,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(t&&(h.cols=Math.min(Math.abs(t.x-h.x)+1,this.gridster.$options.emptyCellDragMaxCols),h.rows=Math.min(Math.abs(t.y-h.y)+1,this.gridster.$options.emptyCellDragMaxRows),t.x<h.x?h.x=t.x:t.x-h.x>this.gridster.$options.emptyCellDragMaxCols-1&&(h.x=this.gridster.movingItem?this.gridster.movingItem.x:0),t.y<h.y?h.y=t.y:t.y-h.y>this.gridster.$options.emptyCellDragMaxRows-1&&(h.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),this.gridster.$options.enableOccupiedCellDrop||!this.gridster.checkCollision(h))return h}}class Ht{constructor(e){this.gridster=e}destroy(){this.gridster=null}updateItem(e,t,s){if(this.gridster.mobile)this.clearCellPosition(s,e),s.setStyle(e,"height",this.gridster.$options.keepFixedHeightInMobile?(t.rows-1)*this.gridster.$options.margin+t.rows*this.gridster.$options.fixedRowHeight+"px":t.rows*this.gridster.curWidth/t.cols+"px"),s.setStyle(e,"width",this.gridster.$options.keepFixedWidthInMobile?this.gridster.$options.fixedColWidth+"px":""),s.setStyle(e,"margin-bottom",this.gridster.$options.margin+"px"),s.setStyle(e,P.LTR?"margin-right":"margin-left","");else{const r=Math.round(this.gridster.curColWidth*t.x),o=Math.round(this.gridster.curRowHeight*t.y),h=this.gridster.curColWidth*t.cols-this.gridster.$options.margin,p=this.gridster.curRowHeight*t.rows-this.gridster.$options.margin;this.setCellPosition(s,e,r,o),s.setStyle(e,"width",h+"px"),s.setStyle(e,"height",p+"px");let g=null,C=null;this.gridster.$options.outerMargin&&(this.gridster.rows===t.rows+t.y&&(g=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginBottom+"px":this.gridster.$options.margin+"px"),this.gridster.columns===t.cols+t.x&&(C=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginRight+"px":this.gridster.$options.margin+"px")),s.setStyle(e,"margin-bottom",g),s.setStyle(e,P.LTR?"margin-right":"margin-left",C)}}updateGridster(){let e="",t="",s="",r="";if(this.gridster.$options.gridType===w.Fit)e=w.Fit,t=w.ScrollVertical,s=w.ScrollHorizontal,r=w.Fixed;else if(this.gridster.$options.gridType===w.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,e=w.ScrollVertical,t=w.Fit,s=w.ScrollHorizontal,r=w.Fixed;else if(this.gridster.$options.gridType===w.ScrollHorizontal){const o=this.gridster.$options.rowHeightRatio;this.gridster.curColWidth=this.gridster.curRowHeight*(o>=1?o:o+1),e=w.ScrollHorizontal,t=w.Fit,s=w.ScrollVertical,r=w.Fixed}else this.gridster.$options.gridType===w.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=w.Fixed,t=w.Fit,s=w.ScrollVertical,r=w.ScrollHorizontal):this.gridster.$options.gridType===w.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=w.ScrollVertical,t=w.Fit,s=w.ScrollHorizontal,r=w.Fixed):this.gridster.$options.gridType===w.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=w.ScrollHorizontal,t=w.Fit,s=w.ScrollVertical,r=w.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==w.Fit?this.gridster.renderer.removeClass(this.gridster.el,e):this.gridster.renderer.addClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,s),this.gridster.renderer.removeClass(this.gridster.el,r)}getGridColumnStyle(e){return{...this.getLeftPosition(this.gridster.curColWidth*e),width:this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin+"px"}}getGridRowStyle(e){return{...this.getTopPosition(this.gridster.curRowHeight*e),width:this.gridster.gridColumns.length*this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.curRowHeight-this.gridster.$options.margin+"px"}}getLeftPosition(e){const t=this.gridster.$options.dirType===P.RTL?-e:e;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+t+"px)"}:{left:this.getLeftMargin()+t+"px"}}getTopPosition(e){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+e+"px)"}:{top:this.getTopMargin()+e+"px"}}clearCellPosition(e,t){this.gridster.$options.useTransformPositioning?e.setStyle(t,"transform",""):(e.setStyle(t,"top",""),e.setStyle(t,"left",""))}setCellPosition(e,t,s,r){const o=this.gridster.$options.dirType===P.RTL?-s:s;this.gridster.$options.useTransformPositioning?e.setStyle(t,"transform","translate3d("+o+"px, "+r+"px, 0)"):(e.setStyle(t,"left",this.getLeftMargin()+o+"px"),e.setStyle(t,"top",this.getTopMargin()+r+"px"))}getLeftMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginLeft?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginTop?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}}let ot,a,d,c,u,m,f,x,R,Zt=(()=>{class n{constructor(t,s){this.renderer=s,this.el=t.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(t=>this.previewStyle(t))}ngOnDestroy(){this.sub?.unsubscribe()}previewStyle(t){t?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,t,this.renderer)):this.renderer.setStyle(this.el,"display","")}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.SBq),i.Y36(i.Qsj))},n.\u0275cmp=i.Xpm({type:n,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},decls:0,vars:0,template:function(t,s){},styles:["gridster-preview{position:absolute;display:none;background:rgba(0,0,0,.15)}\n"],encapsulation:2}),n})(),zt=(()=>{class n{constructor(t,s,r,o){this.renderer=s,this.cdRef=r,this.zone=o,this.columns=0,this.rows=0,this.gridColumns=[],this.gridRows=[],this.previewStyle$=new i.vpe,this.calculateLayout$=new U.x,this.resize$=new U.x,this.destroy$=new U.x,this.optionsChanged=()=>{this.setOptions();let p,h=this.grid.length-1;for(;h>=0;h--)p=this.grid[h],p.updateOptions();this.calculateLayout()},this.onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())},this.getNextPossiblePosition=(h,p={})=>{-1===h.cols&&(h.cols=this.$options.defaultItemCols),-1===h.rows&&(h.rows=this.$options.defaultItemRows),this.setGridDimensions();let C,g=p.y||0;for(;g<this.rows;g++)for(h.y=g,C=p.x||0;C<this.columns;C++)if(h.x=C,!this.checkCollision(h))return!0;const b=this.$options.maxRows>=this.rows+h.rows;return this.rows<=this.columns&&b||!(this.$options.maxCols>=this.columns+h.cols)?!!b&&(h.y=this.rows,h.x=0,!0):(h.x=this.columns,h.y=0,!0)},this.getFirstPossiblePosition=h=>{const p=Object.assign({},h);return this.getNextPossiblePosition(p),p},this.getLastPossiblePosition=h=>{let p={y:0,x:0};p=this.grid.reduce((C,b)=>{const O={y:b.$item.y+b.$item.rows-1,x:b.$item.x+b.$item.cols-1};return 1===S.compareItems(C,O)?O:C},p);const g=Object.assign({},h);return this.getNextPossiblePosition(g,p),g},this.el=t.nativeElement,this.$options=JSON.parse(JSON.stringify(Gt)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new St(this),this.compact=new Wt(this),this.gridRenderer=new Ht(this)}static checkCollisionTwoItemsForSwaping(t,s){return t.x+(1===t.cols?0:1)<s.x+s.cols&&t.x+t.cols>s.x+(1===s.cols?0:1)&&t.y+(1===t.rows?0:1)<s.y+s.rows&&t.y+t.rows>s.y+(1===s.rows?0:1)}checkCollisionTwoItems(t,s){if(!(t.x<s.x+s.cols&&t.x+t.cols>s.x&&t.y<s.y+s.rows&&t.y+t.rows>s.y))return!1;if(!this.$options.allowMultiLayer)return!0;const o=this.$options.defaultLayerIndex;return(void 0===t.layerIndex?o:t.layerIndex)===(void 0===s.layerIndex?o:s.layerIndex)}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe((0,It.b)(0),(0,ct.R)(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe((0,xt.w)(()=>(0,bt.H)(100)),(0,ct.R)(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(t){t.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:s=>this.getItemComponent(s)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let t,s;"fit"!==this.$options.gridType||this.mobile?(s=this.el.clientWidth,t=this.el.clientHeight):(s=this.el.offsetWidth,t=this.el.offsetHeight),(s!==this.curWidth||t!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=S.merge(this.$options,this.options,this.$options),this.$options.disableWindowResize||this.windowResize?this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null):this.windowResize=this.renderer.listen("window","resize",this.onResize),this.emptyCell.updateOptions()}ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}checkIfToResize(){const t=this.el.clientWidth,s=this.el.offsetWidth,r=this.el.scrollWidth,o=this.el.clientHeight,h=this.el.offsetHeight,p=this.el.scrollHeight;return!(t<s&&p>h&&p-h<s-t||o<h&&r>s&&r-s<h-o)}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){const t=this.el;let s,r;this.$options.setGridSize||this.$options.gridType===w.Fit&&!this.mobile?(s=t.offsetWidth,r=t.offsetHeight):(s=t.clientWidth,r=t.clientHeight),this.curWidth=s,this.curHeight=r}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let o,t=this.$options.minRows,s=this.$options.minCols,r=this.grid.length-1;for(;r>=0;r--)o=this.grid[r],o.notPlaced||(t=Math.max(t,o.$item.y+o.$item.rows),s=Math.max(s,o.$item.x+o.$item.cols));t+=this.$options.addEmptyRowsCount,(this.columns!==s||this.rows!==t)&&(this.columns=s,this.rows=t,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let r=-this.$options.margin;null!==this.$options.outerMarginLeft?(r+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(r+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),null!==this.$options.outerMarginRight?(r+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(r+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-r)/this.columns;let o=-this.$options.margin;null!==this.$options.outerMarginTop?(o+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(o+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),null!==this.$options.outerMarginBottom?(o+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(o+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-o)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let s,t=this.grid.length-1;for(;t>=0;t--)s=this.grid[t],s.setSize(),s.drag.toggle(),s.resize.toggle();this.resize$.next()}updateGrid(){"always"!==this.$options.displayGrid||this.mobile?"onDrag&Resize"===this.$options.displayGrid&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):("none"===this.$options.displayGrid||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"):this.renderer.addClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=n.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=n.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(t){void 0===t.$item.cols&&(t.$item.cols=this.$options.defaultItemCols,t.item.cols=t.$item.cols,t.itemChanged()),void 0===t.$item.rows&&(t.$item.rows=this.$options.defaultItemRows,t.item.rows=t.$item.rows,t.itemChanged()),-1===t.$item.x||-1===t.$item.y?this.autoPositionItem(t):this.checkCollision(t.$item)&&(this.$options.disableWarnings||(t.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(t.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?t.notPlaced=!0:this.autoPositionItem(t)),this.grid.push(t),this.calculateLayout$.next()}removeItem(t){this.grid.splice(this.grid.indexOf(t),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(t.item,t)}checkCollision(t){let s=!1;if(this.options.itemValidateCallback&&(s=!this.options.itemValidateCallback(t)),!s&&this.checkGridCollision(t)&&(s=!0),!s){const r=this.findItemWithItem(t);r&&(s=r)}return s}checkGridCollision(t){const k=t.cols*t.rows;return!(t.y>-1&&t.x>-1&&t.cols+t.x<=this.$options.maxCols&&t.rows+t.y<=this.$options.maxRows&&t.cols<=(void 0===t.maxItemCols?this.$options.maxItemCols:t.maxItemCols)&&t.cols>=(void 0===t.minItemCols?this.$options.minItemCols:t.minItemCols)&&t.rows<=(void 0===t.maxItemRows?this.$options.maxItemRows:t.maxItemRows)&&t.rows>=(void 0===t.minItemRows?this.$options.minItemRows:t.minItemRows)&&(void 0===t.minItemArea?this.$options.minItemArea:t.minItemArea)<=k&&(void 0===t.maxItemArea?this.$options.maxItemArea:t.maxItemArea)>=k)}findItemWithItem(t){let r,s=0;for(;s<this.grid.length;s++)if(r=this.grid[s],r.$item!==t&&this.checkCollisionTwoItems(r.$item,t))return r;return!1}findItemsWithItem(t){const s=[];let o,r=0;for(;r<this.grid.length;r++)o=this.grid[r],o.$item!==t&&this.checkCollisionTwoItems(o.$item,t)&&s.push(o);return s}autoPositionItem(t){this.getNextPossiblePosition(t.$item)?(t.notPlaced=!1,t.item.x=t.$item.x,t.item.y=t.$item.y,t.itemChanged()):(t.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(t.item,["cols","rows","x","y"])))}pixelsToPositionX(t,s,r){const o=s(t/this.curColWidth);return r?o:Math.max(o,0)}pixelsToPositionY(t,s,r){const o=s(t/this.curRowHeight);return r?o:Math.max(o,0)}positionXToPixels(t){return t*this.curColWidth}positionYToPixels(t){return t*this.curRowHeight}getItemComponent(t){return this.grid.find(s=>s.item===t)}checkCollisionForSwaping(t){let s=!1;if(this.options.itemValidateCallback&&(s=!this.options.itemValidateCallback(t)),!s&&this.checkGridCollision(t)&&(s=!0),!s){const r=this.findItemWithItemForSwapping(t);r&&(s=r)}return s}findItemWithItemForSwapping(t){let r,s=this.grid.length-1;for(;s>-1;s--)if(r=this.grid[s],r.$item!==t&&n.checkCollisionTwoItemsForSwaping(r.$item,t))return r;return!1}previewStyle(t=!1){this.movingItem?(this.compact&&t&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(t,s,r){const o=Math.max(t,Math.floor(s/r));return o<0?0:Number.isFinite(o)?Math.floor(o):0}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.SBq),i.Y36(i.Qsj),i.Y36(i.sBO),i.Y36(i.R0b))},n.\u0275cmp=i.Xpm({type:n,selectors:[["gridster"]],inputs:{options:"options"},features:[i.TTD],ngContentSelectors:$t,decls:4,vars:4,consts:[["class","gridster-column",3,"ngStyle",4,"ngFor","ngForOf"],["class","gridster-row",3,"ngStyle",4,"ngFor","ngForOf"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"],[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"]],template:function(t,s){1&t&&(i.F$t(),i.YNc(0,Lt,1,1,"div",0),i.YNc(1,Ft,1,1,"div",1),i.Hsn(2),i._UZ(3,"gridster-preview",2)),2&t&&(i.Q6J("ngForOf",s.gridColumns),i.xp6(1),i.Q6J("ngForOf",s.gridRows),i.xp6(2),i.Q6J("gridRenderer",s.gridRenderer)("previewStyle$",s.previewStyle$))},dependencies:[$.sg,$.PC,Zt],styles:["gridster{position:relative;box-sizing:border-box;background:grey;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}\n"],encapsulation:2}),n})();class Ot{constructor(e){this.iteration=0,this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=e,this.gridster=e.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(e,t){if(this.gridster.$options.pushItems&&!t){this.pushedItemsOrder=[],this.iteration=0;const s=this.push(this.gridsterItem,e);return s||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],s}return!1}restoreTempItems(){let e=this.pushedItemsTemp.length-1;for(;e>-1;e--)this.removeFromTempPushed(this.pushedItemsTemp[e])}restoreItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.$item.x=s.item.x||0,s.$item.y=s.item.y||0,s.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.checkItemChanges(s.$item,s.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let e=this.pushedItems.length-1,t=!1;for(;e>-1;e--)this.checkPushedItem(this.pushedItems[e],e)&&(t=!0);t&&this.checkPushBack()}push(e,t){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(e.$item)||""===t)return!1;const s=this.gridster.findItemsWithItem(e.$item),r=t===this.fromNorth||t===this.fromWest;s.sort((C,b)=>r?b.$item.y-C.$item.y||b.$item.x-C.$item.x:C.$item.y-b.$item.y||C.$item.x-b.$item.x);let h,o=0,p=!0;const g=[];for(;o<s.length;o++){if(h=s[o],h===this.gridsterItem)continue;if(!h.canBeDragged()){p=!1;break}const C=this.pushedItemsTemp.indexOf(h);if(C>-1&&this.pushedItemsTempPath[C].length>10){p=!1;break}if(this.tryPattern[t][0].call(this,h,e))this.pushedItemsOrder.push(h),g.push(h);else if(this.tryPattern[t][1].call(this,h,e))this.pushedItemsOrder.push(h),g.push(h);else if(this.tryPattern[t][2].call(this,h,e))this.pushedItemsOrder.push(h),g.push(h);else{if(!this.tryPattern[t][3].call(this,h,e)){p=!1;break}this.pushedItemsOrder.push(h),g.push(h)}}if(!p&&(o=this.pushedItemsOrder.lastIndexOf(g[0]),o>-1)){let C=this.pushedItemsOrder.length-1;for(;C>=o;C--)h=this.pushedItemsOrder[C],this.pushedItemsOrder.pop(),this.removeFromTempPushed(h),this.removeFromPushedItem(h)}return this.iteration++,p}trySouth(e,t){return!!this.gridster.$options.pushDirections.south&&(this.addToTempPushed(e),e.$item.y=t.$item.y+t.$item.rows,this.push(e,this.fromNorth)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryNorth(e,t){return!!this.gridster.$options.pushDirections.north&&(this.addToTempPushed(e),e.$item.y=t.$item.y-e.$item.rows,this.push(e,this.fromSouth)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryEast(e,t){return!!this.gridster.$options.pushDirections.east&&(this.addToTempPushed(e),e.$item.x=t.$item.x+t.$item.cols,this.push(e,this.fromWest)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryWest(e,t){return!!this.gridster.$options.pushDirections.west&&(this.addToTempPushed(e),e.$item.x=t.$item.x-e.$item.cols,this.push(e,this.fromEast)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}addToTempPushed(e){let t=this.pushedItemsTemp.indexOf(e);-1===t&&(t=this.pushedItemsTemp.push(e)-1,this.pushedItemsTempPath[t]=[]),this.pushedItemsTempPath[t].push({x:e.$item.x,y:e.$item.y})}removeFromTempPushed(e){const t=this.pushedItemsTemp.indexOf(e),s=this.pushedItemsTempPath[t].pop();!s||(e.$item.x=s.x,e.$item.y=s.y,e.setSize(),this.pushedItemsTempPath[t].length||(this.pushedItemsTemp.splice(t,1),this.pushedItemsTempPath.splice(t,1)))}addToPushed(e){if(this.pushedItems.indexOf(e)<0)this.pushedItems.push(e),this.pushedItemsPath.push([{x:e.item.x||0,y:e.item.y||0},{x:e.$item.x,y:e.$item.y}]);else{const t=this.pushedItems.indexOf(e);this.pushedItemsPath[t].push({x:e.$item.x,y:e.$item.y})}}removeFromPushed(e){e>-1&&(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1))}removeFromPushedItem(e){const t=this.pushedItems.indexOf(e);t>-1&&(this.pushedItemsPath[t].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1)))}checkPushedItem(e,t){const s=this.pushedItemsPath[t];let o,h,p,r=s.length-2,g=!1;for(;r>-1;r--)o=s[r],h=e.$item.x,p=e.$item.y,e.$item.x=o.x,e.$item.y=o.y,this.gridster.findItemWithItem(e.$item)?(e.$item.x=h,e.$item.y=p):(e.setSize(),s.splice(r+1,s.length-r-1),g=!0);return s.length<2&&this.removeFromPushed(t),g}}function v(n,e,t,s,r,o,h,p,g,C){ot=n.$options.scrollSensitivity,a=n.$options.scrollSpeed,d=n.el,c=g,u=C;const b=d.offsetWidth,A=d.scrollLeft,D=d.scrollTop,k=t-D,H=d.offsetHeight+D-t-r,{clientX:rt,clientY:Et}=o;if(!n.$options.disableScrollVertical)if(h.clientY<Et&&H<ot){if(Xt(),c&&u&&!u.south||R)return;R=T(1,p,h)}else if(h.clientY>Et&&D>0&&k<ot){if(Z(),c&&u&&!u.north||x)return;x=T(-1,p,h)}else h.clientY!==Et&&N();const pi=e-A;if(!n.$options.disableScrollHorizontal)if(h.clientX<rt&&A+b-e-s<=ot){if(W(),c&&u&&!u.east||m)return;m=_(1,p,h)}else if(h.clientX>rt&&A>0&&pi<ot){if(B(),c&&u&&!u.west||f)return;f=_(-1,p,h)}else h.clientX!==rt&&L()}function T(n,e,t){let s=t.clientY;return window.setInterval(()=>{(!d||-1===n&&d.scrollTop-a<0)&&N(),d.scrollTop+=n*a,s+=n*a,e({clientX:t.clientX,clientY:s})},50)}function _(n,e,t){let s=t.clientX;return window.setInterval(()=>{(!d||-1===n&&d.scrollLeft-a<0)&&L(),d.scrollLeft+=n*a,s+=n*a,e({clientX:s,clientY:t.clientY})},50)}function z(){L(),N(),d=null}function L(){B(),W()}function N(){Xt(),Z()}function B(){m&&(clearInterval(m),m=0)}function W(){f&&(clearInterval(f),f=0)}function Z(){R&&(clearInterval(R),R=0)}function Xt(){x&&(clearInterval(x),x=0)}class le{constructor(e){this.gridsterItem=e,this.gridster=e.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){const e=this.swapedItem.$item.x,t=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=e,this.swapedItem.$item.y=t):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(e){let t;if(t=this.gridster.$options.swapWhileDragging?this.gridster.checkCollisionForSwaping(e.$item):this.gridster.checkCollision(e.$item),t&&!0!==t&&t.canBeDragged()){const s=t,r=s.$item.x,o=s.$item.y,h=e.$item.x,p=e.$item.y,g=h-r,C=p-o;s.$item.x=e.item.x-g,s.$item.y=e.item.y-C,e.$item.x=s.item.x+g,e.$item.y=s.item.y+C,this.gridster.checkCollision(s.$item)||this.gridster.checkCollision(e.$item)?(e.$item.x=h,e.$item.y=p,s.$item.x=r,s.$item.y=o):(s.setSize(),this.swapedItem=s,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}}var E=(()=>{return(n=E||(E={})).UP="UP",n.DOWN="DOWN",n.LEFT="LEFT",n.RIGHT="RIGHT",E;var n})();class ce{constructor(e,t,s){this.zone=s,this.collision=!1,this.dragMove=r=>{r.stopPropagation(),r.preventDefault(),S.checkTouchEvent(r);let o=this.getDirections(r);this.gridster.options.enableBoundaryControl&&(o.includes(E.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+this.margin&&(o=o.filter(h=>h!=E.UP),r=new MouseEvent(r.type,{clientX:r.clientX,clientY:this.lastMouse.clientY})),o.includes(E.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+this.margin&&(o=o.filter(h=>h!=E.LEFT),r=new MouseEvent(r.type,{clientX:this.lastMouse.clientX,clientY:r.clientY})),o.includes(E.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-this.margin&&(o=o.filter(h=>h!=E.RIGHT),r=new MouseEvent(r.type,{clientX:this.lastMouse.clientX,clientY:r.clientY})),o.includes(E.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-this.margin&&(o=o.filter(h=>h!=E.DOWN),r=new MouseEvent(r.type,{clientX:r.clientX,clientY:this.lastMouse.clientY}))),o.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,v(this.gridster,this.left,this.top,this.width,this.height,r,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(r))},this.calculateItemPositionFromMousePosition=r=>{this.gridster.options.scale?this.calculateItemPositionWithScale(r,this.gridster.options.scale):this.calculateItemPositionWithoutScale(r),this.calculateItemPosition(),this.lastMouse.clientX=r.clientX,this.lastMouse.clientY=r.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=r=>{r.stopPropagation(),r.preventDefault(),z(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,r)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})},this.cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&!0!==this.collision&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.dragStartDelay=r=>{if(r.target.classList.contains("gridster-item-resizable-handler")||S.checkContentClassForEvent(this.gridster,r))return;if(S.checkTouchEvent(r),!this.gridster.$options.draggable.delayStart)return void this.dragStart(r);const h=setTimeout(()=>{this.dragStart(r),k()},this.gridster.$options.draggable.delayStart),p=this.gridsterItem.renderer.listen("document","mouseup",k),g=this.gridsterItem.renderer.listen("document","mouseleave",k),C=this.gridsterItem.renderer.listen("window","blur",k),b=this.gridsterItem.renderer.listen("document","touchmove",function D(H){S.checkTouchEvent(H),(Math.abs(H.clientX-r.clientX)>9||Math.abs(H.clientY-r.clientY)>9)&&k()}),O=this.gridsterItem.renderer.listen("document","touchend",k),A=this.gridsterItem.renderer.listen("document","touchcancel",k);function k(){clearTimeout(h),C(),p(),g(),b(),O(),A()}},this.gridsterItem=e,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(e){e.which&&1!==e.which||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.diffLeft=this.gridster.$options.dirType===P.RTL?e.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:e.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=e.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new Ot(this.gridsterItem),this.swap=new le(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}calculateItemPositionWithScale(e,t){this.left=this.gridster.$options.dirType===P.RTL?this.gridster.el.scrollWidth-this.originalClientX+(e.clientX-this.originalClientX)/t+this.diffLeft:this.originalClientX+(e.clientX-this.originalClientX)/t+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(e.clientY-this.originalClientY)/t+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(e){this.left=this.gridster.$options.dirType===P.RTL?this.gridster.el.scrollWidth-e.clientX+this.diffLeft:e.clientX+this.offsetLeft-this.diffLeft,this.top=e.clientY+this.offsetTop-this.diffTop}calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){const e=this.path[this.path.length-1];let t="";e.x<this.gridsterItem.$item.x?t=this.push.fromWest:e.x>this.gridsterItem.$item.x?t=this.push.fromEast:e.y<this.gridsterItem.$item.y?t=this.push.fromNorth:e.y>this.gridsterItem.$item.y&&(t=this.push.fromSouth),this.push.pushItems(t,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&!0!==this.collision&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){const e=this.gridsterItem.canBeDragged();!this.enabled&&e?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!e&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}getDirections(e){const t=[];return 0===this.lastMouse.clientX&&0===this.lastMouse.clientY&&(this.lastMouse.clientY=e.clientY,this.lastMouse.clientX=e.clientX),this.lastMouse.clientY>e.clientY&&t.push(E.UP),this.lastMouse.clientY<e.clientY&&t.push(E.DOWN),this.lastMouse.clientX<e.clientX&&t.push(E.RIGHT),this.lastMouse.clientX>e.clientX&&t.push(E.LEFT),t}}class me{constructor(e){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=e,this.gridster=e.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(e){return!!this.gridster.$options.pushResizeItems&&this.push(this.gridsterItem,e)}restoreItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.$item.x=s.item.x||0,s.$item.y=s.item.y||0,s.$item.cols=s.item.cols||1,s.$item.row=s.item.row||1,s.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let e=0;const t=this.pushedItems.length;let s;for(;e<t;e++)s=this.pushedItems[e],s.checkItemChanges(s.$item,s.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let e=this.pushedItems.length-1,t=!1;for(;e>-1;e--)this.checkPushedItem(this.pushedItems[e],e)&&(t=!0);t&&this.checkPushBack()}push(e,t){const s=this.gridster.checkCollision(e.$item);if(s&&!0!==s&&s!==this.gridsterItem&&s.canBeResized()){if(this.tryPattern[t].call(this,s,e,t))return!0}else if(!1===s)return!0;return!1}trySouth(e,t,s){const r=e.$item.y,o=e.$item.rows;return e.$item.y=t.$item.y+t.$item.rows,e.$item.rows=o+r-e.$item.y,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.y=r,e.$item.rows=o,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}tryNorth(e,t,s){const r=e.$item.rows;return e.$item.rows=t.$item.y-e.$item.y,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.rows=r,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}tryEast(e,t,s){const r=e.$item.x,o=e.$item.cols;return e.$item.x=t.$item.x+t.$item.cols,e.$item.cols=o+r-e.$item.x,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.x=r,e.$item.cols=o,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}tryWest(e,t,s){const r=e.$item.cols;return e.$item.cols=t.$item.x-e.$item.x,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.cols=r,!1):(e.setSize(),this.addToPushed(e),this.push(t,s),!0)}addToPushed(e){if(this.pushedItems.indexOf(e)<0)this.pushedItems.push(e),this.pushedItemsPath.push([{x:e.item.x||0,y:e.item.y||0,cols:e.item.cols||0,rows:e.item.rows||0},{x:e.$item.x,y:e.$item.y,cols:e.$item.cols,rows:e.$item.rows}]);else{const t=this.pushedItems.indexOf(e);this.pushedItemsPath[t].push({x:e.$item.x,y:e.$item.y,cols:e.$item.cols,rows:e.$item.rows})}}removeFromPushed(e){e>-1&&(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1))}checkPushedItem(e,t){const s=this.pushedItemsPath[t];let o,h,p,g,C,r=s.length-2;for(;r>-1;r--)o=s[r],h=e.$item.x,p=e.$item.y,g=e.$item.cols,C=e.$item.rows,e.$item.x=o.x,e.$item.y=o.y,e.$item.cols=o.cols,e.$item.rows=o.rows,this.gridster.findItemWithItem(e.$item)?(e.$item.x=h,e.$item.y=p,e.$item.cols=g,e.$item.rows=C):(e.setSize(),s.splice(r+1,s.length-1-r));return s.length<2&&(this.removeFromPushed(t),!0)}}class ue{constructor(e,t,s){this.zone=s,this.directionFunction=null,this.dragMove=r=>{if(null===this.directionFunction)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");r.stopPropagation(),r.preventDefault(),S.checkTouchEvent(r),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,v(this.gridster,this.left,this.top,this.width,this.height,r,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);const o=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(r.clientX-this.originalClientX)/o,clientY:this.originalClientY+(r.clientY-this.originalClientY)/o}),this.lastMouse.clientX=r.clientX,this.lastMouse.clientY=r.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=r=>{r.stopPropagation(),r.preventDefault(),z(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,r)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})},this.cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.handleNorth=r=>{if(this.top=r.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight,this.top=this.bottom-this.minHeight),this.newPosition=this.gridster.pixelsToPositionY(this.top+this.margin,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)},this.handleWest=r=>{if(this.left=(this.gridster.$options.dirType===P.RTL?this.originalClientX+(this.originalClientX-r.clientX):r.clientX)+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width&&(this.width=this.minWidth,this.left=this.right-this.minWidth),this.newPosition=this.gridster.pixelsToPositionX(this.left+this.margin,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)},this.handleSouth=r=>{if(this.height=r.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.newPosition=this.gridster.pixelsToPositionY(this.bottom,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.rows=this.itemBackup[3],void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)},this.handleEast=r=>{if(this.width=(this.gridster.$options.dirType===P.RTL?this.originalClientX+(this.originalClientX-r.clientX):r.clientX)+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.newPosition=this.gridster.pixelsToPositionX(this.right,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.cols=this.itemBackup[2],void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)},this.handleNorthWest=r=>{this.handleNorth(r),this.handleWest(r)},this.handleNorthEast=r=>{this.handleNorth(r),this.handleEast(r)},this.handleSouthWest=r=>{this.handleSouth(r),this.handleWest(r)},this.handleSouthEast=r=>{this.handleSouth(r),this.handleEast(r)},this.gridsterItem=e,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(e){if(e.which&&1!==e.which)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=e.clientX,this.lastMouse.clientY=e.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=e.clientX+this.offsetLeft-this.left,this.diffRight=e.clientX+this.offsetLeft-this.right,this.diffTop=e.clientY+this.offsetTop-this.top,this.diffBottom=e.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new Ot(this.gridsterItem),this.pushResize=new me(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();const{classList:t}=e.target;t.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):t.contains("handle-w")?this.gridster.$options.dirType===P.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):t.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):t.contains("handle-e")?this.gridster.$options.dirType===P.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):t.contains("handle-nw")?this.gridster.$options.dirType===P.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):t.contains("handle-ne")?this.gridster.$options.dirType===P.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):t.contains("handle-sw")?this.gridster.$options.dirType===P.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):t.contains("handle-se")&&(this.gridster.$options.dirType===P.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(e){if(S.checkTouchEvent(e),!this.gridster.$options.resizable.delayStart)return void this.dragStart(e);const t=setTimeout(()=>{this.dragStart(e),b()},this.gridster.$options.resizable.delayStart),{cancelMouse:s,cancelMouseLeave:r,cancelOnBlur:o,cancelTouchMove:h,cancelTouchEnd:p,cancelTouchCancel:g}=this.zone.runOutsideAngular(()=>({cancelMouse:this.gridsterItem.renderer.listen("document","mouseup",b),cancelMouseLeave:this.gridsterItem.renderer.listen("document","mouseleave",b),cancelOnBlur:this.gridsterItem.renderer.listen("window","blur",b),cancelTouchMove:this.gridsterItem.renderer.listen("document","touchmove",C),cancelTouchEnd:this.gridsterItem.renderer.listen("document","touchend",b),cancelTouchCancel:this.gridsterItem.renderer.listen("document","touchcancel",b)}));function C(O){S.checkTouchEvent(O),(Math.abs(O.clientX-e.clientX)>9||Math.abs(O.clientY-e.clientY)>9)&&b()}function b(){clearTimeout(t),o(),s(),r(),h(),p(),g()}}setItemTop(e){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,e)}setItemLeft(e){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,e,this.top)}setItemHeight(e){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",e+"px")}setItemWidth(e){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",e+"px")}}let pe=(()=>{class n{constructor(t,s,r,o){this.renderer=r,this.zone=o,this.itemInit=new i.vpe,this.itemChange=new i.vpe,this.itemResize=new i.vpe,this.el=t.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=s,this.drag=new ce(this,s,this.zone),this.resize=new ue(this,s,this.zone)}get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(t){t.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),t.item&&t.item.previousValue&&this.setSize()}updateOptions(){this.$item=S.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){const s=this.$item.x*this.gridster.curColWidth,r=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,o=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=this.$item.y*this.gridster.curRowHeight,this.left=s,!this.init&&r>0&&o>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(r!==this.width||o!==this.height)&&(this.width=r,this.height=o,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(t,s){t.rows===s.rows&&t.cols===s.cols&&t.x===s.x&&t.y===s.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=s.x||0,this.$item.y=s.y||0,this.$item.cols=s.cols||1,this.$item.rows=s.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){const t=this.gridster.$options.draggable.enabled;return!this.gridster.mobile&&t&&(void 0===this.$item.dragEnabled?t:this.$item.dragEnabled)}canBeResized(){const t=this.gridster.$options.resizable.enabled;return!this.gridster.mobile&&t&&(void 0===this.$item.resizeEnabled?t:this.$item.resizeEnabled)}getResizableHandles(){const t=this.gridster.$options.resizable.handles,s=this.$item.resizableHandles;return void 0===s?t:{...t,...s}}bringToFront(t){if(t&&t<=0)return;const s=this.getLayerIndex(),r=this.gridster.$options.maxLayerIndex;if(s<r){const o=t?s+t:r;this.item.layerIndex=this.$item.layerIndex=o>r?r:o}}sendToBack(t){if(t&&t<=0)return;const s=this.getLayerIndex();if(s>0){const r=t?s-t:0;this.item.layerIndex=this.$item.layerIndex=r<0?0:r}}getLayerIndex(){return void 0!==this.item.layerIndex?this.item.layerIndex:void 0!==this.gridster.$options.defaultLayerIndex?this.gridster.$options.defaultLayerIndex:0}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.SBq),i.Y36(zt),i.Y36(i.Qsj),i.Y36(i.R0b))},n.\u0275cmp=i.Xpm({type:n,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(t,s){2&t&&i.Udp("z-index",s.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},features:[i.TTD],ngContentSelectors:$t,decls:9,vars:8,consts:[["class","gridster-item-resizable-handler handle-s",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-e",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-n",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-w",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-se",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-ne",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-sw",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-nw",3,"mousedown","touchstart",4,"ngIf"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(t,s){1&t&&(i.F$t(),i.Hsn(0),i.YNc(1,kt,1,0,"div",0),i.YNc(2,At,1,0,"div",1),i.YNc(3,Nt,1,0,"div",2),i.YNc(4,mt,1,0,"div",3),i.YNc(5,Yt,1,0,"div",4),i.YNc(6,ut,1,0,"div",5),i.YNc(7,Tt,1,0,"div",6),i.YNc(8,Bt,1,0,"div",7)),2&t&&(i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.s)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.e)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.n)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.w)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.se)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.ne)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.sw)&&s.resize.resizeEnabled),i.xp6(1),i.Q6J("ngIf",(null==s.resize.resizableHandles?null:s.resize.resizableHandles.nw)&&s.resize.resizeEnabled))},dependencies:[$.O5],styles:["gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:white;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}\n"],encapsulation:2}),n})(),ge=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[$.ez]}),n})();var J=y(655),F=y(9933),at=(()=>{return(n=at||(at={})).INSTRUMENT_TYPE="INSTRUMENT_TYPE",n.BROKER="BROKER",n.TRADING_CURRENCY="TRADING_CURRENCY",at;var n})(),G=y(9549),pt=y(4385),Pt=y(3238),V=y(4859),gt=y(5861),ft=y(9646),yt=y(515),Ut=y(4986),fe=y(9751),Jt=y(4482),Ct=y(5403),Vt=y(8421);const jt={leading:!0,trailing:!1};class _t{constructor(e){this.changes=e}static of(e){return new _t(e)}notEmpty(e){if(this.changes[e]){const t=this.changes[e].currentValue;if(null!=t)return(0,ft.of)(t)}return yt.E}has(e){return this.changes[e]?(0,ft.of)(this.changes[e].currentValue):yt.E}notFirst(e){return this.changes[e]&&!this.changes[e].isFirstChange()?(0,ft.of)(this.changes[e].currentValue):yt.E}notFirstAndEmpty(e){if(this.changes[e]&&!this.changes[e].isFirstChange()){const t=this.changes[e].currentValue;if(null!=t)return(0,ft.of)(t)}return yt.E}}const Qt=new i.OlP("NGX_ECHARTS_CONFIG");let ht=(()=>{class n{constructor(t,s,r){this.el=s,this.ngZone=r,this.autoResize=!0,this.loadingType="default",this.chartInit=new i.vpe,this.optionsError=new i.vpe,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartPieSelectChanged=this.createLazyEvent("pieselectchanged"),this.chartPieSelected=this.createLazyEvent("pieselected"),this.chartPieUnselected=this.createLazyEvent("pieunselected"),this.chartMapSelectChanged=this.createLazyEvent("mapselectchanged"),this.chartMapSelected=this.createLazyEvent("mapselected"),this.chartMapUnselected=this.createLazyEvent("mapunselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartFocusNodeAdjacency=this.createLazyEvent("focusnodeadjacency"),this.chartUnfocusNodeAdjacency=this.createLazyEvent("unfocusnodeadjacency"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.resize$=new U.x,this.echarts=t.echarts}ngOnChanges(t){const s=_t.of(t);s.notFirstAndEmpty("options").subscribe(r=>this.onOptionsChange(r)),s.notFirstAndEmpty("merge").subscribe(r=>this.setOption(r)),s.has("loading").subscribe(r=>this.toggleLoading(!!r)),s.notFirst("theme").subscribe(()=>this.refreshChart())}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(function Ce(n,e=Ut.z,t=jt){const s=(0,bt.H)(n,e);return function ye(n,{leading:e,trailing:t}=jt){return(0,Jt.e)((s,r)=>{let o=!1,h=null,p=null,g=!1;const C=()=>{p?.unsubscribe(),p=null,t&&(A(),g&&r.complete())},b=()=>{p=null,g&&r.complete()},O=D=>p=(0,Vt.Xf)(n(D)).subscribe(new Ct.Q(r,C,b)),A=()=>{if(o){o=!1;const D=h;h=null,r.next(D),!g&&O(D)}};s.subscribe(new Ct.Q(r,D=>{o=!0,h=D,(!p||p.closed)&&(e?A():O(D))},()=>{g=!0,(!(t&&o&&p)||p.closed)&&r.complete()}))})}(()=>s,t)}(100,Ut.z,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(()=>{this.animationFrameID=window.requestAnimationFrame(()=>this.resize$.next())})),this.resizeOb.observe(this.el.nativeElement))}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(t){this.chart&&(t?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading())}setOption(t,s){if(this.chart)try{this.chart.setOption(t,s)}catch(r){console.error(r),this.optionsError.emit(r)}}refreshChart(){var t=this;return(0,gt.Z)(function*(){t.dispose(),yield t.initChart()})()}createChart(){const t=this.el.nativeElement;if(window&&window.getComputedStyle){const s=window.getComputedStyle(t,null).getPropertyValue("height");(!s||"0px"===s)&&(!t.style.height||"0px"===t.style.height)&&(t.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:r})=>r(t,this.theme,this.initOpts)))}initChart(){var t=this;return(0,gt.Z)(function*(){yield t.onOptionsChange(t.options),t.merge&&t.chart&&t.setOption(t.merge)})()}onOptionsChange(t){var s=this;return(0,gt.Z)(function*(){!t||(s.chart||(s.chart=yield s.createChart(),s.chartInit.emit(s.chart)),s.setOption(s.options,!0))})()}createLazyEvent(t){return this.chartInit.pipe((0,xt.w)(s=>new fe.y(r=>(s.on(t,o=>this.ngZone.run(()=>r.next(o))),()=>{this.chart&&(this.chart.isDisposed()||s.off(t))}))))}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(Qt),i.Y36(i.SBq),i.Y36(i.R0b))},n.\u0275dir=i.lG2({type:n,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",loading:"loading",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartPieSelectChanged:"chartPieSelectChanged",chartPieSelected:"chartPieSelected",chartPieUnselected:"chartPieUnselected",chartMapSelectChanged:"chartMapSelectChanged",chartMapSelected:"chartMapSelected",chartMapUnselected:"chartMapUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartFocusNodeAdjacency:"chartFocusNodeAdjacency",chartUnfocusNodeAdjacency:"chartUnfocusNodeAdjacency",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[i.TTD]}),n})(),ve=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:Qt,useValue:t}]}}static forChild(){return{ngModule:n}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({}),n})();function we(n,e){if(1&n&&(i.TgZ(0,"mat-option",8),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t.value),i.xp6(1),i.hij(" ",t.value," ")}}function Ie(n,e){1&n&&(i.TgZ(0,"span"),i._uU(1," / "),i.qZA())}function xe(n,e){if(1&n){const t=i.EpF();i.ynx(0),i.TgZ(1,"button",11),i.NdJ("click",function(){const o=i.CHM(t).$implicit,h=i.oxw(2);return i.KtG(h.selectTopSegments(o))}),i._uU(2),i.qZA(),i.YNc(3,Ie,2,0,"span",12),i.BQk()}if(2&n){const t=e.$implicit,s=e.last;i.xp6(1),i.ekj("active",s),i.Q6J("disabled",s),i.xp6(1),i.hij(" ",t.name," "),i.xp6(1),i.Q6J("ngIf",!s)}}function be(n,e){if(1&n&&(i.TgZ(0,"div",9),i.YNc(1,xe,4,5,"ng-container",10),i.qZA()),2&n){const t=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.chartPath)}}let j=class{constructor(e,t){this.cd=e,this.currencyPipe=t,this.cardChanges$=new i.vpe,this.chartPath=[],this.allocatedByOptions=Object.keys(at).map(s=>({value:s})),this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,F.t)(this)).subscribe(e=>{this.chartSegments=[...e.segments],this.chartOption=this.constructChartOption(this.chartSegments),this.chartPath=[{name:"All",values:[...this.chartSegments]}],this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){return{tooltip:{trigger:"item",formatter:t=>{console.log(t);const s=this.currencyPipe.transform(t.value,t.data.currencySymbol);return`<b>${t.marker}${t.name} ${s} (${t.percent}%)</b>`}},legend:this.getChartLegend(),series:[{name:"",type:"pie",center:["50%","50%"],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:32,fontWeight:"bold"}},labelLine:{show:!1},data:e}]}}getChartLegend(){if(this.card.rows>3||this.card.cols>3)return{bottom:"5%",left:"center"}}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}onSegmentSelected(e){const t=this.chartSegments.find(s=>s.name===e.name);t.children&&(this.chartSegments=[...t.children],this.chartOption=this.constructChartOption(this.chartSegments),this.chartPath.push({name:e.name,values:[]}))}onAllocatedByOptionChanged(e){this.loading=!0,this.cd.detectChanges(),this.card={...this.card,allocatedBy:e},this.cardChanges$.emit(this.card)}selectTopSegments(e){const t=this.chartPath.indexOf(e);this.chartPath.splice(t+1),this.chartSegments=[...this.chartPath[t].values],this.chartOption=this.constructChartOption([...this.chartSegments])}};j.\u0275fac=function(e){return new(e||j)(i.Y36(i.sBO),i.Y36($.H9))},j.\u0275cmp=i.Xpm({type:j,selectors:[["app-allocation-card"]],decls:10,vars:7,consts:[[1,"card-header"],[1,"title"],["appearance","legacy"],["matPrefix",""],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["class","breadcrumbs",4,"ngIf"],["echarts","",1,"pie-chart",3,"options","loading","chartInit","chartClick"],[3,"value"],[1,"breadcrumbs"],[4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],[4,"ngIf"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA(),i.TgZ(3,"mat-form-field",2)(4,"div",3),i._uU(5),i.qZA(),i.TgZ(6,"mat-select",4),i.NdJ("valueChange",function(r){return t.onAllocatedByOptionChanged(r)}),i.YNc(7,we,2,2,"mat-option",5),i.qZA()()(),i.YNc(8,be,2,1,"div",6),i.TgZ(9,"div",7),i.NdJ("chartInit",function(r){return t.onChartInit(r)})("chartClick",function(r){return t.onSegmentSelected(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(3),i.Oqu("by:"),i.xp6(1),i.Q6J("value",t.card.allocatedBy),i.xp6(1),i.Q6J("ngForOf",t.allocatedByOptions),i.xp6(1),i.Q6J("ngIf",t.chartPath.length>1),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[$.sg,$.O5,G.KE,G.qo,pt.gD,Pt.ey,V.lW,ht],styles:[".card-header{display:flex;align-items:center}.card-header .title{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.pie-chart .ngx-charts-outer{margin:0 auto}.breadcrumbs{max-height:24px;position:absolute;z-index:10}\n"],encapsulation:2,changeDetection:0}),j=(0,J.gn)([(0,F.c)()],j);var M=(()=>{return(n=M||(M={})).ALLOCATION="ALLOCATION",n.DIVIDEND_INCOME="DIVIDEND_INCOME",n.DIVIDEND_GOALS="DIVIDEND_GOALS",n.SECTORAL_DISTRIBUTION="SECTORAL_DISTRIBUTION",n.BALANCE="BALANCE",n.CONTRIBUTION="CONTRIBUTION",n.INVESTMENT_YIELD="INVESTMENT_YIELD",M;var n})(),lt=(()=>{return(n=lt||(lt={})).MONTH="MONTH",n.QUARTER="QUARTER",n.YEAR="YEAR",lt;var n})();function $e(n,e){if(1&n&&(i.TgZ(0,"mat-option",7),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t.value),i.xp6(1),i.hij(" ",t.value," ")}}let Q=class{constructor(e){this.cd=e,this.cardChanges$=new i.vpe,this.timeFrameOptions=Object.keys(lt).map(t=>({value:t})),this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,F.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){const t=e.dividends;return{tooltip:{trigger:"item",position:"inside",formatter:function(r){const o=t.find(g=>g.name===r.name);if(!o)return`<div class="tooltip-dividend"><div class="tooltip-dividend-title">${r.seriesName}: ${r.value}</div></div>`;const p=o.series[r.seriesIndex].details.map(g=>`<span class="dividend-detail">${g.name}: ${g.total}</span>`).join("");return`<div class="tooltip-dividend"><div class="tooltip-dividend-title">${r.seriesName}: ${r.value}</div><div class="tooltip-dividend-details">${p}</div></div>`}},xAxis:{type:"category",data:t.map(r=>r.name)},yAxis:{type:"value"},series:this.composeBarSeries(t)}}composeBarSeries(e){const t=[];return e.forEach((s,r)=>{s.series.forEach(0===r?o=>t.push({name:o.name,data:[o.value],type:"bar",showBackground:!0,details:[o.details]}):(o,h)=>{t[h].data.push(o.value),t[h].details.push(o.details)})}),t}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}onTimeFrameOptionChanged(e){this.loading=!0,this.cd.detectChanges(),this.cardChanges$.emit({...this.card,timeFrame:e})}};Q.\u0275fac=function(e){return new(e||Q)(i.Y36(i.sBO))},Q.\u0275cmp=i.Xpm({type:Q,selectors:[["app-dividends-card"]],decls:9,vars:6,consts:[[1,"card-header"],[1,"title"],["appearance","legacy"],["matPrefix",""],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["echarts","",1,"dividend-income-chart",3,"options","loading","chartInit"],[3,"value"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA(),i.TgZ(3,"mat-form-field",2)(4,"div",3),i._uU(5),i.qZA(),i.TgZ(6,"mat-select",4),i.NdJ("valueChange",function(r){return t.onTimeFrameOptionChanged(r)}),i.YNc(7,$e,2,2,"mat-option",5),i.qZA()()(),i.TgZ(8,"div",6),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(3),i.Oqu("By:"),i.xp6(1),i.Q6J("value",t.card.timeFrame),i.xp6(1),i.Q6J("ngForOf",t.timeFrameOptions),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[$.sg,G.KE,G.qo,pt.gD,Pt.ey,ht],styles:[".card-header{display:flex;align-items:center}.card-header .title{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.tooltip-dividend{max-width:400px;min-width:150px}.tooltip-dividend-title{text-align:center}.tooltip-dividend-details{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:center}.tooltip-dividend-details .dividend-detail{flex:1 1 30%;display:flex;justify-content:space-evenly;padding:2px}\n"],encapsulation:2,changeDetection:0}),Q=(0,J.gn)([(0,F.c)()],Q);var Te=y(5684),Se=y(4671),ze=y(5032),Oe=y(3269),_e=y(9770),Re=y(8505),Y=y(4006),De=y(1135);class Le{constructor(){this.cards=[]}}var qt=y(4004);const Rt={x:0,y:0,cols:3,rows:2,minItemCols:3,minItemRows:2};class q{constructor(e){this.originCard={id:"_"+Math.random().toString(36).substr(2,9),containerType:e,...Rt}}}function Kt(n){const e=He[n];if(!e)throw new Error(`Cannot find card factory for ${n}`);return new e(n).create()}const He={[M.ALLOCATION]:class ke extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Allocation",cols:4,rows:3,allocatedBy:at.INSTRUMENT_TYPE}}},[M.DIVIDEND_INCOME]:class Ae extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Dividend Income",cols:3,rows:4,timeFrame:lt.YEAR}}},[M.DIVIDEND_GOALS]:class Ne extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Dividend Goals",cols:4,rows:3,desiredYieldByIssuer:{}}}},[M.SECTORAL_DISTRIBUTION]:class Ye extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Sectoral Distribution",cols:4,rows:3}}},[M.BALANCE]:class Be extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Balance",cols:3,rows:2,minItemCols:3,minItemRows:2}}},[M.CONTRIBUTION]:class We extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Contributions",cols:3,rows:2,minItemCols:3,minItemRows:2}}},[M.INVESTMENT_YIELD]:class Ge extends q{constructor(e){super(e)}create(){return{...this.originCard,title:"Investment Yield",cols:2,rows:1,minItemCols:2,minItemRows:1}}}};var te=y(529),Mt=y(4487);let ee=(()=>{class n{constructor(t,s){this.http=t,this.rxStompService=s}addCard(t,s){this.manageCard(t,s,"add")}updateCards(t,s){this.manageCard(t,s,"update")}deleteCard(t,s){this.manageCard(t,s,"delete")}manageCard(t,s,r){this.rxStompService.publish({destination:`/app/${t}/cards/${r}`,body:JSON.stringify(s)})}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(te.eN),i.LFG(Mt.g4))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),vt=(()=>{class n extends class Ee{constructor(e){this._state$=new De.X(e),this.state$=this._state$.asObservable()}get state(){return this._state$.getValue()}setState(e){this._state$.next(e)}}{constructor(t){super(new Le),this.cardService=t,this.cardsByItems$=this.state$.pipe((0,qt.U)(s=>({cards:s.cards,items:s.cards.map(r=>({...r}))})))}init(t,s){const r=s.map(o=>({...Kt(o.containerType),...o}));this.setState({...this.state,dashboardId:t,cards:r})}addCard(t){const{dashboardId:s}=this.state;this.cardService.addCard(s,t),this.setState({...this.state,cards:[...this.state.cards,t]})}updateCard(t){const{dashboardId:s}=this.state,r=this.state.cards.map(o=>o.id===t.id?t:o);this.cardService.updateCards(s,r),this.setState({...this.state,cards:r})}deleteCard(t){const{dashboardId:s}=this.state;this.cardService.deleteCard(s,t),this.setState({...this.state,cards:[...this.state.cards.filter(r=>r.id!==t.id)]})}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(ee))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})();var Dt=y(4633),ie=y(4144);function Ze(n,e){if(1&n&&(i.TgZ(0,"button",11),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.xp6(1),i.Oqu(t)}}function Xe(n,e){if(1&n&&(i.TgZ(0,"mat-list-item")(1,"span"),i._uU(2),i.qZA(),i.TgZ(3,"mat-form-field",6)(4,"mat-label"),i._uU(5,"Yield"),i.qZA(),i.TgZ(6,"span",7),i._uU(7),i.qZA(),i._UZ(8,"input",8),i.TgZ(9,"span",9),i._uU(10,"%"),i.qZA()(),i.YNc(11,Ze,2,1,"button",10),i.qZA()),2&n){const t=e.$implicit,s=e.index;i.xp6(2),i.Oqu(t.name),i.xp6(5),i.hij("",t.currentYield+"% /","\xa0"),i.xp6(1),i.Q6J("formControlName",s),i.xp6(3),i.Q6J("ngForOf",t.targets)}}function Ue(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"form",3)(2,"mat-list",4),i.YNc(3,Xe,12,4,"mat-list-item",5),i.qZA()(),i.BQk()),2&n){const t=e.ngIf,s=i.oxw();i.xp6(1),i.Q6J("formGroup",s.form),i.xp6(1),i.Q6J("formArrayName","desiredYields"),i.xp6(1),i.Q6J("ngForOf",t.items)}}let K=class{constructor(e,t,s){this.fb=e,this.store=t,this.cd=s,this.form=e.group({desiredYields:e.array([])})}get desiredYields(){return this.form.get("desiredYields")}ngOnInit(){this.setupFormBeforeData$=this.data$.pipe(function Me(n){return e=>(0,_e.P)(()=>{let t=!0;return e.pipe((0,Re.b)(s=>{t&&n(s),t=!1}))})}(e=>{console.log(this.card.desiredYieldByIssuer),e.items.forEach(t=>this.desiredYields.push(this.fb.control(this.card.desiredYieldByIssuer?.[t.name]??t.currentYield)))}))}ngAfterViewInit(){this.desiredYields.valueChanges.pipe((0,F.t)(this),(0,It.b)(300),(0,Te.T)(1),function Pe(...n){const e=(0,Oe.jO)(n);return(0,Jt.e)((t,s)=>{const r=n.length,o=new Array(r);let h=n.map(()=>!1),p=!1;for(let g=0;g<r;g++)(0,Vt.Xf)(n[g]).subscribe(new Ct.Q(s,C=>{o[g]=C,!p&&!h[g]&&(h[g]=!0,(p=h.every(Se.y))&&(h=null))},ze.Z));t.subscribe(new Ct.Q(s,g=>{if(p){const C=[g,...o];s.next(e?e(...C):C)}}))})}(this.data$)).subscribe(([e,t])=>{const s=t.items.reduce((r,o,h)=>(r[o.name]=e[h],r),{});this.store.updateCard({...this.card,desiredYieldByIssuer:s})})}};K.\u0275fac=function(e){return new(e||K)(i.Y36(Y.QS),i.Y36(vt),i.Y36(i.sBO))},K.\u0275cmp=i.Xpm({type:K,selectors:[["app-dividend-goals-card"]],decls:5,vars:4,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],[3,"formGroup"],[3,"formArrayName"],[4,"ngFor","ngForOf"],[1,"example-full-width"],["matPrefix",""],["matInput","","placeholder","100","autocomplete","false",3,"formControlName"],["matSuffix",""],["mat-button","",4,"ngFor","ngForOf"],["mat-button",""]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,Ue,4,3,"ng-container",2),i.ALo(4,"async")),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,2,t.setupFormBeforeData$)))},dependencies:[$.sg,$.O5,G.KE,G.hX,G.qo,G.R9,Y._Y,Y.Fj,Y.JJ,Y.JL,V.lW,Dt.i$,Dt.Tg,ie.Nt,Y.sg,Y.u,Y.CE,$.Ov],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),K=(0,J.gn)([(0,F.c)()],K);let tt=class{constructor(e){this.cd=e,this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,F.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){return{tooltip:{trigger:"item"},series:[{type:"treemap",visibleMin:300,label:{show:!0,formatter:"{b}"},upperLabel:{show:!0,height:25,color:"white"},levels:this.getLevelOption(),data:e.items}]}}getLevelOption(){return[{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},upperLabel:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},emphasis:{itemStyle:{borderColor:"#ddd"}}},{colorSaturation:[.35,.5],itemStyle:{borderWidth:2,gapWidth:1,borderColorSaturation:.6}}]}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}};function Je(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"div",4),i._uU(2),i.ALo(3,"currency"),i.qZA(),i.TgZ(4,"div",5)(5,"span"),i._uU(6),i.ALo(7,"currency"),i.qZA(),i.TgZ(8,"span"),i._uU(9),i.qZA()(),i.BQk()),2&n){const t=e.ngIf;i.xp6(2),i.Oqu(i.xi3(3,3,t.currentAmount,t.currencySymbol)),i.xp6(4),i.Oqu(i.xi3(7,6,t.investedAmount,t.currencySymbol)),i.xp6(3),i.Oqu("invested")}}tt.\u0275fac=function(e){return new(e||tt)(i.Y36(i.sBO))},tt.\u0275cmp=i.Xpm({type:tt,selectors:[["app-sectoral-distribution-card"]],decls:4,vars:3,consts:[[1,"card-header"],[1,"title"],["echarts","",1,"distribution-chart",3,"options","loading","chartInit"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.TgZ(3,"div",2),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[ht],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),tt=(0,J.gn)([(0,F.c)()],tt);let et=class{constructor(e){this.cd=e,this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,F.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){const{xaxis:t,values:s}=e.investedAmountByDates;return{tooltip:{trigger:"item"},xAxis:{type:"category",boundaryGap:!1,data:t,show:this.card.cols>3},yAxis:{type:"value",show:this.card.cols>=6&&this.card.rows>=3},series:[{data:s,type:"line",areaStyle:{},triggerLineEvent:!0}]}}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}};et.\u0275fac=function(e){return new(e||et)(i.Y36(i.sBO))},et.\u0275cmp=i.Xpm({type:et,selectors:[["app-balance-card"]],decls:6,vars:6,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],["echarts","",1,"balance-chart",3,"options","loading","chartInit"],[1,"current-amount"],[1,"invested-amount"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,Je,10,9,"ng-container",2),i.ALo(4,"async"),i.TgZ(5,"div",3),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,4,t.data$)),i.xp6(2),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[$.O5,ht,$.Ov,$.H9],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}.invested-amount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:5px}"],changeDetection:0}),et=(0,J.gn)([(0,F.c)()],et);let it=class{constructor(e){this.cd=e,this.loading=!1}ngOnInit(){}ngAfterViewInit(){this.data$.pipe((0,F.t)(this)).subscribe(e=>{this.chartOption=this.constructChartOption(e),this.loading=!1,this.cd.detectChanges()})}constructChartOption(e){const t=e.contributions.map(s=>({name:s.name,stack:"one",data:s.data,type:"bar"}));return{tooltip:{trigger:"item"},xAxis:{name:"Months of contributions",nameLocation:"middle",nameTextStyle:{fontSize:16,padding:12},data:e.xaxis,axisLine:{onZero:!0},splitLine:{show:!0},splitArea:{show:!0}},yAxis:{},series:t}}onChartInit(e){this.echartsInstance=e,e.resize({width:110*this.card.cols,height:100*this.card.rows})}};function Ve(n,e){if(1&n&&(i.ynx(0),i.TgZ(1,"div",3)(2,"span"),i._uU(3,"TTM yield on cost: "),i.qZA(),i._uU(4),i.qZA(),i.BQk()),2&n){const t=e.ngIf;i.xp6(4),i.Oqu(t.dividendYield+"%")}}it.\u0275fac=function(e){return new(e||it)(i.Y36(i.sBO))},it.\u0275cmp=i.Xpm({type:it,selectors:[["app-contribution-card"]],decls:4,vars:3,consts:[[1,"card-header"],[1,"title"],["echarts","",1,"contribution-chart",3,"options","loading","chartInit"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.TgZ(3,"div",2),i.NdJ("chartInit",function(r){return t.onChartInit(r)}),i.qZA()),2&e&&(i.xp6(2),i.Oqu(t.card.title),i.xp6(1),i.Q6J("options",t.chartOption)("loading",t.loading))},dependencies:[ht],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),it=(0,J.gn)([(0,F.c)()],it);const Qe={[M.ALLOCATION]:j,[M.DIVIDEND_INCOME]:Q,[M.DIVIDEND_GOALS]:K,[M.SECTORAL_DISTRIBUTION]:tt,[M.BALANCE]:et,[M.CONTRIBUTION]:it,[M.INVESTMENT_YIELD]:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-investment-yield-card"]],decls:5,vars:4,consts:[[1,"card-header"],[1,"title"],[4,"ngIf"],[1,"yield"]],template:function(t,s){1&t&&(i.TgZ(0,"div",0)(1,"h2",1),i._uU(2),i.qZA()(),i.YNc(3,Ve,5,1,"ng-container",2),i.ALo(4,"async")),2&t&&(i.xp6(2),i.Oqu(s.card.title),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,2,s.data$)))},dependencies:[$.O5,$.Ov],styles:[".card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:5px;font-size:16px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:500;max-width:60%}"],changeDetection:0}),n})()};let se=(()=>{class n{constructor(){}loadContent(t,s,r,o){if(!s)return;const h=t.viewContainerRef;h.clear();const p=s.containerType,g=Qe[p];if(!g)return void console.error(`You forgot to add ${p} to card-container-template-mapper.ts`);const b=h.createComponent(g).instance;b.card=s,b.data$=r,b.cardChanges$?.subscribe(O=>o(O))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})();var X=y(5412),wt=y(8255),re=y(7392);let qe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({providers:[se,ee,$.H9],imports:[$.ez,X.Is,G.lN,pt.LD,Y.u5,V.ot,wt.Tx,re.Ps,Dt.ie,ie.c,Y.UX,ve.forRoot({echarts:()=>y.e(386).then(y.bind(y,7386))})]}),n})();var ne=y(4364);const Ke={gridType:w.Fixed,compactType:I.None,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,mobileBreakpoint:640,minCols:1,maxCols:100,minRows:1,maxRows:100,maxItemCols:100,minItemCols:1,maxItemRows:100,minItemRows:1,maxItemArea:2500,minItemArea:1,defaultItemCols:1,defaultItemRows:1,fixedColWidth:105,fixedRowHeight:105,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,scrollSensitivity:10,scrollSpeed:20,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{enabled:!0},resizable:{enabled:!0},swap:!1,pushItems:!0,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:nt.None,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1};var ti=y(590);let oe=(()=>{class n{constructor(t){this.http=t}getUserPortfolio(){return this.http.get("/portfolio-dashboards")}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(te.eN))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),ae=(()=>{class n{constructor(t){this.viewContainerRef=t}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(i.s_b))},n.\u0275dir=i.lG2({type:n,selectors:[["","appPortfolioCardOutlet",""]]}),n})();var ei=y(4782);function ii(n,e){}let st=class{constructor(e,t,s,r){this.cardContentLoaderService=e,this.rxStompService=t,this.cardStore=s,this.cd=r,this.onCardChanges=o=>{this.cardStore.updateCard(o)}}ngOnInit(){this.cardData$=this.getCardData(this.card)}ngAfterViewInit(){this.cardContentLoaderService.loadContent(this.cardOutlet,this.card,this.cardData$,this.onCardChanges),this.cd.detectChanges(),this.publishCard(this.card)}publishCard(e){this.rxStompService.publish({destination:"/app/cards",body:JSON.stringify(e)})}ngOnChanges(e){const t=e.card;if(t&&!t.firstChange){if(Object.keys(Rt).some(s=>t.currentValue[s]!==t.previousValue[s]))return this.cardContentLoaderService.loadContent(this.cardOutlet,this.card,this.cardData$,this.onCardChanges),void this.cd.detectChanges();Object.keys(Rt).every(s=>t.currentValue[s]===t.previousValue[s])&&this.publishCard(this.card)}}getCardData(e){return this.rxStompService.watch(`/user/topic/cards/${e.id}`).pipe((0,F.t)(this),(0,qt.U)(t=>JSON.parse(t.body)),(0,ei.d)(1))}deleteCard(){this.cardStore.deleteCard(this.card)}};function si(n,e){if(1&n&&(i.TgZ(0,"mat-option",7),i._uU(1),i.qZA()),2&n){const t=e.$implicit;i.Q6J("value",t),i.xp6(1),i.hij(" ",t," ")}}st.\u0275fac=function(e){return new(e||st)(i.Y36(se),i.Y36(Mt.g4),i.Y36(vt),i.Y36(i.sBO))},st.\u0275cmp=i.Xpm({type:st,selectors:[["app-card-wrapper"]],viewQuery:function(e,t){if(1&e&&i.Gf(ae,7),2&e){let s;i.iGM(s=i.CRH())&&(t.cardOutlet=s.first)}},inputs:{card:"card"},features:[i.TTD],decls:10,vars:1,consts:[["mat-icon-button","","aria-label","Configure Card",1,"btn",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["appPortfolioCardOutlet",""]],template:function(e,t){if(1&e&&(i.TgZ(0,"button",0)(1,"mat-icon"),i._uU(2,"more_vert"),i.qZA()(),i.TgZ(3,"mat-menu",null,1)(5,"button",2),i._uU(6,"Edit"),i.qZA(),i.TgZ(7,"button",3),i.NdJ("click",function(){return t.deleteCard()}),i._uU(8,"Delete"),i.qZA()(),i.YNc(9,ii,0,0,"ng-template",4)),2&e){const s=i.MAs(4);i.Q6J("matMenuTriggerFor",s)}},dependencies:[V.lW,wt.VK,wt.OP,wt.p6,re.Hw,ae],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column;height:100%;padding:0 5px}.btn[_ngcontent-%COMP%]{position:absolute;right:0;top:0;width:30px}"],changeDetection:0}),st=(0,J.gn)([(0,F.c)()],st);let ri=(()=>{class n{constructor(t,s){this.dialogRef=t,this.data=s,this.selectedCard=s.cards[0]}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(X.so),i.Y36(X.WI))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-select-widget-dialog"]],decls:11,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"widget-selector"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],[3,"value"]],template:function(t,s){1&t&&(i.TgZ(0,"h1",0),i._uU(1,"Select Card to add"),i.qZA(),i.TgZ(2,"div",1)(3,"mat-form-field",2)(4,"mat-select",3),i.NdJ("ngModelChange",function(o){return s.selectedCard=o}),i.YNc(5,si,2,2,"mat-option",4),i.qZA()()(),i.TgZ(6,"div",5)(7,"button",6),i._uU(8,"Ok"),i.qZA(),i.TgZ(9,"button",6),i._uU(10,"Cancel"),i.qZA()()),2&t&&(i.xp6(4),i.Q6J("ngModel",s.selectedCard),i.xp6(1),i.Q6J("ngForOf",s.data.cards),i.xp6(2),i.Q6J("mat-dialog-close",s.selectedCard),i.xp6(2),i.Q6J("mat-dialog-close",null))},dependencies:[$.sg,X.ZT,X.uh,X.xY,X.H8,G.KE,pt.gD,Pt.ey,Y.JJ,Y.On,V.lW],styles:[".widget-selector[_ngcontent-%COMP%]{width:100%}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:space-between}"]}),n})();var ni=y(9300);let oi=(()=>{class n{constructor(t){this.dialog=t,this.addNewCard=new i.vpe}ngOnInit(){}onAddNewCard(){this.dialog.open(ri,{width:"50%",data:{cards:this.getAvailableToSelectCards()}}).afterClosed().pipe((0,ni.h)(s=>!!s)).subscribe(s=>{this.addNewCard.emit(s)})}getAvailableToSelectCards(){return Object.keys(M).filter(t=>"DIVIDEND_GOALS"!==t)}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(X.uw))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-dashboard-actions-bar"]],outputs:{addNewCard:"addNewCard"},decls:2,vars:0,consts:[["mat-button","",3,"click"]],template:function(t,s){1&t&&(i.TgZ(0,"button",0),i.NdJ("click",function(){return s.onAddNewCard()}),i._uU(1,"+ Add New Card"),i.qZA())},dependencies:[V.lW],changeDetection:0}),n})();function ai(n,e){if(1&n&&(i.TgZ(0,"gridster-item",4),i._UZ(1,"app-card-wrapper",5),i.qZA()),2&n){const t=e.$implicit,s=e.index,r=i.oxw().ngIf;i.Q6J("item",r.items[s]),i.xp6(1),i.Q6J("card",t)}}function hi(n,e){if(1&n&&(i.ynx(0),i.YNc(1,ai,2,2,"gridster-item",3),i.BQk()),2&n){const t=e.ngIf,s=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.cards)("ngForTrackBy",s.trackByCardId)}}let li=(()=>{class n{constructor(t,s){this.store=t,this.dashboardService=s,this.options={...Ke,itemChangeCallback:r=>this.store.updateCard(r)}}ngOnInit(){this.dashboardService.getUserPortfolio().pipe((0,ti.P)()).subscribe(t=>this.store.init(t.id,t.cards))}trackByCardId(t,s){return s?s.id:null}addNewCard(t){this.store.addCard(Kt(t))}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(vt),i.Y36(oe))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-portfolio-dashboard"]],decls:4,vars:4,consts:[[3,"addNewCard"],[3,"options"],[4,"ngIf"],[3,"item",4,"ngFor","ngForOf","ngForTrackBy"],[3,"item"],[3,"card"]],template:function(t,s){1&t&&(i.TgZ(0,"app-dashboard-actions-bar",0),i.NdJ("addNewCard",function(o){return s.addNewCard(o)}),i.qZA(),i.TgZ(1,"gridster",1),i.YNc(2,hi,2,2,"ng-container",2),i.ALo(3,"async"),i.qZA()),2&t&&(i.xp6(1),i.Q6J("options",s.options),i.xp6(1),i.Q6J("ngIf",i.lcZ(3,2,s.store.cardsByItems$)))},dependencies:[$.sg,$.O5,zt,pe,st,oi,$.Ov],styles:["[_nghost-%COMP%]   gridster[_ngcontent-%COMP%]{background-color:#f7f8fa;height:calc(100% - 100px)}[_nghost-%COMP%]   gridster[_ngcontent-%COMP%]   gridster-item[_ngcontent-%COMP%]{box-shadow:0 0 5px #d3d3d3}[_nghost-%COMP%]   gridster[_ngcontent-%COMP%]   .gridster-preview[_ngcontent-%COMP%]{background-color:#0000000f}.gridster-parent[_ngcontent-%COMP%]{height:calc(100% - 70px);background-color:#f6f7fb}"],changeDetection:0}),n})();const di=[{path:"",component:(()=>{class n{constructor(t){this.rxStomp=t}ngOnInit(){this.rxStomp.activate()}ngOnDestroy(){var t=this;return(0,gt.Z)(function*(){yield t.rxStomp.deactivate()})()}}return n.\u0275fac=function(t){return new(t||n)(i.Y36(Mt.g4))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-portfolio-view"]],features:[i._Bn([vt])],decls:1,vars:0,template:function(t,s){1&t&&i._UZ(0,"app-portfolio-dashboard")},dependencies:[li],changeDetection:0}),n})()}];let ci=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[ne.Bz.forChild(di),ne.Bz]}),n})(),mi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({providers:[oe],imports:[$.ez,ci,ge,qe,V.ot]}),n})()},655:(he,dt,y)=>{function ct(a,l,d,c){var f,u=arguments.length,m=u<3?l:null===c?c=Object.getOwnPropertyDescriptor(l,d):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(a,l,d,c);else for(var x=a.length-1;x>=0;x--)(f=a[x])&&(m=(u<3?f(m):u>3?f(l,d,m):f(l,d))||m);return u>3&&m&&Object.defineProperty(l,d,m),m}y.d(dt,{gn:()=>ct})}}]);